module.exports=function(e){function t(r){if(n[r])return n[r].exports;var i=n[r]={exports:{},id:r,loaded:!1};return e[r].call(i.exports,i,i.exports,t),i.loaded=!0,i.exports}var n={};return t.m=e,t.c=n,t.p="",t(0)}([function(e,t,n){var r,i=n(3),o=n(4),a=n(5),s=n(6),l=n(7),u=n(8),c=n(9),d=n(1).CompositeDisposable,p=n(10),f=n(11),h=n(12),m=n(13);!function(e){function t(e){n(2).install("api-workbench",!0).then(function(){E.add(atom.commands.add("atom-workspace",{"api-workbench:editor-tools":o.initEditorTools,"api-workbench:console":i.toggle,"api-workbench:go-to-definition":u.gotoDeclaration,"api-workbench:find-usages":u.findUsages,"api-workbench:quick-outline":l.show,"api-workbench:quick-commands":a.showCommands,"api-workbench:rename":u.renameRAMLElement,"api-workbench:new-project":u.newProject,"api-workbench:select-node":u.select})),E.add(atom.workspace.addOpener(i.opener)),p.initialize(),f.initialize(),h.initialize(),a.registerCommands(),m.initialize(),o.initEditorTools()})}function r(){return s}function v(){return c}function y(e){E.add(c.initEditorObservers(e))}function g(){E.dispose()}var E=new d;e.activate=t,e.getProvider=r,e.provideLinter=v,e.consumeLinter=y,e.deactivate=g,e.config={grammars:{type:"array","default":["source.raml"]},openConsoleInSplitPane:{type:"boolean","default":!0}}}(r||(r={})),e.exports=r},function(e,t,n){e.exports=require("atom")},function(e,t,n){e.exports=require("atom-package-deps")},function(e,t,n){function r(e){return new m.RAMLConsoleView(e)}function i(e){return e instanceof m.RAMLConsoleView}function o(){if(i(atom.workspace.getActivePaneItem()))return void atom.workspace.destroyActivePaneItem();var e=atom.workspace.getActiveTextEditor();if(!e)return void atom.notifications.addInfo("The API Console can only be opened when focused on a RAML file editor.");var t=atom.config.get("api-workbench.grammars")||[];return-1===t.indexOf(e.getGrammar().scopeName)?void atom.notifications.addInfo("The API Console can only be opened with focus on a RAML file."):a(e)?void 0:void s(e)}function a(e){var t=m.RAMLConsoleView.getUriForEditor(e),n=atom.workspace.paneForURI(t);return n?(n.destroyItem(n.itemForURI(t)),!0):!1}function s(e,t){return f(m.RAMLConsoleView.getUriForEditor(e),t)}function l(e,t){return f(m.RAMLConsoleView.getUriForFilename(e),t)}function u(e){try{var t=h.parse(e),n=t.protocol,i=t.host,o=t.pathname}catch(a){return}if("raml-console:"===n){try{o=decodeURI(o||"").substr(1)}catch(a){return}return r("editor"===i?{editorId:o}:{filename:o})}}function c(){return atom.config.get("api-workbench.openConsoleInSplitPane")}function d(){return{activatePane:!1,searchAllPanes:!0,split:c()?"right":void 0}}function p(e,t){var n=atom.workspace.getActivePane(),i=r({raml:e,state:t});return c()&&(n=n.findOrCreateRightmostSibling()),atom.workspace.itemOpened(i),n.activateItem(i),Promise.resolve(i)}function f(e,t){var n=d();atom.workspace.getActivePane();return atom.workspace.open(e,n).then(function(e){return e.setState(t),e})}var h=n(16),m=n(31);atom.deserializers.add({name:"RAMLConsoleView",deserialize:function(e){return e?r(e):void 0}}),t.createConsoleView=r,t.isConsoleView=i,t.toggle=o,t.removeConsoleForEditor=a,t.addConsoleForEditor=s,t.addConsoleForFile=l,t.opener=u,t.openView=p},function(e,t,n){function r(e){void 0===e&&(e=!0),null==m?m=new h(e):e&&m.display()}function i(){return null!=m&&m.opened}function o(){return m||(m=new h(!0)),m}function a(e){o()._view&&o()._view.refresh(),o().updateText(),o().selectNode(e)}function s(e,t){void 0===t&&(t=v.RIGHT);var n=null;switch(t){case v.BOTTOM:n=u.workspace.getActivePane().splitDown({});break;case v.TOP:n=u.workspace.getActivePane().splitUp({});break;case v.LEFT:n=u.workspace.getActivePane().splitLeft({});break;case v.RIGHT:n=u.workspace.getActivePane().splitRight({})}return n.addItem(e,0),n}var l=n(14),u=n(22),c=n(15),d=c.project,p=n(26),f=n(27),h=function(){function e(e){var t=this;void 0===e&&(e=!0),this._initialized=!1,this.updateCount=0,this.outlineCount=0,this.fire=!0,this.opened=!1,this._cleanOutline=!1,this.performanceDebug=!0,this.placeholder=!1,m=window.manager=this,u.workspace.onDidChangeActivePaneItem(function(n){return t.updateEverything(e)}),this.updateEverything(e),this.addAutoCloseListener()}return e.prototype.getPath=function(){return console.log("ETM::GetPath"),this.currentEditor?this.currentEditor.getPath():null},e.prototype.getCurrentEditor=function(){return this.currentEditor},e.prototype.internalScheduleUpdateViews=function(e){var t=this;this.updateCount=e,setTimeout(function(){t.updateCount==e&&t.updateViews()},500)},e.prototype.scheduleViewsUpdate=function(){this.fire&&this.internalScheduleUpdateViews(this.updateCount+1)},e.prototype.internalScheduleOutlineUpdate=function(e){var t=this;this.outlineCount=e,setTimeout(function(){t.outlineCount==e&&t.updateOutline()},500)},e.prototype.scheduleOutlineUpdate=function(){this.internalScheduleOutlineUpdate(this.outlineCount+1)},e.prototype.addAutoCloseListener=function(){var e=this;u.workspace.onDidDestroyPane(function(t){try{var n=u.workspace.getPaneItems().filter(function(e){return void 0!=e.softTabs}).length;0==n&&(u.workspace.paneForItem(e._view)&&u.workspace.paneForItem(e._view).destroy(),u.workspace.paneForItem(e._details)&&u.workspace.paneForItem(e._details).destroy(),e.opened=!1)}catch(r){console.log(r)}})},e.prototype.getOrCreateView=function(){return this._view||(this._view=new f.RamlOutline,this.ast&&this._view.setUnit(this.ast)),this._view},e.prototype.getDetails=function(){return this._details||(this._details=new p.RamlDetails),this._details},e.prototype.updateDetails=function(){this.getDetails().update()},e.prototype.reparseAST=function(){var e=this;if(this.currentEditor){var t=this.currentEditor.getPath(),n=(this.currentEditor.getBuffer(),d.createProject(l.dirname(t))),r=n.setCachedUnitContent(l.basename(t),this.currentEditor.getBuffer().getText());r.project().addTextChangeListener(function(t){if(t.unit==r){var n=t.offset,i=t.replacementLength,o=t.text,a=e.currentEditor.getBuffer(),s=a.positionForCharacterIndex(n),l=a.positionForCharacterIndex(n+i);try{e.fire=!1,a.setTextInRange({start:s,end:l},o),e.scheduleOutlineUpdate()}finally{e.fire=!0}}}),this.ast=r.highLevel(),this.unit=r}},e.prototype.isETPane=function(e){if(this._view){var t=e.getItems();return t.indexOf(this.getDetails())>=0||t.indexOf(this._view)>=0}},e.prototype.display=function(){console.log("ETM::Display");var e=u.workspace,t=u.workspace.paneForItem(this.getCurrentEditor());t&&(e.paneForItem(this.getOrCreateView())||s(this.getOrCreateView()),e.paneForItem(m.getDetails())||s(this.getDetails(),v.BOTTOM),this.opened=!0)},e.prototype.updateText=function(e){this.fire=!1;var t=this.currentEditor,n=e?t.getBuffer().positionForCharacterIndex(e.start()):null;t.setText(this.unit.contents()),this.fire=!0,n&&t.setCursorBufferPosition(n)},e.prototype.selectNode=function(e){var t=e.lowLevel();if(t){var n=this.currentEditor;if(n){var r=t?n.getBuffer().positionForCharacterIndex(t.start()):null;r&&n.setCursorBufferPosition(r)}}},e.prototype.updateEverything=function(e){void 0===e&&(e=!0);var t=u.workspace.getActiveTextEditor();if(t&&this.currentEditor!=t){var n=t.getPath();if(n&&".raml"==l.extname(n)){this.currentEditor=t,0==this.opened&&e&&this.display(),t.patched||this.addListenersToEditor(t),this.reparseAST();var r=t.getBuffer().characterIndexForPosition(t.getCursorBufferPosition());this.positionUpdated(r),this.scheduleViewsUpdate()}}},e.prototype.addListenersToEditor=function(e){var t=this,n=e.getBuffer();n.onDidChange(function(r){try{var i=(new Date).getMilliseconds();t.reparseAST();var o=n.characterIndexForPosition(e.getCursorBufferPosition());t.positionUpdated(o),t.scheduleViewsUpdate();var a=(new Date).getMilliseconds();t.performanceDebug&&console.log("Change take:"+(a-i))}catch(s){console.log(s)}}),e.getLastCursor().onDidChangePosition(function(r){t.fire&&(t.positionUpdated(n.characterIndexForPosition(e.getCursorBufferPosition())),t.scheduleViewsUpdate())}),this.addListenersOnMove(e),this.currentEditor.patched=!0},e.prototype.addListenersOnMove=function(e){var t=this,n=!1;u.workspace.onDidAddPaneItem(function(r){return n||0==t.isETPane(r.pane)||r.item==t.getOrCreateView()||r.item==t.getDetails()?r:void setTimeout(function(){try{var t=u.workspace.paneForItem(e);t&&(n=!0,r.pane.moveItemToPane(r.item,t,null),n=!1,t.setActiveItem(r.item),t.activate())}catch(i){console.log(i)}},18)})},e.prototype.patchCurrentNode=function(e){this._currentNode=e},e.prototype.getCurrentNode=function(){return null==this._currentNode?this._currentNode=this.ast:this._currentNode},e.prototype.setSelectedNode=function(e){if(this.unit)for(var t=this.unit.absolutePath();e.lowLevel().unit().absolutePath()!=t&&e.parent();)e=e.parent();var n=e.id(),r=this.ast.findById(n);r&&(e=r),this._details&&this._details.show(e);var i=this.getCurrentEditor();if(i){this.fire=!1;try{var o=i.getBuffer(),a=o.positionForCharacterIndex(e.lowLevel().start());o.positionForCharacterIndex(e.lowLevel().end());i.setCursorBufferPosition(a),this.positionUpdated(o.characterIndexForPosition(i.getCursorBufferPosition()))}finally{this.fire=!0}}},e.prototype.getSelectedNode=function(){return this.getCurrentNode()},e.prototype.setText=function(e){console.log("ETM::SetText");var t=this.currentEditor;null!=t&&t.setText(e)},e.prototype.updateViews=function(){var e=this.getCurrentNode(),t=(new Date).getMilliseconds();this._details&&this.getDetails().show(e),this._view&&(this.getOrCreateView().setUnit(m.ast),this.getOrCreateView().setSelection(e));var n=(new Date).getMilliseconds();this.performanceDebug&&console.log("Views update:"+(n-t))},e.prototype.updateOutline=function(){var e=this.getCurrentNode(),t=(new Date).getMilliseconds();this._view&&(this.getOrCreateView().setUnit(m.ast),this.getOrCreateView().setSelection(e));var n=(new Date).getMilliseconds();this.performanceDebug&&console.log("Outline update:"+(n-t))},e.prototype.positionUpdated=function(e){this.currentPosition=e,this.ast&&(this._currentNode=this.ast.findElementAtOffset(this.currentPosition))},e}(),m=null;t.initEditorTools=r,t.editorToolsStatus=i,t.aquireManager=o,t.updateAndSelect=a,function(e){e[e.RIGHT=0]="RIGHT",e[e.LEFT=1]="LEFT",e[e.TOP=2]="TOP",e[e.BOTTOM=3]="BOTTOM"}(t.SplitDirections||(t.SplitDirections={}));var v=t.SplitDirections;t.doSplit=s},function(e,t,n){function r(){return d||(d=new c),d}function i(){r().show()}function o(){p.registerQuickCommands(r()),d.add("api-workbench:editor-tools","Show Editor Tools",function(){return f.initEditorTools()},function(){return 0==f.editorToolsStatus()})}var a=n(23),s=n(22),l=n(24),u=function(){function e(e,t,n,r,i){this.id=e,this.title=t,this.command=n,this.priority=r,this.when=i}return e.prototype.registerAsAtomCommand=function(e){this.atomCommand&&0==this.atomCommand.disposed&&this.atomCommand.dispose(),this.atomCommand=s.commands.add(e,this.id,this.command)},e.prototype.dispose=function(){this.atomCommand&&0==this.atomCommand.disposed&&this.atomCommand.dispose(),d.unregister(this)},e}();t.QuickCommand=u;var c=function(){function e(){this.commands={},this.panel=new a.SelectListView(function(e){return e.command()},function(e){return e.title},"title")}return e.prototype.register=function(e){return null!=this.commands[e.id]&&this.unregister(e.id),this.commands[e.id]=e,e},e.prototype.unregister=function(e){"string"==typeof e&&this.unregister(this.commands[e]);var t=e;return null==t?null:(delete this.commands[t.id],t)},e.prototype.add=function(e,t,n,r,i,o){var a=new u(e,t,n,i?i:0,r?r:function(){return!0});return o&&a.registerAsAtomCommand(o),this.register(a),a},e.prototype.show=function(e){var t={};for(var n in this.commands)t[n]=this.commands[n];this.getDynamicCommands().forEach(function(e){t[e.id]=e});var r=Object.keys(t).map(function(e){return t[e]}).sort(function(e,t){return t.priority-e.priority}).filter(function(e){return e.when()});e&&(r=r.filter(e)),this.panel.show(r)},e.prototype.getDynamicCommands=function(){var e=[],t=l.calculateCurrentActions(l.TARGET_RAML_EDITOR_NODE);return t.forEach(function(t){var n=new u(t.name,t.label?t.label:t.name,t.onClick,1,function(){return!0}),r=n;r.__module__="editorTools",e.push(n)}),e},e}();t.CommandManager=c;var d;t.manager=r,t.showCommands=i;var p=n(25),f=n(4);t.registerCommands=o},function(e,t,n){function r(e){var t=!e.isArray()&&!i(e)&&!e.hasUnionInHierarchy()&&e.key()!==F.Universe10.TypeDeclaration;return t}function i(e){return e.isAssignableFrom(F.Universe10.ObjectTypeDeclaration.name)}function o(e){return e.isAssignableFrom(F.Universe10.ArrayTypeDeclaration.name)}function a(e){var t=[];return e&&e.isUnion()?e.left?(t.push(e.left),t.concat(a(e.right))):void 0:e?[e]:t}function s(e,t){if(t){if(e.getAdapter(j.RAMLPropertyService).isTypeExpr()){var n,s=t.associatedType(),l=t.definition(),u=t.attr(F.Universe10.TypeDeclaration.properties.type.name),c=u&&u.value(),d=t.children()&&t.children().filter(function(e){return e.isAttr()&&q.isTypeProperty(e.property())}),p=k.globalDeclarations(t).filter(function(u){if(q.isGlobalSchemaType(u.definition()))return!0;var p=u.definition().allSuperTypes();if(U.find(p,function(e){return q.isTypeDeclarationType(e)})){var f=c&&e&&e.isMultiValue()&&d&&d.length>1;if(f){if(!s)try{s=t.localType()}catch(h){console.log(h)}if(s&&!l.hasUnionInHierarchy()){var m=s.superTypes();if(m){var v=U.find(m,function(e){return i(e)}),y=U.find(m,function(e){return r(e)}),g=U.find(m,function(e){return o(e)})||l&&o(l),E=g||y;if(n=v||E,U.find(m,function(e){return k.qName(u,t)===e.nameId()}))return!1;if(n&&(r(u.definition())||o(u.definition())))return!1;if(E&&i(u.definition()))return!1}}if(l.hasUnionInHierarchy()){var b=a(l);if(U.find(b,function(e){return k.qName(u,t)===e.nameId()}))return!1}}return!0}return q.isTypeDeclarationType(u.definition())&&"models"===u.property().nameId()}),f=p.map(function(e){return{text:k.qName(e,t),description:""}}),h=e.domain().universe().type("TypeDeclaration"),m=e.domain().universe().type("AnnotationTypeDeclaration");if(h){var v=h.allSubTypes();f=f.concat(v.filter(function(e){return n&&(r(e)||o(e))?!1:e.isAssignableFrom(m.nameId())?!1:!0}).map(function(e){return{text:e.getAdapter(j.RAMLService).descriminatorValue(),description:e.description()}}))}return f}if(q.isSchemaStringType(e.range())&&"RAML10"===e.range().universe().version()){var p=k.globalDeclarations(t).filter(function(e){if(q.isGlobalSchemaType(e.definition()))return!0;var t=e.definition().allSuperTypes();return U.find(t,function(e){return q.isTypeDeclarationType(e)})?!0:q.isTypeDeclarationType(e.definition())&&"models"===e.property().nameId()}),f=p.map(function(e){return{text:k.qName(e,t),description:""}}),v=k.subTypesWithLocals(e.domain().universe().type("TypeDeclaration"),t);return f=f.concat(v.map(function(e){return{text:e.getAdapter(j.RAMLService).descriminatorValue(),description:e.description()}}))}if(e.isDescriminator()){var v=k.subTypesWithLocals(e.domain(),t);return v.map(function(e){return{text:e.getAdapter(j.RAMLService).descriminatorValue(),description:e.description()}})}if(e.isReference())return k.nodesDeclaringType(e.referencesTo(),t).map(function(e){return G(e,t)});if(e.range().hasValueTypeInHierarchy()){var y=e.range().getAdapter(j.RAMLService);if(y.globallyDeclaredBy().length>0){var p=k.globalDeclarations(t).filter(function(e){var t=e.definition();return null!=U.find(y.globallyDeclaredBy(),function(e){return e==t})});return p.map(function(e){return G(e,t)})}if(q.isBooleanTypeType(e.range()))return["false","true"].map(function(e){return{text:e}})}}return k.enumValues(e,t).map(function(e){return{text:e}})}function l(e,t){var n=!0;return t.getContextRequirements().forEach(function(t){if(-1==t.name.indexOf("(")){var r=e.computedValue(t.name);r?n=n&&r==t.value:t.value&&(n=!1)}}),n}function u(e){var t=e.editor.getBuffer().characterIndexForPosition(e.triggerPosition);if(e.suggestion.annotation){for(var n=e.editor.getBuffer().getText(),r=t;r<n.length;r++){var i=n.charAt(r);if(")"==i){t=r+1;break}if("\r"==i||"\n"==i)return}var o=e.editor.getBuffer().positionForCharacterIndex(t);return void e.editor.getBuffer().insert(o,":")}if(e.suggestion.replacementPrefix&&e.suggestion.extra||"%"==e.suggestion.extra){var o=e.editor.getBuffer().positionForCharacterIndex(t-e.suggestion.replacementPrefix.length);e.editor.getBuffer().insert(o,e.suggestion.extra)}else{if(" "==e.suggestion.extra){var o=e.editor.getBuffer().positionForCharacterIndex(t);e.editor.getBuffer().insert(o,e.suggestion.extra)}if(" { "==e.suggestion.extra){var o=e.editor.getBuffer().positionForCharacterIndex(t);e.editor.getBuffer().insert(o,e.suggestion.extra)}if(e.suggestion.extra&&-1!=e.suggestion.extra.indexOf("!include")){var o=e.editor.getBuffer().positionForCharacterIndex(t);e.editor.getBuffer().insert(o,e.suggestion.extra)}}}function c(e,t,n){var r=M.resolve(t,n);if(R.existsSync(r)){var i=R.readdirSync(r),o=i.map(function(t){return{text:t,replacementPrefix:e,extra:"./"+n+"/"}});return o}return[]}function d(e,t,n,r,i,o){var a=L(t,n),s=e.editor.getPath(),l=M.dirname(s),u=M.resolve(l,a);if(u&&(l=M.dirname(u),R.existsSync(u))){var d=R.statSync(u);d.isDirectory()&&(l=u)}var p=[],f=!o;if(r&&o&&("example"==r.name()&&(p=p.concat(c(a,l,"examples")),f=!0),"value"==r.name()&&q.isGlobalSchemaType(r.parent().definition())&&(p=p.concat(c(a,l,"schemas")),f=!0)),r||o&&(q.isTraitType(i.definition())&&(p=p.concat(c(a,l,"traits")),f=!0),q.isResourceTypeType(i.definition())&&(p=p.concat(c(a,l,"resourceTypes")),f=!0),q.isSecuritySchemaType(i.definition())&&(p=p.concat(c(a,l,"securitySchemes")),f=!0),q.isGlobalSchemaType(i.definition())&&(p=p.concat(c(a,l,"schemas")),f=!0)),(!f||!o)&&R.existsSync(l)){var h=R.readdirSync(l);p=p.concat(h.map(function(e){return{text:e}}))}return p}function p(e,t,n,r,i,o){var a=L(t,n),s=D.schema.getIncludePath(a),l=D.schema.getIncludeReference(a);if(!s||!l)return[];var u=r.lowLevel().unit().resolve(s);if(!u)return[];var c=u.contents();if(!c)return[];try{var d=D.schema.completeReference(s,l,c);return d.map(function(e){return{text:e}})}catch(p){console.log(p)}return[]}function f(e,t,n,r,i,o){var a=L(t,n);return-1==a.indexOf("#")?d(e,t,n,r,i,o):p(e,t,n,r,i,o)}function h(e,t){if(!e)return null;for(var n=e.split("/"),r=t.lowLevel(),i=r,o=0;o<n.length-1;o++)if("#"!=n[o]){if(i=U.find(i.children(),function(e){return e.key()==n[o]}),!i)return null}else i=r.unit().ast();return i.children().map(function(e){return{text:e.key()}})}function m(e,t){var n=t.definition().universe().types().filter(function(e){return!e.hasValueTypeInHierarchy()&&!e.hasUnionInHierarchy()});return n.map(function(e){return{text:e.nameId(),description:e.description()}})}function v(e,t,n,r,i){var o=e;if(t){var a=t.property(),l=t.value();if("object"==typeof l&&l){var u=l.toHighLevel();if(u)return T(Q,P(u,n,r));if(k.isExampleNodeContent(t)){var c=k.findExampleContentType(t);if(c){var d=k.parseDocumentationContent(t,c);if(d)return T(Q,P(d,n,r))}}}if(a){var p=s(a,o);if(a.isAllowNull()&&p.push({text:"null",description:"null means - that no value is allowed"}),!p||0==p.length){var h=a.getOftenKeys();if(h)return h.map(function(e){return{text:e,displayText:e}})}if(q.isExampleProperty(a)&&q.isBodyLikeType(o.definition())){if(!y(t.value(),n,r))return;var m=f(i,r,n,t,o,!0).map(function(e){return e.extra="!include ./examples/",e.displayText="!include ./examples/"+e.text,e});return m=z(m,t.lowLevel().start(),r)}if(q.isValueProperty(a)&&q.isGlobalSchemaType(o.definition())){if(!y(t.value(),n,r))return;m=f(i,r,n,t,o,!0).map(function(e){return e.extra="!include ./schemas/",e.displayText="!include ./schemas/"+e.text,e}),m=z(m,t.lowLevel().start(),r)}if(p)return p}return[]}if(q.isGlobalSchemaType(o.definition())&&(m=f(i,r,n,t,o,!0).map(function(e){return e.extra="!include ./schemas/",e.displayText="!include ./schemas/"+e.text,e}),m=z(m,o.lowLevel().start(),r)),q.isTraitType(o.definition()))return m=f(i,r,n,t,o,!0).map(function(e){return e.extra="!include ./traits/",e.displayText="!include ./traits/"+e.text,e}),m=Y(m,o.lowLevel().start(),r);if(q.isResourceTypeType(o.definition())){var m=f(i,r,n,t,o,!0).map(function(e){return e.extra="!include ./resourceTypes/",e.displayText="!include ./resourceTypes/"+e.text,e});return m=Y(m,o.lowLevel().start(),r)}if(q.isSecuritySchemaType(o.definition())){var m=f(i,r,n,t,o,!0).map(function(e){return e.extra="!include ./securitySchemes/",e.displayText="!include ./securitySchemes/"+e.text,e});return m=Y(m,o.lowLevel().start(),r)}}function y(e,t,n){if(e&&e.length>0){var r=e.trim();if(0==r.indexOf("{"))return!1;if(0==r.indexOf("<"))return!1;if(0==r.indexOf("["))return!1}for(var i=t;i>=0;i--){var o=n[i];if(":"==o)return!0;if("|"==o)return!1;if("'"==o)return!1;if('"'==o)return!1}return!0}function g(e,t){var n=(new Date).getMilliseconds();try{return T(e,t)}finally{if(B.aquireManager()){var r=B.aquireManager();if(r.performanceDebug){var i=(new Date).getMilliseconds();console.log("Completion calc:"+(i-n))}}}}function E(e){return e.text?e.text:e.snippet?e.snippet:e.displayText}function b(e,t){return e.text?void(e.text=t):e.snippet?void(e.snippet=t):void(e.displayText=t)}function T(e,t){Q=e;try{if($>100)return;$++;var n=e.editor.getBuffer().characterIndexForPosition(e.bufferPosition),r=e.editor.getBuffer().getText(),i=k.determineCompletionKind(r,n),o=t?t:N(e),a=o;if(i==k.LocationKind.DIRECTIVE_COMPLETION)return[{text:"include"}];if(i==k.LocationKind.ANNOTATION_COMPLETION){var s=a.definition().universe().type(F.Universe10.AnnotationTypeDeclaration.name);if(s){var l=k.globalDeclarations(a).filter(function(e){return e.definition().isAssignableFrom(F.Universe10.AnnotationTypeDeclaration.name)});return l.map(function(e){return{text:k.qName(e,a),annotation:!0}})}return[]}if(i==k.LocationKind.VERSION_COMPLETION)return W(r,e,n);if(i==k.LocationKind.INCOMMENT)return[];if(null==o)return[];for(var u=!1,c=n-1;c>=a.lowLevel().start();c--){var d=r[c];if("\r"==d||"\n"==d){u=!0;break}}for(var p=n,h=n-1;h>=0;h--){var m=r[h];{if(" "!=m&&"	"!=m)break;p=h}}var y=U.find(a.attrs(),function(e){return e.lowLevel().start()<p&&e.lowLevel().end()>=p&&!e.property().getAdapter(j.RAMLPropertyService).isKey()});if(!y){var g=U.find(a.definition().allProperties(),function(e){return e.canBeValue()});if(u){var T=U.find(a.lowLevel().children(),function(e){return e.start()<n&&e.end()>=n});if(T){var g=U.find(a.definition().allProperties(),function(e){return e.nameId()==T.key()});if(g){var A=w(T.keyStart(),T.unit().contents()),P=w(n,T.unit().contents());if(P.length>A.length+1){var O=g.range().hasValueTypeInHierarchy();O?y=D.stubs.createVirtualASTPropImpl(T,a,g.range(),g):T.children().length>0&&(a=D.stubs.createVirtualNodeImpl(T.children()[0],a,g.range(),g))}}}}else g&&i==k.LocationKind.VALUE_COMPLETION&&q.isTypeProperty(g)&&1==a.children().length&&(y=D.stubs.createASTPropImpl(a.lowLevel(),a,g.range(),g))}if(i==k.LocationKind.PATH_COMPLETION)return f(e,r,n,y,a,!1);if(y&&(i==k.LocationKind.KEY_COMPLETION||i==k.LocationKind.SEQUENCE_KEY_COPLETION)){for(var R="",c=n-1;c>=0;c--){var d=r[c];if("\r"==d||"\n"==d)break;R=d+R}R=R.trim(),R!=y.name()&&(i=k.LocationKind.VALUE_COMPLETION)}if(i==k.LocationKind.VALUE_COMPLETION){var M=v(o,y,n,r,e);if(!y&&(!M||0==M.length)&&!u&&a.definition().getAdapter(j.RAMLService).isUserDefined())return K(a,n,r,se,le,u);if(y&&y.property()&&(y.property().getAdapter(j.RAMLPropertyService).isTypeExpr()||y.property().isAnnotation())){M||(M=[]),M=M.filter(function(e){var t=E(e);return t===a.name()?!1:!0});var B=L(r,n),G=B.lastIndexOf(".");B=G?B.substr(0,G+1):null,B&&(M=M.filter(function(e){return 0==E(e).indexOf(B)}),M.forEach(function(e){return b(e,E(e).substring(B.length))}))}if(M)if(":"==r[n-1]&&M.forEach(function(e){e.extra?e.extra=" "+e.extra:e.extra=" "}),-1!=e.prefix.indexOf("["))e.prefix="",M.forEach(function(e){e.text=": [ "+e.displayText});else if(C(y)){M=M.filter(function(e){return!S(y,e.displayText)});for(var V="",z=n,J=z;J<r.length&&!/[\t\n\r]/.test(r[J]);J++)if(V+=r[J],":"===V.replace(/\s/g,"")){M.forEach(function(e){e.text=e.displayText,e.snippet=null,e.extra=null});break}var Z=!1;z=n-1;for(var J=z;J>=0&&!/[\t\n\r]/.test(r[J]);J--)if("["===r[J]){Z=!0;break}Z||M.forEach(function(e){return!L(r,n)&&e.snippet?(e.text=e.displayText,void(e.snippet="["+e.snippet+"]")):(e.extra=" [",e.text=(e.snippet||e.displayText)+"]",void(e.snippet=null))})}else{for(var V="",z=n,J=z;J<r.length&&!/[\t\n\r]/.test(r[J]);J++)if(V+=r[J],":"===V.replace(/\s/g,"")){M.forEach(function(e){e.text=e.displayText,e.snippet=null,e.extra=null});break}M.forEach(function(e){e.isResourceType&&!L(r,n)&&e.snippet&&(e.snippet=e.extra+e.snippet,e.extra=null,e.text=e.displayText)})}if(!u&&M&&M.length>0&&(M=Y(M,a.lowLevel().start(),r)),M&&x(y)&&e.prefix&&e.prefix.length>0){for(var ee=!1,te=0,ne=0,R="",c=n-1;c>=0;c--){var d=r[c];if("\r"===d||"\n"===d)break;if("<"===d&&"<"===r[c-1]){ee=!0;break}"!"===d&&te++,"|"===d&&1===te&&ne++,R=d+R}if(ee&&1===te&&1===ne){var re=new RegExp(/\|\s*!\s*/.source+e.prefix);re.test(R)&&(M=X(M,e.prefix))}}return M}if(i==k.LocationKind.KEY_COMPLETION||i==k.LocationKind.SEQUENCE_KEY_COPLETION&&n>0&&"-"!=r.charAt(n-1)&&" "!=r.charAt(n-1)){if(o.isAttr()||o.isImplicit())throw new Error("Should be highlevel node at this place");if(a.property()&&q.isUriParametersProperty(a.property())&&a.definition()instanceof _.NodeClass){var ie=a.parent().attr("relativeUri");if(ie&&a.name().substring(0,a.name().length-1)==L(r,n)){var oe=D.utils.parseUrl(ie.value());if(oe instanceof Array&&oe){if(H(n,r))var ae=oe.map(function(e){return{text:e+": \n"+I(n,r)+"  "}});else var ae=oe.map(function(e){return{text:e}});return ae}}}if(a.property()&&q.isBaseUriParametersProperty(a.property())&&a.definition()instanceof _.NodeClass){var ie=a.root().attr(F.Universe10.Api.properties.baseUri.name);if(ie&&a.name().substring(0,a.name().length-1)==L(r,n)){var oe=D.utils.parseUrl(ie.value());if(oe instanceof Array&&oe){if(H(n,r))var ae=oe.map(function(e){return{text:e+": \n"+I(n,r)+"  "}});else var ae=oe.map(function(e){return{text:e}});return ae}}}if(a.property()&&q.isResourcesProperty(a.property())){var ie=a.attr("relativeUri");if(ie&&a.name().substring(0,a.name().length-1)==L(r,n))return ie&&-1!=ie.value().indexOf("{")?[{text:"mediaTypeExtension}"}]:[]}var se=a.property()&&a.property().isMultiValue();a.lowLevel().keyEnd()<n&&(se=!1);var le=!0;if(se){var ue=a.definition().getAdapter(j.RAMLService).getCanInherit();if(ue){var ce=a.computedValue(ue[0]);ce&&(le=!0,se=!1)}}return K(a,n,r,se,le)}return[]}finally{$--}}function S(e,t){var n=e.parent&&e.parent();if(!n)return!1;var r=e.name&&e.name();if(!r)return!1;var i=n.attributes&&n.attributes(r);if(!i)return!1;if(0===i.length)return!1;var o=[];return i.forEach(function(e){var t=e.value&&e.value()&&e.value().valueName&&e.value().valueName();t&&o.push(t)}),U.find(o,function(e){return t===e})}function C(e){return e&&e.definition()&&e.property()&&e.definition().isAssignableFrom(F.Universe10.TraitRef.name)?!0:!1}function x(e){var t=e&&e.definition?e.definition():null;if(t){var n=t.nameId();if("Api"===n)return!1;if("ResourceType"===n||"Trait"===n)return!0;var r=e.parent();return r?x(r):!1}return!1}function w(e,t){for(var n="",r=e-1;r>=0;r--){var i=t.charAt(r);if(" "==i||"	"==i)n?n+=i:n=i;else{if("\r"==i||"\n"==i)return n;if(n)return""}}return""}function A(e,t){for(var n="",r=e-1;r>=0;r--){var i=t.charAt(r);if(" "==i||"	"==i||"-"==i)n?n+=i:n=i;else{if("\r"==i||"\n"==i)return n;if(n)return""}}return""}function I(e,t){for(var n="",r=e-1;r>=0;r--){var i=t.charAt(r);if(" "==i||"	"==i)n?n+=i:n=i;else if("\r"==i||"\n"==i)return n}}function N(e,t,n){void 0===t&&(t=!0),void 0===n&&(n=!0);var r=e.editor.getPath(),i=D.project.createProject(M.dirname(r)),o=e.editor.getBuffer().characterIndexForPosition(e.bufferPosition),a=e.editor.getBuffer().getText(),s=k.determineCompletionKind(a,o);if(s==k.LocationKind.KEY_COMPLETION&&t){for(var l=o>0?o-1:o,u=l;u>0;u--){var c=a[u];if("\r"==c||"\n"==c)break;(" "==c||"	"==c)&&p++}var d=o;a=a.substring(0,d)+"k:"+a.substring(d)}for(var p=0,f=i.setCachedUnitContent(M.basename(r),a),h=f.highLevel(),m=o,v=o-1;v>=0;v--){var c=a[v];{if(" "!=c&&"	"!=c)break;m=v-1}}var y=h.findElementAtOffset(m);if(y&&null==y.parent()&&p>0&&s==k.LocationKind.KEY_COMPLETION){var g=U.find(y.attrs(),function(e){var t=e;return t.lowLevel().start()<o&&t.lowLevel().end()>=o&&!t.property().isKey()});if(!g&&n)return null}return n||y?y:h}function P(e,t,n){for(var r=t,i=t-1;i>=0;i--){var o=n[i];{if(" "!=o&&"	"!=o)break;r=i}}var a=e.findElementAtOffset(r);return a}function L(e,t){for(var n=t-1;n>=0;n--){var r=e.charAt(n);if("\r"==r||"\n"==r||" "==r||"	"==r||'"'==r||"'"==r||":"==r||"("==r)return e.substring(n+1,t)}return""}function O(e){var t=e.absolutePath(),n=e.contents(),r=U.find(atom.workspace.getTextEditors(),function(e){var n=e.getPath();return n==t});r?r.setText(n):R.writeFileSync(t,n)}var R=n(17),M=n(14),D=n(15),_=D.ds,k=D.search,B=n(4),U=n(20),F=D.universes,q=D.universeHelpers,j=_;t.selector=".source.raml",t.disableForSelector=".text.html .comment",t.filterSuggestions=!0,t.inclusionPriority=1,t.excludeLowerPriority=!0;var G=function(e,t){var n=!1,r=e.attr("description"),i="";r?i=r.value():(r=e.attr("usage"),r&&(i=r.value()));var o=e.localType(),a=o.allProperties().filter(function(e){return e.isRequired()&&!e.getAdapter(j.RAMLPropertyService).isKey()}),s=k.qName(e,t);if(!q.isAnnotationTypeType(e.definition())&&a.length>0){s+=": {",s+=a.map(function(e){return e.nameId()+" : "}).join(", ")+"}";var l="";q.isResourceTypeType(e.definition())&&(s=""+s+" }",l=" { ",n=!0)}return{displayText:k.qName(e,t),snippet:s,description:i,extra:l,isResourceType:n}},V=function(e,t){for(var n="";e>0;){var r=t[e];if("\r"==r||"\n"==r||" "!=r&&"-"!=r)break;n+=" ",e--}return n},H=function(e,t){for(var n=!0,r=e>0?e-1:0;r<t.length;r++){var i=t.charAt(r);if(" "==i||"\r"==i||"\n"==i)break;":"==i&&(n=!1)}return n};t.isAllowed=l;var K=function(e,t,n,r,i,o){void 0===o&&(o=!0);var a=e,s=!1,u=!1;if(o){var c=A(e.lowLevel().keyStart(),n);void 0==c&&(c="");var d=A(t,n),p=c.length,f=d.length;for(p==f&&e.parent()&&(e.property().getAdapter(j.RAMLPropertyService).isMerged()?a=a.parent():(s=!1,u=!0)),f>p&&(s=!0,f>=p+4&&(u=!0,s=!1));p>f&&a.parent();)a=a.parent(),p-=2}var h=H(t,n),m=h?": ":"",v=a.definition().allProperties();v=v.filter(function(e){return!e.getAdapter(j.RAMLPropertyService).isKey()&&!e.getAdapter(j.RAMLPropertyService).isMerged()&&!e.getAdapter(j.RAMLPropertyService).isSystem()}),v=v.filter(function(e){return l(a,e)});var y={};if(a.attrs().forEach(function(e){y[e.name()]=!0}),v=v.filter(function(e){return!y[e.nameId()]}).filter(function(e){return!e.isAnnotation()}),e.definition().isAssignableFrom(F.Universe10.TypeDeclaration.name)&&!e.definition().isAssignableFrom("ObjectTypeDeclaration")&&!e.attr("type")){var g=e.definition().universe().type("ObjectTypeDeclaration");g&&v.push(g.property("properties"))}var E=[];return r||u||(E=v.map(function(e){var r=e.nameId()+m;return!e.range().hasValueTypeInHierarchy()&&h&&(r+="\n"+w(t,n)+"  "),{text:r,displayText:e.nameId(),description:e.description()}})),i&&a.definition().allProperties().filter(function(e){return e.getAdapter(j.RAMLPropertyService).isMerged()||e.isFromParentKey()}).forEach(function(e){if((!u||e.isFromParentKey())&&(!s||!e.isFromParentKey())){var r=e,i=e.getOftenKeys();if(!i){var o=e.suggester();o&&(i=o(a))}i||(i=e.enumOptions()),a.property()&&q.isBodyProperty(a.property())&&(i||(q.isResponseType(a.property().domain())&&(i=["application/json","application/xml"]),(q.isMethodBaseType(a.property().domain())||q.isMethodType(a.property().domain()))&&(i=["application/json","application/xml","multipart/form-data","application/x-www-form-urlencoded"]))),i&&i.forEach(function(e){var i=r.valueDocProvider(),o="";i&&(o=i(e)),h?E.push({text:e+":\n"+w(t,n)+"  ",description:o,displayText:e,prefix:e.indexOf("/")>=0?L(n,t):null}):E.push({text:e,description:o,displayText:e,prefix:e.indexOf("/")>=0?L(n,t):null})})}}),E};t.onDidInsertSuggestion=u,t.fromDir=c,t.pathCompletion=f,t.swaggerRefCompletion=h,
t.ramlSelectorCompletion=m;var W=function(e,t,n){var r=["RAML 0.8","RAML 1.0"],i=[],o=e.substr(0,n);if(0==o.indexOf("#%RAML 1.0 ")){var a=["DocumentationItem","DataType","NamedExample","ResourceType","Trait","SecurityScheme","AnnotationTypeDeclaration","Library","Overlay","Extension"];return a.map(function(e){return{text:e}})}return r.forEach(function(r){if(0==("#%"+r).indexOf(o))if(0==e.trim().indexOf("#%"))if(-1!=t.prefix.indexOf("R"))i.push({displayText:r,text:r});else{var a=e.substring(2,n);0==r.indexOf(a)&&("1"==t.prefix||"0"==t.prefix?i.push({displayText:r,text:t.prefix+r.substr(n-2)}):i.push({displayText:r,text:r.substr(n-2)}))}else i.push({displayText:r,text:r,extra:"%"})}),i},z=function(e,t,n){return e=[{displayText:"Define Inline",text:"|\n"+V(t-1,n)+"  "}].concat(e)},Y=function(e,t,n){return e=[{displayText:"Define Inline",text:"\n"+V(t-1,n)+"  "}].concat(e)},J=D.utils.getTransformerNames(),X=function(e,t){var n=[];return J.filter(function(e){return 0===e.indexOf(t)}).forEach(function(e){n.push({displayText:e,text:e})}),n.concat(e)};t.valueCompletion=v;var Q=null;t.getSuggestions=g;var $=0;t.getAstNode=N,t.getValuePrefix=L,t.saveUnit=O},function(e,t,n){function r(e){new p(e).show()}function i(){var e=atom.workspace.getActiveTextEditor();if(e){var t=e.getPath(),n=o.basename(t),i=o.extname(n);l.isAllowedExtension(i)&&a.existsSync(t)&&r(e)}}var o=n(14),a=n(17),s=(n(18),n(6)),l=n(28),u=n(19),c=n(27),d=n(4),p=function(){function e(e){this._editor=e}return e.prototype.extraContent=function(e){},e.prototype.show=function(){var e=this,t=null,n=null,r=s.getAstNode({bufferPosition:this._editor.getCursorBufferPosition(),editor:this._editor},!1,!1),i=u.section("Quick outline:"),o=c.createTree(r.root(),function(e){return e.selection&&e.selection.elements.length>0?(n=e.selection.elements[0],void l.setDisabled(!1)):void l.setDisabled(!0)},function(n){var r=e._editor,i=r.getBuffer(),o=i.positionForCharacterIndex(n.lowLevel().start());r.setCursorScreenPosition(o),t.destroy()});o.setStyle("max-height","800px"),o.addClass("tree-view-scroller"),i.addChild(o);var a=u.buttonSimple("Cancel",function(e){t.destroy()},u.Icon.NONE);a.setStyle("float","right").margin(4,10);var l=u.button("Ok",u.ButtonSizes.NORMAL,u.ButtonHighlights.PRIMARY,u.Icon.NONE,function(e){n&&d.aquireManager().setSelectedNode(n),t.destroy()});l.setStyle("float","right").margin(4,10),l.setDisabled(!0),i.addChild(l),i.addChild(a);var p=i.renderUI();p.tabIndex=0,p.onkeypress=function(e){27==e.keyCode&&t.destroy()},t=atom.workspace.addModalPanel({item:p}),p.focus()},e}();t.show=i},function(e,t,n){function r(e){var t=e.parent().root(),n=e.property().range().universe().type("GlobalSchema"),r=I.createStubNode(n,n.universe().type("Api").property("schemas"),""+e.value());r.attrOrCreate("value").setValue("!include schemas/"+e.value()+".json"),t.add(r);var i=atom.workspace.getActiveTextEditor();i.getBuffer().setText(t.lowLevel().unit().contents());var o=w.resolve(w.dirname(i.getPath()),"schemas");x.existsSync(o)||x.mkdirSync(o);var a=w.resolve(o,e.value()+".json");x.writeFileSync(a,'\n{\n  "$schema" : "http://json-schema.org/draft-04/schema" ,\n  "type" : "object" ,\n  "properties" : {\n   }\n}\n'),atom.workspace.open(a,{})}function i(e,t,n,r,i){var o=e.definition().universe().type("GlobalSchema"),a=I.createStubNode(o,o.universe().type("Api").property("schemas"),""+t);a.attrOrCreate("value").setValue("!include "+n),e.add(a);var s=f(),l=i?w.dirname(i):w.resolve(w.dirname(s.getPath()),w.dirname(n));x.existsSync(l)||x.mkdirSync(l);var u=i?i:w.resolve(w.dirname(s.getPath()),n);x.writeFileSync(u,r)}function o(e,t,n){var r=f(),i=w.resolve(w.dirname(r.getPath()),w.dirname(t));x.existsSync(i)||x.mkdirSync(i);var o=w.resolve(w.dirname(r.getPath()),t);x.writeFileSync(o,n)}function a(e,t,n,r,i){void 0===r&&(r=!0),void 0===i&&(i=!0);var o=[i?"#%RAML 1.0":"#%RAML 0.8","title: "+e];t&&o.push("version: "+t),n&&o.push("baseUri: "+n);var a=["types:","  TestType:","    type: object","    properties:","      id: number","      optional?: string","      expanded:","        type: object","        properties:","          count: number"],s=["/helloWorld:","  get:","    responses:","      200:","        body:","          application/json:","            example: |","              {",'                "message" : "Hello World"',"              }"],l=o;return r&&(i&&(l=l.concat(a)),l=l.concat(s)),l.join("\n")+"\n"}function s(){(new U).show()}function l(e){new k.MoveElementsDialog(e,"Resource Type",!0).show()}function u(e){var t=e.match(/^.*((\r\n|\n|\r)|$)/gm);return t}function c(e){for(var t=u(e),n=[],r=0;r<t.length;r++)t[r].trim().length>0&&n.push(t[r]);return n.join("")}function d(e,t){for(var n=u(e),r=[],i=0;i<n.length;i++)0==i?r.push(n[0]):r.push(n[i].substring(t.length));return r.join("")}function p(e){for(var t="",n=0;n<e.length;n++){var r=e[n];if("\r"!=r&&"\n"!=r){if(" "!=r&&"	"!=r)break;t+=r}}return t}function f(){var e=atom.workspace.getActiveTextEditor();return e?e:B.aquireManager()?B.aquireManager().getCurrentEditor():null}function h(e){new F(e).show()}function m(){var e=f();if(e&&".raml"==w.extname(e.getPath())){var t={editor:e,bufferPosition:e.getCursorBufferPosition()},n=O.getAstNode(t,!1);if(!n)return;var r=t.editor.getBuffer().characterIndexForPosition(t.bufferPosition),i=P.determineCompletionKind(e.getBuffer().getText(),r);if(i==P.LocationKind.VALUE_COMPLETION){var o=n,a=L.find(o.attrs(),function(e){return e.lowLevel().start()<r&&e.lowLevel().end()>=r&&!e.property().getAdapter(_.RAMLPropertyService).isKey()});if(a&&a.value()){var s=a.property(),l=(a.value(),P.referenceTargets(s,o)),u=L.find(l,function(e){return e.name()==a.value()});u&&R.prompt("New name for "+a.value(),function(e){E(function(t,n){n.reverse().forEach(function(t){var n=t;n.asAttr().setValue(e)}),t.attr(t.definition().getAdapter(_.RAMLService).getKeyProp().nameId()).setValue(e);var r=f();r.getBuffer().setText(t.lowLevel().unit().contents())})},a.value())}}if(i==P.LocationKind.KEY_COMPLETION||i==P.LocationKind.SEQUENCE_KEY_COPLETION){var o=n;R.prompt("New name for "+o.name(),function(e){E(function(t,n){var r=t.attrValue(t.definition().getAdapter(_.RAMLService).getKeyProp().nameId());n.reverse().forEach(function(t){var n=t;v(n.asAttr(),r,e)}),t.attr(t.definition().getAdapter(_.RAMLService).getKeyProp().nameId()).setValue(e);var i=f();i.getBuffer().setText(t.lowLevel().unit().contents())})},o.name())}}}function v(e,t,n){var r=e.value();if("string"!=typeof r){if("object"==typeof r){var i=r,o=i.valueName();if(-1!=o.indexOf(t)){var a=i.toHighLevel();if(a){var s=!1;if(a.definition().isAnnotationType()){var l=y(a.definition(),i.lowLevel());return void l.setValue("("+n+")")}return void a.attrs().forEach(function(e){if(e.property().getAdapter(_.RAMLPropertyService).isKey()){var r=e.value();if("string"==typeof r){s=!0;var i=r.replace(t,n);e.setValue(i)}}})}}}e.setValue(n)}else{var o=r,u=o.replace(t,n);if(e.setValue(u),-1==o.indexOf(t)&&-1!=e.name().indexOf(t)){var c=e.name().replace(t,n);e.setKey(c)}}}function y(e,t){var n=new D.UserDefinedProp("name");n.withRange(this.universe().type(N.Universe10.StringType.name)),n.withFromParentKey(!0);var r=e.getAdapter(_.RAMLService).getDeclaringNode();return I.createASTPropImpl(t,r,n.range(),n,!0)}function g(){var e=f(),t={editor:e,bufferPosition:e.getCursorBufferPosition()},n=O.getAstNode(t,!1);if(n){var r=e.getBuffer().positionForCharacterIndex(n.lowLevel().start()),i=e.getBuffer().positionForCharacterIndex(n.lowLevel().end());e.setSelectedBufferRange({start:r,end:i},{})}}function E(e){void 0===e&&(e=T);var t=f();if(t&&".raml"==w.extname(t.getPath())){var n={editor:t,bufferPosition:t.getCursorBufferPosition()},r=n.editor.getPath(),i=A.project.createProject(w.dirname(r)),o=i.unit(w.basename(r)),a=n.editor.getBuffer().characterIndexForPosition(n.bufferPosition),s=n.editor.getBuffer().getText();o.updateContent(s);var l=P.findUsages(o,a);l.node&&e(l.node,l.results)}}function b(){E(T)}function T(e,t){q?q.setInput(e.name(),t):(q=new j(e.name()+":"+e.definition().nameId(),t),q.panel=atom.workspace.addBottomPanel({item:q}))}function S(){var e=f();if(e&&".raml"==w.extname(e.getPath())){var t={editor:e,bufferPosition:e.getCursorBufferPosition()},n=t.editor.getPath(),r=A.project.createProject(w.dirname(n)),i=r.unit(w.basename(n)),o=t.editor.getBuffer().characterIndexForPosition(t.bufferPosition),a=t.editor.getBuffer().getText();i.updateContent(a);var s=P.findDeclaration(i,o);if(s)if(s.absolutePath){var l=s.absolutePath();if(l&&0===l.toLowerCase().indexOf("http"))return;atom.workspace.open(l,{})}else V(e,s.lowLevel())}}var C=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},x=n(17),w=n(14),A=n(15),I=A.stubs,N=A.universes,P=A.search,L=n(20),O=n(6),R=n(19),M=n(18),D=A.ds,_=D,k=n(29),B=n(4);t.createGlobalSchema=r,t.createGlobalSchemaFromNameAndContent=i,t.saveExample=o;var U=function(){function e(e){void 0===e&&(e="Create RAML Project"),this.title=e,this.apititle="New API",this.version="v1",this.baseUri="http://api.samplehost.com",this._raml1=!0,this._defStructure=!0,this._createSampleResource=!0,this.sourceValue=w.resolve(this.generateDefaultProjectParentFolder(),"newRamlProject")}return e.prototype.generateDefaultProjectParentFolder=function(){return R.fdUtils.getHome()},e.prototype.extraContent=function(e){},e.prototype.validateProjectLocation=function(e){var t=e?e.trim():"";if(!t)return R.errorStatus("Path should't be empty");var n=w.dirname(t);return n&&"."!=n?x.existsSync(n)?R.okStatus():R.errorStatus("Parent directory does not exist"):R.errorStatus("Can not find path parent")},e.prototype.validateTitle=function(e){var t=e?e.trim():"";return!t||t.length<1?R.errorStatus("Title field is required"):R.okStatus()},e.prototype.show=function(){var e=this,t=null,n=R.section(this.title,R.Icon.BOOK,!1,!1,R.h3("Please select location to place your project:")).pad(10,10),r=new R.Panel(R.LayoutType.BLOCK),i=R.label("",null,R.TextClasses.ERROR),o=new R.CustomField("",i,function(e){return e});o.setDisplay(this.validateProjectLocation(this.sourceValue).code==R.StatusCode.ERROR),r.addChild(o);var a=R.texfField("",this.sourceValue,function(t){return e.sourceValue=t.getBinding().get()});a.getBinding().addValidator(function(){return e.validateProjectLocation(e.sourceValue)}),a.setStyle("width","400px"),a.getBinding().addListener(function(t){var n=e.validateProjectLocation(t);n.code!=R.StatusCode.ERROR?(i.setText(""),i.setIcon(R.Icon.NONE),o.setDisplay(!1)):(i.setText(n.message),i.setIcon(R.Icon.BUG),o.setDisplay(!0))}),r.addChild(a),r.addChild(R.h3("Title of your API:"));var s=R.label("",null,R.TextClasses.ERROR),l=new R.CustomField("",s,function(e){return e});l.setDisplay(!1),r.addChild(l);var u=R.texfField("",this.apititle,function(t){return e.apititle=t.getBinding().get()});u.getBinding().addValidator(function(){return e.validateTitle(e.apititle)}),u.getBinding().addListener(function(t){var n=e.validateTitle(t);n.code!==R.StatusCode.ERROR?(s.setText(""),s.setIcon(R.Icon.NONE),l.setDisplay(!1)):(s.setText(n.message),s.setIcon(R.Icon.BUG),l.setDisplay(!0))}),r.addChild(u),r.addChild(R.h3("Version of your API")),r.addChild(R.texfField("",this.version,function(t){return e.version=t.getBinding().get()})),r.addChild(R.h3("Base URI of your API")),r.addChild(R.texfField("",this.baseUri,function(t){return e.baseUri=t.getBinding().get()})),n.addChild(r);var c=R.checkBox("Use RAML 1.0");c.setValue(this._raml1),c.getBinding().addListener(function(t){return e._raml1=c.getValue()}),n.addChild(c);var d=R.checkBox("Create default directory structure");d.setValue(this._defStructure),d.getBinding().addListener(function(t){return e._defStructure=d.getValue()}),n.addChild(d);var p=R.checkBox("Create sample resource and method");p.setValue(this._createSampleResource),p.getBinding().addListener(function(t){return e._createSampleResource=p.getValue()}),n.addChild(p);var f=R.hc().setPercentWidth(100).setStyle("display","flex");f.addChild(R.label("",null,null,null).setStyle("flex","1")),f.addChild(R.button("Cancel",R.ButtonSizes.NORMAL,R.ButtonHighlights.NO_HIGHLIGHT,R.Icon.NONE,function(e){t.destroy()}).margin(10,10)),f.addChild(R.button("Create",R.ButtonSizes.NORMAL,R.ButtonHighlights.SUCCESS,R.Icon.NONE,function(n){e.validateTitle(e.apititle).code!==R.StatusCode.ERROR&&e.validateProjectLocation(e.sourceValue).code!==R.StatusCode.ERROR&&(e.onOk(t),t.destroy())})),n.addChild(f),t=atom.workspace.addModalPanel({item:n.renderUI()})},e.prototype.createIfNotExist=function(e){var t=w.resolve(this.sourceValue,e);x.existsSync(t)||x.mkdirSync(t)},e.prototype.onOk=function(e){x.existsSync(this.sourceValue)||x.mkdirSync(this.sourceValue),this._defStructure&&(this.createIfNotExist("schemas"),this.createIfNotExist("examples"),this.createIfNotExist("traits"),this.createIfNotExist("resourceTypes"),this.createIfNotExist("securitySchemes"),this.createIfNotExist("documentation"),this._raml1&&(this.createIfNotExist("notebooks"),this.createIfNotExist("scripts")));var t=a(this.apititle,this.version,this.baseUri,this._createSampleResource,this._raml1),n=w.resolve(this.sourceValue,"api.raml");x.writeFileSync(n,t),atom.open({pathsToOpen:[this.sourceValue,n]})},e}();t.createRAMLFile=a,t.newProject=s,t.moveResource=l,t.splitOnLines=u,t.cleanEmptyLines=c;t.getActiveEditor=f;var F=function(){function e(e){this.node=e}return e.prototype.show=function(){var e=this,t=null,n=this.node,r=R.section("Move node content to new file ",R.Icon.GIST_NEW,!1,!1),i=R.label("please enter correct destination path",R.Icon.BUG,R.TextClasses.ERROR,R.HighLightClasses.NONE);r.addChild(R.vc(i)),r.addChild(R.label("Please enter destination path"));var o=R.texfField("","",function(t){if(o){e.destination=o.getBinding().get();var n=0==e.destination.trim().length;if(n||".raml"!=w.extname(e.destination)&&(n=!0),!n){var r=w.resolve(w.dirname(f().getPath()),w.dirname(e.destination));if(x.existsSync(r)){var a=x.statSync(r);a.isDirectory()||(n=!0)}else n=!0}i.setDisplay(n),s.setDisabled(n)}});r.addChild(R.vc(o));var a=R.hc().setPercentWidth(100).setStyle("display","flex");a.addChild(R.label("",null,null,null).setStyle("flex","1")),a.addChild(R.button("Cancel",R.ButtonSizes.NORMAL,R.ButtonHighlights.NO_HIGHLIGHT,R.Icon.NONE,function(e){t.destroy()}).margin(10,10));var s=R.button("Move",R.ButtonSizes.NORMAL,R.ButtonHighlights.SUCCESS,R.Icon.NONE,function(r){var i=w.resolve(w.dirname(f().getPath()),e.destination),o=e.node.lowLevel().dump(),a=u(o),s=p(a.length>1?a[1]:a[0]);o=o.substring(e.node.lowLevel().keyEnd()-e.node.lowLevel().start()+1).trim(),o=d(o,s),o="#%RAML 0.8 "+e.node.definition().nameId()+"\n"+o,x.writeFileSync(i,o);var l=n.lowLevel().unit().contents(),c=l.substring(n.lowLevel().end()),h=l.substring(0,n.lowLevel().keyEnd()+1),m=h+" !include "+e.destination+c;f().setText(m),t.destroy()});s.setDisabled(!0),a.addChild(s),r.addChild(a);var l=r.renderUI();t=atom.workspace.addModalPanel({item:l}),l.focus()},e}();t.MoveToNewFileDialog=F,t.moveOut=h,t.renameRAMLElement=m;t.select=g,t.findUsagesImpl=E,t.findUsages=b;var q,j=function(e){function t(t,n){e.call(this),this.query=t,this._result=n,this.isAttached=!1}return C(t,e),t.prototype.initialize=function(){return e.prototype.initialize.apply(this,arguments),!0},t.content=function(){return this.div({"class":"raml-console pane-item",tabindex:-1})},t.prototype.attached=function(){this.isAttached||(this.load(),this.isAttached=!0)},t.prototype.setInput=function(e,t){this.query=e,this._result=t,this.load()},t.prototype.load=function(){var e=this,t=R.section("Find usages for "+this.query,R.Icon.SEARCH),n=R.list(this._result,function(e){var t=f().getBuffer().positionForCharacterIndex(e.getLowLevelStart()),n=R.hc(R.a(e.id(),function(t){G(f(),e)}),R.label(e.lowLevel().unit().path()+" line:",R.Icon.NONE,R.TextClasses.SUBTLE).pad(5,5),R.label(""+t.row,R.Icon.NONE,R.TextClasses.SUCCESS));return n});n.setStyle("max-height","400px"),t.addChild(n),t.addChild(R.button("Close",R.ButtonSizes.SMALL,R.ButtonHighlights.PRIMARY,R.Icon.NONE,function(t){e.panel.destroy(),q=null})),this.html(t.renderUI())},t}(M.ScrollView),G=function(e,t){var n=e.getBuffer().positionForCharacterIndex(t.getLowLevelStart()),r=e.getBuffer().positionForCharacterIndex(t.getLowLevelEnd());e.setSelectedBufferRange({start:n,end:r},{})},V=function(e,t){if(t.unit().absolutePath()!=e.getPath())return void atom.workspace.open(t.unit().absolutePath(),{}).then(function(n){e=f(),V(e,t)});var n=e.getBuffer().positionForCharacterIndex(t.start()),r=e.getBuffer().positionForCharacterIndex(t.end());r.column=n.column+t.key()?t.key().length:0,r.row=n.row,e.setSelectedBufferRange({start:n,end:r},{})};t.gotoDeclaration=S},function(e,t,n){function r(e){return g=e,f.addLoadCallback(function(e){atom.workspace.getTextEditors().forEach(function(e){return E(e)});var t=v.aquireManager();t&&t.updateDetails()}),atom.workspace.observeTextEditors(E),{dispose:function(){y.forEach(function(t){i(e,t)})}}}function i(e,t){e.deleteMessages(t),e.deleteLinter(t)}function o(e,t){e.linterCallback=t}function a(e){e.linterCallback=null}function s(e){e.linterCallback&&(e.linterCallback(),a(e))}function l(e){var t=u(e);return f.hasAsyncRequests()?[]:t}function u(e){if(s(e),f.hasAsyncRequests())return[];var t=(new Date).getTime(),n=m.ast(e);if(null==n)return[];for(var r=[],i=(new b(e,r),n.lowLevel()?n.lowLevel().unit().contents():""),o=0;;){var o=i.indexOf("	",o);if(-1==o)break;var a=e.getBuffer().positionForCharacterIndex(o),l=e.getBuffer().positionForCharacterIndex(o+1),u="Using tabs  can lead to unpredictable results",d={type:"Warning",filePath:e.getPath(),text:u,trace:[],range:[[a.row,a.column],[l.row,l.column]]};r.push(d),o++}if(!n.lowLevel())return[];c(n,r,e);var p=(new Date).getTime(),h={};r.forEach(function(e){var t=JSON.parse(JSON.stringify(e));t.trace=null;var n=JSON.stringify(t),r=h[n];r?r.push(e):h[n]=[e]});var y=[];for(var g in h){var E=JSON.parse(g);E.trace=[];var T=h[g];T.forEach(function(e){e.trace&&(E.trace=E.trace.concat(e.trace))}),y.push(E)}return v.aquireManager()&&v.aquireManager().performanceDebug&&console.log("Linting took:"+(p-t)),y}function c(e,t,n){e&&e.validate(new b(n,t))}var d=n(14),p=n(15),f=p.utils,h=n(21),m=n(30),v=n(4);t.grammarScopes=["source.raml"],t.scope="file",t.lintOnFly=!0;var y=[],g={},E=function(e){var t=e.getPath&&e.getPath(),n=t&&d.extname(t),r=n&&n.toLowerCase(),s=g.getEditorLinter(e);if(y.push(s),".raml"===r||".yaml"===r){var u=l(e);f.hasAsyncRequests()||(g.setMessages(s,u),console.log("Messages: "+u.length)),o(e,function(){return g.deleteMessages(s)}),s.onDidDestroy(function(){a(e)}),e.onDidDestroy(function(){i(g,s)})}};t.initEditorObservers=r,t.lint=l;var b=function(){function e(e,t){this.editor=e,this.errors=t,this.buffers={}}return e.prototype.begin=function(){},e.prototype.accept=function(e){var t=this,n=this.editor.getBuffer().positionForCharacterIndex(e.start),r=this.editor.getBuffer().positionForCharacterIndex(e.end),i=e.message,o=i.lastIndexOf(" at line ");-1!=o&&(i=i.substring(0,o));var a={type:e.isWarning?"Warning":"Error",filePath:e.path?e.path:this.editor.getPath(),text:i,trace:[],range:[[n.row,n.column],[r.row,r.column]]};this.errors.push(a),e.extras&&e.extras.forEach(function(e){var n=e.message,r=t.editor.getBuffer(),i=e.path;e.unit&&(i=e.unit.absolutePath()),i&&(t.buffers[i]?r=t.buffers[i]:(r=new h(e.unit.contents()),t.buffers[i]=r));var o=r.positionForCharacterIndex(e.start),s=r.positionForCharacterIndex(e.end),l={type:"Trace",filePath:e.path?i:t.editor.getPath(),text:n,range:[[o.row,o.column],[s.row,s.column]]};a.trace.push(l)})},e.prototype.end=function(){},e}()},function(e,t,n){function r(e,t,n,r){if(!d.find(s(),function(e){return e==t?!0:!1})){var i=atom.commands.add(e,t,n),o={commandId:t,tag:r,disposable:i};if(p[t]=o,r){var a=f[r];a||(a=[],f[r]=a),a.push(o)}}}function i(e){atom.commands.registeredCommands[e]=null,atom.commands.selectorBasedListenersByCommandName[e]=null}function o(e){var t=p[e];if(t&&(t.disposable.dispose(),delete p[e],t.tag)){var n=f[t.tag];if(!n)return;var r=-1;d.find(n,function(t,n){return t.commandId==e?(r=n,!0):!1}),-1!=r&&n.splice(r,1)}}function a(e){var t=f[e];if(t){for(var n in t){var r=t[n];r.disposable.dispose(),delete p[r.commandId]}delete f[e]}}function s(){var e=[];for(var t in atom.commands.selectorBasedListenersByCommandName)e.push(t);return e}function l(){if(!h){h=!0;try{atom.packages.activatePackage("command-palette");var e=function(){c()};e.commandManager=!0,atom.commands.add("atom-workspace","command-palette:toggle",e);var t=atom.commands.selectorBasedListenersByCommandName["command-palette:toggle"];t.forEach(function(e){e.callback.commandManager&&(e.sequenceNumber=1005e5)})}catch(n){console.error(n.message)}}}function u(e){m[e.id]=e}function c(){a(t.DYNAMIC_COMMAND_TAG);for(var e in m){var n=m[e];n.calculationStarted&&n.calculationStarted()}for(var e in m){var n=m[e];n.calculateItems().forEach(function(e){r(e.selector,"api-workbench:"+e.id,e.callBack,t.DYNAMIC_COMMAND_TAG)})}for(var e in m){var n=m[e];n.calculationFinished&&n.calculationFinished()}}var d=n(20);t.DYNAMIC_COMMAND_TAG="DYNAMIC_COMMAND_TAG";var p={},f={};t.addCommand=r,t.deleteUnmanagedCommand=i,t.deleteManagedCommand=o,t.deleteCommandsByTag=a,t.listCommands=s;var h=!1;t.initialize=l;var m={};t.registerContributor=u},function(e,t,n){function r(){E||(E=!0,m=atom.contextMenu.constructor.prototype.showForEvent,atom.contextMenu.constructor.prototype.showForEvent=function(e){l(),m.apply(atom.contextMenu,[e]),p()})}function i(e){g[e.id]=e}function o(e,t,n,r){}function a(e){}function s(e,t,n){}function l(){try{var e=f(),t={};d(),y.deleteCommandsByTag(y.DYNAMIC_COMMAND_TAG),e.forEach(function(e){var n=t[e.selector];n||(n=c(e.selector),t[e.selector]=n);var r=u(e);n.items.push(r)})}catch(n){console.log(n.message)}}function u(e){var t={label:e.name};if(e.children.length>0)t.submenu=[];else{var n="api-workbench:"+e.name;y.listCommands();y.addCommand(e.selector,n,e.onClick,y.DYNAMIC_COMMAND_TAG),t.command=n}return e.children.forEach(function(e){var n=u(e);t.submenu.push(n)}),t}function c(e){var t=v.find(atom.contextMenu.itemSets,function(e){return e.tag&&e.tag==S});return t||(t={items:[],selector:e,specificity:11,tag:S},atom.contextMenu.itemSets.push(t),v.find(T,function(t){return t==e})||T.push(e)),t}function d(){var e=v.filter(atom.contextMenu.itemSets,function(e){return e.tag&&e.tag==S});e.forEach(function(e){e.items=[]})}function p(){}function f(){var e=[];for(var t in g){var n=g[t];n.calculationStarted&&n.calculationStarted()}for(var t in g){var n=g[t];n.calculateItems().forEach(function(t){h(e,t)})}for(var t in g){var n=g[t];n.calculationFinished&&n.calculationFinished()}return e}function h(e,t){var n=e;if(t.categories)for(var r in t.categories){var i=t.categories[r],o=v.find(n,function(e){return e.name==i});o||(o=new b(t,i),n.push(o)),o.children?n=o.children:(n=[],o.children=n)}var a=v.find(n,function(e){return e.name==t.name});if(a){var s=n.indexOf(a,0);void 0!=s&&n.splice(s,1)}a=new b(t),n.push(a)}var m,v=n(20),y=n(10);t.initialize=r,t.registerContributor=i,t.addMenuItem=o,t.deleteMenuItems=a,t.deleteMenuItem=s;var g={},E=!1,b=function(){function e(e,t){this.selector=e.selector,t?this.name=t:this.name=e.name,this.categories=e.categories,this.onClick=e.onClick,this.children=[]}return e}(),T=[],S="DYNAMIC_SET_TAG"},function(e,t,n){function r(){}function i(){o(),r()}function o(){var e={id:"editorContextActionContributor",calculateItems:function(){var e=l.calculateCurrentActions(l.TARGET_RAML_EDITOR_NODE);if(!e)return[];var t=[];return e.forEach(function(e){t.push({selector:'atom-text-editor[data-grammar="source raml"],.raml-outline',name:e.label?e.label:e.name,categories:e.category,onClick:e.onClick})}),t}};a.registerContributor(e);var t={id:"editorContextActionContributor",calculateItems:function(){var e=l.calculateCurrentActions(l.TARGET_RAML_EDITOR_NODE);if(!e)return[];var t=[];return e.forEach(function(e){t.push({selector:'atom-text-editor[data-grammar="source raml"],.raml-outline',id:e.label?e.label:e.name,callBack:e.onClick})}),t}};s.registerContributor(t)}var a=n(11),s=n(10),l=n(24),u=n(14),c=n(6),d=n(15),p=d.search,f=n(4);t.initialize=i;var h=function(){function e(){}return e.prototype.calculate=function(){},e}();t.NullCalculator=h;var m=function(){function e(){var e=this;this.state=null,this.contextCalculationStarted=function(){null==e.state&&(e.state=e.calculateState())},this.contextCalculationFinished=function(){e.state=null}}return e.prototype.calculate=function(){return null==this.state&&(this.state=this.calculateState()),this.state},e.prototype.calculateState=function(){var e=!1,t=null;if(atom.workspace.getActiveTextEditor()?t=atom.workspace.getActiveTextEditor():f.aquireManager()&&(t=f.aquireManager().getCurrentEditor(),e=!0),!t)return null;if(".raml"!=u.extname(t.getPath()))return null;var n={editor:t,bufferPosition:t.getCursorBufferPosition()},r=null;if(e)r=f.aquireManager().getSelectedNode();else{if(t.getBuffer()){var i=t.getBuffer().getEndPosition();if(i.column==n.bufferPosition.column&&i.row==n.bufferPosition.row)return null;if(0==n.bufferPosition.row&&0==n.bufferPosition.column)return null}r=c.getAstNode(n,!1)}if(!r)return null;var o=n.editor.getBuffer().characterIndexForPosition(n.bufferPosition),a=p.determineCompletionKind(t.getBuffer().getText(),o);return{editor:t,offset:o,node:r,completionKind:a}},e}();t.GeneralASTStateCalculator=m,t.generalASTStateCalculator=new m;var v=function(){function e(){this.contextCalculationStarted=function(){t.generalASTStateCalculator.contextCalculationStarted()},this.contextCalculationFinished=function(){t.generalASTStateCalculator.contextCalculationFinished()}}return e.prototype.calculate=function(){return null},e.prototype.getGeneralState=function(){return t.generalASTStateCalculator.calculate()},e.prototype.getEditor=function(){return f.aquireManager()?f.aquireManager().getCurrentEditor():atom.workspace.getActiveTextEditor()},e}();t.CommonASTStateCalculator=v},function(e,t,n){function r(e){new D(e,"Create Global Schema").show()}function i(e,t,n){var r=N.getActiveEditor(),i=p.resolve(p.dirname(r.getPath()),p.dirname(t));d.existsSync(i)||d.mkdirSync(i);var o=p.resolve(p.dirname(r.getPath()),t);d.writeFileSync(o,n)}function o(e){for(var t="",n=0;n<e.length;n++){var r=e[n];if("\r"!=r&&"\n"!=r){if(" "!=r&&"	"!=r)break;t+=r}}return t}function a(e,t){for(var n=N.splitOnLines(e),r=[],i=0;i<n.length;i++)0==i?r.push(n[0]):r.push(n[i].substring(t.length));return r.join("")}function s(e,t){if((e.keyStart()>t||e.valueEnd()<t)&&e.parent())return null;if(e.includedFrom())return s(e.includedFrom(),t);var n=e.children();for(var r in n){var i=n[r],o=s(i,t);if(o)return o}return e}function l(e){return e.includedFrom()?e.includedFrom():e.children()&&0!==e.children().length?l(e.children().filter(function(e){return e?!0:!1})[e.children().length-1]):e}function u(){A.addAction({name:"Create global schema",target:A.TARGET_RAML_EDITOR_NODE,category:["Code"],onClick:function(e){return r(e)},stateCalculator:new R,shouldDisplay:function(e){return null!=e}}),A.addAction({name:"Move resource",target:A.TARGET_RAML_EDITOR_NODE,category:["Refactoring"],onClick:function(e){new w.MoveElementsDialog(e,"Resource Type",!0).show()},stateCalculator:new O,shouldDisplay:function(e){return null!=e}}),A.addAction({name:"Complete body",target:A.TARGET_RAML_EDITOR_NODE,category:["Add new..."],onClick:function(e){var t=e;t.lowLevel().show("BODY"),new B(t.parent().parent(),t).show()},stateCalculator:new k,shouldDisplay:function(e){return null!=e}}),A.addAction({name:"Extract Resource Type",target:A.TARGET_RAML_EDITOR_NODE,category:["Refactoring"],onClick:function(e){new S.ExtractTypesAndTraitsDialog(e,"Resource Type",!0).show()},stateCalculator:new U,shouldDisplay:function(e){return null!=e}}),A.addAction({name:"Extract Trait",target:A.TARGET_RAML_EDITOR_NODE,category:["Refactoring"],onClick:function(e){new S.ExtractTypesAndTraitsDialog(e,"Trait",!1).show()},stateCalculator:new F,shouldDisplay:function(e){return null!=e}}),A.addAction({name:"Move content to other file",target:A.TARGET_RAML_EDITOR_NODE,category:["Refactoring"],onClick:function(e){new H(e).show()},stateCalculator:new q,shouldDisplay:function(e){return null!=e}}),A.addAction({name:"Convert JSON schema to type",target:A.TARGET_RAML_EDITOR_NODE,category:["Refactoring"],onClick:function(e){new M(e,"Convert JSON schema to type").show()},stateCalculator:new j,shouldDisplay:function(e){return null!=e}}),A.addAction({name:"Expand type to JSON schema",target:A.TARGET_RAML_EDITOR_NODE,category:["Refactoring"],onClick:function(e){var t=e,n=t.root(),r=t.attrValue("type"),i=n.elementsOfKind("types"),o=E.find(i,function(e){return e.name()==r});if(o){t.attr("type").setValue("");var a=y.createModelToSchemaGenerator().generateSchema(o),s=JSON.stringify(a,null,2);t.attrOrCreate("schema").setValue(s),s=n.lowLevel().unit().contents(),N.getActiveEditor().setText(s)}},stateCalculator:new G,shouldDisplay:function(e){return null!=e}}),A.addAction({name:"Expand type to JSON schema definition",target:A.TARGET_RAML_EDITOR_NODE,category:["Refactoring"],onClick:function(e){var t=e,n=t.root(),r=y.createModelToSchemaGenerator().generateSchema(t),i=JSON.stringify(r,null,2);console.log("schema: "+i);var o=m.createStubNoParentPatch(n,"schemas",t.name());o.attrOrCreate("value").setValue(i),n.add(o);var a=n.lowLevel().unit().contents();N.getActiveEditor().setText(a)},stateCalculator:new V,shouldDisplay:function(e){return null!=e}}),A.addAction({name:"Extract Library",target:A.TARGET_RAML_EDITOR_NODE,category:["Refactoring"],onClick:function(e){new S.ExtractLibraryDialog(e,"Extract Library").show()},stateCalculator:new K,shouldDisplay:function(e){return null!=e}}),A.addAction({name:"Extract Overlay",target:A.TARGET_RAML_EDITOR_NODE,category:["Code"],onClick:function(e){new S.ExtractOverlayDialog(e,"Extract Overlay").show()},stateCalculator:new W,shouldDisplay:function(e){return null!=e}}),A.addAction({name:"Modify Overlay",target:A.TARGET_RAML_EDITOR_NODE,category:["Code"],onClick:function(e){new S.ModifyOverlayDialog(e,"Modify Overlay").show()},stateCalculator:new z,shouldDisplay:function(e){return null!=e}}),A.addAction({name:"Pull Up",target:A.TARGET_RAML_EDITOR_NODE,category:["Refactoring"],onClick:function(e){new S.PullUpDialog(e,"Pull Up").show()},stateCalculator:new J,shouldDisplay:function(e){return null!=e}}),A.addAction({name:"Extract Supertype",target:A.TARGET_RAML_EDITOR_NODE,category:["Refactoring"],onClick:function(e){new S.ExtractSupertypeDialog(e,"Extract Supertype").show()},stateCalculator:new X,shouldDisplay:function(e){return null!=e}}),A.addAction({name:"Comment node",target:A.TARGET_RAML_EDITOR_NODE,category:["Code"],onClick:function(e){var t=e.node;if(t.lowLevel()){var n=s(t.lowLevel(),e.offset);if(n){var r=n.keyStart()>-1?n.keyStart():n.start();n=l(n);for(var i=n.valueEnd()>-1?n.valueEnd():n.end(),o=e.editor.getBuffer(),a=o.positionForCharacterIndex(r),u=a.row,c=o.positionForCharacterIndex(i),d=c.row,p=u;d>=p;p++){var f=o.rangeForRow(p,!0),h=o.getTextInRange(f),m="#"+h;o.setTextInRange(f,m)}}}},stateCalculator:new Q,shouldDisplay:function(e){return null!=e}})}var c=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},d=n(17),p=n(14),f=n(15),h=f.search,m=f.stubs,v=f.universeHelpers,y=f.schema,g=f.parser.modify,E=n(20),b=n(19),T=n(32),S=n(33),C=n(34),x=f.ds,w=n(29),A=n(24),I=n(12),N=n(8),P=x,L=function(){function e(e,t){this.parentNode=e,this.name=t}return e.prototype.validate=function(){return null},e.prototype.performOk=function(){},e.prototype.createBody=function(e){},e.prototype.show=function(){if(console.log("Original node tree:"),this.getParentNode()&&console.log(this.getParentNode().printDetails()),this.getParentNode()){
var e=b.section(this.name+":",b.Icon.GIST_NEW,!1,!1);this.createValidationIndicator(e),this.createBody(e),this.createButtonBar(e),e.setPercentWidth(100);var t=e.renderUI();this.rootAtomPanel=atom.workspace.addModalPanel({item:t}),t.focus(),this.performValidation()}},e.prototype.performValidation=function(){var e=this.validate();this.okButton&&(e?this.okButton.setDisabled(!0):this.okButton.setDisabled(!1)),this.errorLabel&&(e?(this.errorLabel.setDisplay(!0),this.errorLabel.setText(e)):(this.errorLabel.setDisplay(!1),this.errorLabel.setText("")))},e.prototype.createValidationIndicator=function(e){this.errorLabel=b.label("",b.Icon.BUG,b.TextClasses.ERROR,b.HighLightClasses.NONE),e.addChild(b.vc(this.errorLabel))},e.prototype.saveUnit=function(e){var t=e.absolutePath(),n=e.contents(),r=E.find(atom.workspace.getTextEditors(),function(e){var n=e.getPath();return n==t});r?r.setText(n):d.writeFileSync(t,n)},e.prototype.createButtonBar=function(e){var t=this,n=b.hc().setPercentWidth(100).setStyle("display","flex");n.addChild(b.label("",null,null,null).setStyle("flex","1")),n.addChild(b.button("Cancel",b.ButtonSizes.NORMAL,b.ButtonHighlights.NO_HIGHLIGHT,b.Icon.NONE,function(e){t.rootAtomPanel.destroy()}).margin(10,10)),this.okButton=b.button("Extract",b.ButtonSizes.NORMAL,b.ButtonHighlights.SUCCESS,b.Icon.NONE,function(e){t.performOk(),t.rootAtomPanel.destroy()}),this.okButton.setDisabled(!0),n.addChild(this.okButton),e.addChild(n)},e.prototype.getParentNode=function(){return this.parentNode},e.prototype.getActiveEditor=function(){return N.getActiveEditor()},e.prototype.getNodeId=function(e){if(e.parent()){var t=this.getNodeId(e.parent());t+="."+e.name();var n=e.parent().directChildren().filter(function(t){return t.name()==e.name()});if(n.length>1){var r=n.indexOf(e);t+="["+r+"]"}return t}return e.name()?e.definition&&e.definition()&&"Api"==e.definition().name()?"":"."+e.name():""},e.prototype.nodesEqualById=function(e,t){return this.getNodeId(e)==this.getNodeId(t)},e.prototype.isParentOf=function(e,t){for(var n=t.parent();null!=n;){if(n==e||this.nodesEqualById(n,e))return!0;n=n.parent()}return!1},e}();t.AbstractDialogWithValidation=L;var O=function(e){function t(){e.apply(this,arguments)}return c(t,e),t.prototype.calculate=function(){var e=this.getGeneralState();if(!e)return null;if(e.completionKind!=h.LocationKind.KEY_COMPLETION)return null;var t=e.node;return v.isResourceType(t.definition())?t:null},t}(I.CommonASTStateCalculator),R=function(e){function t(){e.apply(this,arguments)}return c(t,e),t.prototype.calculate=function(){var e=this.getGeneralState();if(!e)return null;if(e.completionKind!=h.LocationKind.VALUE_COMPLETION&&e.completionKind!=h.LocationKind.KEY_COMPLETION)return null;var t=e.node,n=E.find(t.attrs(),function(t){return t.lowLevel().start()<e.offset&&t.lowLevel().end()>=e.offset&&!t.property().getAdapter(P.RAMLPropertyService).isKey()});if(!n)return null;if(!n.value())return null;var r=n.property();if(!v.isSchemaProperty(r))return null;var i=(n.value(),h.referenceTargets(r,t)),o=E.find(i,function(e){return e.name()==n.value()});return o?null:n},t}(I.CommonASTStateCalculator),M=function(e){function t(){e.apply(this,arguments)}return c(t,e),t.prototype.createBody=function(e){var t=this;e.addChild(b.label("Type name:").pad(5,0)),this.typeNameTextField=b.texfField("","NewType",function(e){t.performValidation()}),e.addChild(this.typeNameTextField)},t.prototype.validate=function(){if(!this.typeNameTextField||!this.typeNameTextField.getBinding())return null;var e=this.typeNameTextField.getBinding().get();return 0==e.trim().length?"Enter type name":null},t.prototype.performOk=function(){var e=this.getParentNode(),t=e.root(),n=e.attrValue("schema");e.attr("schema").setValue("");var r=this.typeNameTextField.getBinding().get(),i=y.createSchemaModelGenerator().generateTo(t,n,r);i.length>0&&e.attrOrCreate("type").setValue(i[0]),this.saveUnit(t.lowLevel().unit())},t}(L);t.ExtractJSONSchemaToTypeDialog=M;var D=function(e){function t(){e.apply(this,arguments)}return c(t,e),t.prototype.createBody=function(e){var t=this;e.addChild(b.label("Schema name:").pad(5,0)),this.schemaNameTextField=b.texfField("",this.getDefaultSchemaName(),function(e){t.performValidation()}),e.addChild(this.schemaNameTextField)},t.prototype.validate=function(){if(!this.schemaNameTextField||!this.schemaNameTextField.getBinding())return null;var e=this.schemaNameTextField.getBinding().get();if(0==e.trim().length)return"Enter schema name";var t=this.getParentNode(),n=t.value(),r=this.getSchemaFilePath(e,n);return d.existsSync(r)?"Schema file "+r+" already exists":null},t.prototype.performOk=function(){var e=this.schemaNameTextField.getBinding().get(),t=this.getParentNode(),n=t.value(),r=this.getSchemaFilePath(e,n),i=t.parent().root(),o=t.property().range().universe().type("GlobalSchema"),a=m.createStubNode(o,o.universe().type("Api").property("schemas"),e);a.attrOrCreate("value").setValue("!include "+this.getSchemaRelativePath(e,n)),i.add(a),t.setValue(e),this.saveUnit(t.lowLevel().unit());var s=p.dirname(r);d.existsSync(s)||d.mkdirSync(s),d.writeFileSync(r,n)},t.prototype.getSchemaFilePath=function(e,t){var n=p.resolve(p.dirname(this.getActiveEditor().getPath()),"schemas"),r=this.determineSchemaExtension(t),i=e+"."+r;return p.resolve(n,i)},t.prototype.getSchemaRelativePath=function(e,t){var n=this.determineSchemaExtension(t),r=e+"."+n;return"schemas/"+r},t.prototype.determineSchemaExtension=function(e){var t=e.trim();return 0==t.indexOf("{")||0==t.indexOf("[")?"json":"xsd"},t.prototype.getDefaultSchemaName=function(){return"NewSchema"},t}(L);t.CreateGlobalSchemaDialog=D,t.createGlobalSchema=r;var _=(function(e){function t(){e.apply(this,arguments)}return c(t,e),t.prototype.calculate=function(){var e=this.getGeneralState();if(!e)return null;if(e.completionKind!=h.LocationKind.VALUE_COMPLETION)return null;var t=e.node,n=E.find(t.attrs(),function(t){return t.lowLevel().start()<e.offset&&t.lowLevel().end()>=e.offset&&!t.property().getAdapter(P.RAMLPropertyService).isKey()});if(!n)return null;if(!n.value())return null;n.property();return n},t}(I.CommonASTStateCalculator),function(e,t){for(var n=e,r=e;r>=0;r--){var i=t.charAt(r);if(" "==i||"\r"==i||"\n"==i||"	"==i){n=r+1;break}}for(var o="",r=n;r<t.length;r++){var i=t.charAt(r);if(" "==i||"\r"==i||"\n"==i||"	"==i||":"==i)break;o+=i}return o}),k=function(e){function t(){e.apply(this,arguments)}return c(t,e),t.prototype.calculate=function(){var e=this.getGeneralState();if(!e)return null;if(e.completionKind!=h.LocationKind.KEY_COMPLETION)return null;var t=e.node;if(v.isResponseType(t.definition())||v.isMethodType(t.definition())){var n=e.editor.getText(),r=_(e.offset,n);if("body"==r)return t}return v.isBodyLikeType(t.definition())&&0==t.elements().length?t:null},t}(I.CommonASTStateCalculator);t.saveExample=i;var B=function(){function e(e,t,n){void 0===n&&(n="Fill body"),this.h=e,this.body=t,this.title=n,this.name="",this.needXML=!0,this.needJSON=!0,this.jsexample='{\n "message":"Hello world"\n}',this.xmlexample="",this.xmlschema="",this.jsschema=""}return e.prototype.extraContent=function(e){},e.prototype.updateButtons=function(){if(this.createButton){if(0==this.name.length)return this.createButton.setDisabled(!0),this.em.setDisplay(!0),void this.em.setText("Please type name of your payload");if(this.needJSON){try{JSON.parse(this.jsexample)}catch(e){return this.createButton.setDisabled(!0),this.em.setDisplay(!0),void this.em.setText("JSON example is not correct")}try{y.getJSONSchema(this.jsschema,null)}catch(e){return this.createButton.setDisabled(!0),this.em.setDisplay(!0),void this.em.setText("JSON schema is not correct")}}if(this.needXML){try{T(this.xmlexample)}catch(e){return this.createButton.setDisabled(!0),this.em.setDisplay(!0),void this.em.setText("XML example is not correct")}try{y.getXMLSchema(this.xmlschema)}catch(e){return this.createButton.setDisabled(!0),this.em.setDisplay(!0),void this.em.setText("XML schema is not correct")}}this.em.setDisplay(!1),this.createButton.setDisabled(!1)}},e.prototype.show=function(){var e=this,t=null;this.em=b.label("Please type name of your payload",b.Icon.BUG,b.TextClasses.ERROR,b.HighLightClasses.NONE);var n=b.section(this.title,b.Icon.BOOK,!1,!1,this.em,b.h3("Please type name for your payload")).pad(10,10);n.addChild(b.texfField("",this.name,function(t){e.name=t.getBinding().get(),e.updateButtons()}));var r=b.checkBox("Create XML body");r.setValue(this.needXML),r.getBinding().addListener(function(t){e.needXML=r.getValue(),e.updateButtons()}),n.addChild(r);var i=b.checkBox("Create JSON body");i.setValue(this.needJSON),i.getBinding().addListener(function(t){e.needJSON=i.getValue(),e.updateButtons()}),n.addChild(i);var o=b.hc().setPercentWidth(100).setStyle("display","flex");o.addChild(b.label("",null,null,null).setStyle("flex","1")),o.addChild(b.button("Cancel",b.ButtonSizes.NORMAL,b.ButtonHighlights.NO_HIGHLIGHT,b.Icon.NONE,function(e){t.destroy()}).margin(10,10)),this.createButton=b.button("Create",b.ButtonSizes.NORMAL,b.ButtonHighlights.SUCCESS,b.Icon.NONE,function(n){e.onOk(t),t.destroy()}),o.addChild(this.createButton);var a=new b.TabFolder;this.createButton.setDisabled(!0),this.createTextSection(a,"JSON Example","source.json","jsexample"),this.createTextSection(a,"JSON Schema","source.json","jsschema"),this.createTextSection(a,"XML Example","text.xml","xmlexample"),this.createTextSection(a,"XML Schema","text.xml","xmlschema"),a.setOnSelected(function(){var t=a.selectedComponent(),n=t.children()[1];n.setText(e[t.id()])}),n.addChild(a),n.addChild(o),t=atom.workspace.addModalPanel({item:n.renderUI()})},e.prototype.createTextSection=function(e,t,n,r){var i=this,o=b.vc();o.setCaption(t),o.setId(r);var a=new b.AtomEditorElement("",function(e){return e});if(a.setMini(!1),a.getBinding().addListener(function(e){i[r]=a.getValue(),i.updateButtons()}),a.setText(""+this[r]),a.setCaption(t),a.setGrammar(n),a.setStyle("height","400px"),a.setStyle("border","solid"),a.setStyle("border-width","1px"),o.addChild(b.h3("Please type your example here:")),o.addChild(a),"jsexample"==r){var s=b.button("Generate JSON schema",b.ButtonSizes.NORMAL,b.ButtonHighlights.SUCCESS,b.Icon.NONE,function(t){try{var n=C.generateSchema(i.jsexample,"application/json");i.jsschema=n,e.setSelectedIndex(1)}catch(r){i.jsschema=r.message,e.setSelectedIndex(1)}});o.addChild(s.margin(5,5,5,5))}if("xmlexample"==r){var s=b.button("Generate JSON example",b.ButtonSizes.NORMAL,b.ButtonHighlights.SUCCESS,b.Icon.NONE,function(t){try{var n=T(i.xmlexample);i.jsexample=JSON.stringify(n,null,2),e.setSelectedIndex(0)}catch(r){i.jsexample=r.message,e.setSelectedIndex(0)}});o.addChild(s.margin(5,5,5,5))}e.add(t,null,o)},e.prototype.onOk=function(e){var t=this.body.definition().universe().type("BodyLike");if(t){var n=this.body;v.isBodyProperty(n.property())&&(n=n.parent());var r=n.definition();if(this.needJSON){var o=m.createStubNode(t,r.property("name"),"application/json");o.createAttr("schema",this.name),o.createAttr("example","!include ./examples/"+this.name+".json"),n.add(o),N.createGlobalSchemaFromNameAndContent(this.h.root(),this.name,"schemas/"+this.name+".json",this.jsschema),i(this.h,"./examples/"+this.name+".json",this.jsexample)}if(this.needXML){var o=m.createStubNode(t,r.property("name"),"application/xml");o.createAttr("schema",this.name+"-xml"),o.createAttr("example","!include ./examples/"+this.name+".xml"),n.add(o);var a=this.xmlschema;N.createGlobalSchemaFromNameAndContent(this.h.root(),this.name+"-xml","schemas/"+this.name+".xml",a),i(this.h,"./examples/"+this.name+".xml",this.xmlexample)}}else{var s=this.body;if(!v.isResponseType(s.property().range()))return void console.log("Incorrect parent "+s.printDetails()+" , expecting response");var l=s.wrapperNode(),u=[];if(this.needJSON){var c="application/json",d=g.createTypeDeclaration(c);g.setTypeDeclarationSchema(d,this.name),g.setTypeDeclarationExample(d,"!include ./examples/"+this.name+".json"),N.createGlobalSchemaFromNameAndContent(this.h.root(),this.name,"schemas/"+this.name+".json",this.jsschema),i(this.h,"./examples/"+this.name+".json",this.jsexample),u.push(d)}if(this.needXML){var c="application/xml",d=g.createTypeDeclaration(c);g.setTypeDeclarationSchema(d,this.name+"-xml"),g.setTypeDeclarationExample(d,"!include ./examples/"+this.name+".xml");var a=this.xmlschema;N.createGlobalSchemaFromNameAndContent(this.h.root(),this.name+"-xml","schemas/"+this.name+".xsd",a),i(this.h,"./examples/"+this.name+".xml",this.xmlexample),u.push(d)}u.forEach(function(e){var t=E.find(l.body()||[],function(t){return e.name()===t.name()});t&&l.remove(t),g.addChild(l,e)})}var p=this.h.lowLevel().unit().contents();N.getActiveEditor().setText(N.cleanEmptyLines(p))},e}(),U=function(e){function t(){e.apply(this,arguments)}return c(t,e),t.prototype.calculate=function(){var e=this.getGeneralState();if(!e)return null;if(e.completionKind!=h.LocationKind.KEY_COMPLETION)return null;var t=e.node;return v.isResourceType(t.definition())?t:null},t}(I.CommonASTStateCalculator),F=function(e){function t(){e.apply(this,arguments)}return c(t,e),t.prototype.calculate=function(){var e=this.getGeneralState();if(!e)return null;if(e.completionKind!=h.LocationKind.KEY_COMPLETION)return null;var t=e.node;return v.isMethodType(t.definition())?t:null},t}(I.CommonASTStateCalculator),q=function(e){function t(){e.apply(this,arguments)}return c(t,e),t.prototype.calculate=function(){var e=this.getGeneralState();if(!e)return null;if(e.completionKind!=h.LocationKind.KEY_COMPLETION)return null;var t=e.node;return 0==t.children().length?null:t},t}(I.CommonASTStateCalculator),j=function(e){function t(){e.apply(this,arguments)}return c(t,e),t.prototype.calculate=function(){var e=this.getGeneralState();if(!e)return null;var t=e.node;if(e.completionKind!=h.LocationKind.KEY_COMPLETION&&e.completionKind!=h.LocationKind.VALUE_COMPLETION)return null;var n=E.find(t.attrs(),function(t){return t.lowLevel().start()<e.offset&&t.lowLevel().end()>=e.offset&&!t.property().getAdapter(P.RAMLPropertyService).isKey()});if(!n)return null;if(!n.value())return null;var r=n.property();return v.isSchemaProperty(r)?"string"!=typeof n.value()||-1==n.value().indexOf("{")?null:t:null},t}(I.CommonASTStateCalculator),G=function(e){function t(){e.apply(this,arguments)}return c(t,e),t.prototype.calculate=function(){var e=this.getGeneralState();if(!e)return null;var t=e.node;if(e.completionKind!=h.LocationKind.KEY_COMPLETION&&e.completionKind!=h.LocationKind.VALUE_COMPLETION)return null;var n=(e.editor.getText(),E.find(t.attrs(),function(t){return t.lowLevel().start()<e.offset&&t.lowLevel().end()>=e.offset&&!t.property().getAdapter(P.RAMLPropertyService).isKey()}));if(!n)return null;if(!n.value())return null;var r=n.property();return v.isTypeProperty(r)?t:null},t}(I.CommonASTStateCalculator),V=function(e){function t(){e.apply(this,arguments)}return c(t,e),t.prototype.calculate=function(){var e=this.getGeneralState();if(!e)return null;var t=e.node;return e.completionKind!=h.LocationKind.SEQUENCE_KEY_COPLETION?null:v.isTypesProperty(t.property())?t:null},t}(I.CommonASTStateCalculator),H=function(){function e(e){this.node=e}return e.prototype.show=function(){var e=this,t=null,n=this.node,r=b.section("Move node content to new file ",b.Icon.GIST_NEW,!1,!1),i=b.label("Please enter destination file path",b.Icon.BUG,b.TextClasses.ERROR,b.HighLightClasses.NONE);r.addChild(b.vc(i)),r.addChild(b.label("Please enter destination path"));var s=b.texfField("","",function(t){if(s){var n=null;if(e.destination=s.getBinding().get(),0==e.destination.trim().length)n="Please enter destination file path";else if(!p.extname(e.destination)||p.extname(e.destination).trim().length<=2)n="Please enter destination file extension";else{var r=p.resolve(p.dirname(N.getActiveEditor().getPath()),p.dirname(e.destination));if(d.existsSync(r)){var o=d.statSync(r);o.isDirectory()||(n="Parent path is not a directory")}else n="Parent directory does not exist"}n?(i.setDisplay(!0),i.setText(n),u.setDisabled(!0)):(i.setDisplay(!1),u.setDisabled(!1))}});r.addChild(b.vc(s));var l=b.hc().setPercentWidth(100).setStyle("display","flex");l.addChild(b.label("",null,null,null).setStyle("flex","1")),l.addChild(b.button("Cancel",b.ButtonSizes.NORMAL,b.ButtonHighlights.NO_HIGHLIGHT,b.Icon.NONE,function(e){t.destroy()}).margin(10,10));var u=b.button("Move",b.ButtonSizes.NORMAL,b.ButtonHighlights.SUCCESS,b.Icon.NONE,function(r){var i=p.resolve(p.dirname(N.getActiveEditor().getPath()),e.destination),s=e.node.lowLevel().dump(),l=N.splitOnLines(s),u=o(l.length>1?l[1]:l[0]);s=s.substring(e.node.lowLevel().keyEnd()-e.node.lowLevel().start()+1).trim(),s=a(s,u);var c="RAML10"===n.definition().universe().version()?"#%RAML 1.0 ":"#%RAML 0.8 ";s=c+e.node.definition().nameId()+"\n"+s,d.writeFileSync(i,s);var f=n.lowLevel().unit().contents(),h=f.substring(n.lowLevel().end()),m=f.substring(0,n.lowLevel().keyEnd()+1),v=m+" !include "+e.destination+h;N.getActiveEditor().setText(v),t.destroy()});u.setDisabled(!0),l.addChild(u),r.addChild(l);var c=r.renderUI();t=atom.workspace.addModalPanel({item:c}),c.focus()},e}();t.MoveToNewFileDialog=H;var K=function(e){function t(){e.apply(this,arguments)}return c(t,e),t.prototype.calculate=function(){var e=this.getGeneralState();if(!e)return null;for(var t=e.node;null!=t.parent();)t=t.parent();return t},t}(I.CommonASTStateCalculator),W=function(e){function t(){e.apply(this,arguments)}return c(t,e),t.prototype.calculate=function(){var e=this.getGeneralState();if(!e)return null;for(var t=e.node;null!=t.parent();)t=t.parent();return t},t}(I.CommonASTStateCalculator),z=function(e){function t(){e.apply(this,arguments)}return c(t,e),t.prototype.calculate=function(){var e=this.getGeneralState();if(!e)return null;for(var t=e.node;null!=t.parent();)t=t.parent();return t.definition&&v.isOverlayType(t.definition())?t:null},t}(I.CommonASTStateCalculator),Y=function(e){function t(){e.apply(this,arguments)}return c(t,e),t.prototype.isTypeNode=function(e){return e.property&&e.property().range&&v.isTypeDeclarationType(e.property().range())&&v.isTypesProperty(e.property())},t}(I.CommonASTStateCalculator),J=function(e){function t(){e.apply(this,arguments)}return c(t,e),t.prototype.calculate=function(){var e=this.getGeneralState();if(!e)return null;var t=e.node;if(!t)return null;for(;null!=t.parent();){if(this.isTypeNode(t)){var n=S.findUserDefinedSupertypes(t);return n&&n.length>0?t:null}t=t.parent()}return null},t}(Y),X=function(e){function t(){e.apply(this,arguments)}return c(t,e),t.prototype.calculate=function(){var e=this.getGeneralState();if(!e)return null;var t=e.node;if(!t)return null;for(;null!=t.parent();){if(this.isTypeNode(t)){var n=S.findUserDefinedSupertypes(t);return n&&0!=n.length?null:t}t=t.parent()}return null},t}(Y),Q=function(e){function t(){e.apply(this,arguments)}return c(t,e),t.prototype.calculate=function(){var e=this.getGeneralState();return e?e:null},t}(I.CommonASTStateCalculator);(function(e){function t(){e.apply(this,arguments)}return c(t,e),t.prototype.calculate=function(){var e=this.getGeneralState();if(!e)return null;var t=e.node;if(e.completionKind!=h.LocationKind.KEY_COMPLETION&&e.completionKind!=h.LocationKind.VALUE_COMPLETION)return null;var n=(e.editor.getText(),E.find(t.attrs(),function(t){return t.lowLevel().start()<e.offset&&t.lowLevel().end()>=e.offset&&!t.property().getAdapter(P.RAMLPropertyService).isKey()}));if(!n)return null;var r=n.property();if(!v.isExampleProperty(r))return null;var i=t.attr("type");if(!i)return null;var o=i.value();return o?t:null},t})(I.CommonASTStateCalculator);t.findLowLevelNodeByOffset=s,t.initialize=u},function(e,t,n){e.exports=require("path")},function(e,t,n){e.exports=require("raml-1-parser")},function(e,t,n){e.exports=require("url")},function(e,t,n){e.exports=require("fs")},function(e,t,n){e.exports=require("atom-space-pen-views")},function(e,t,n){e.exports=require("atom-ui-lib")},function(e,t,n){e.exports=require("underscore")},function(e,t,n){e.exports=require("basarat-text-buffer")},function(e,t,n){function r(e){atom.open(e)}var i=function(){function e(){}return e.prototype.onDidChangeActivePaneItem=function(e){return atom.workspace.onDidChangeActivePaneItem(e)},e.prototype.addModalPanel=function(e){return atom.workspace.addModalPanel(e)},e.prototype.getActiveTextEditor=function(){return atom.workspace.getActiveTextEditor()},e.prototype.getActivePane=function(){return atom.workspace.getActivePane()},e.prototype.getActiveEditor=function(){return atom.workspace.getActiveEditor()},e.prototype.addRightPanel=function(e){return atom.workspace.addRightPanel(e)},e.prototype.paneForItem=function(e){return atom.workspace.paneForItem(e)},e.prototype.getPaneItems=function(){return atom.workspace.getPaneItems()},e.prototype.onDidAddPaneItem=function(e){return atom.workspace.onDidAddPaneItem(e)},e.prototype.onDidDestroyPane=function(e){return atom.workspace.onDidDestroyPane(e)},e.prototype.open=function(e,t){atom.workspace.open(e,t)},e}();t.Workspace=i,t.open=r,t.workspace=new i;var o=function(){function e(){}return e.prototype.add=function(e,t,n){return atom.commands.add(e,t,n)},e}();t.CommandManager=o,t.commands=new o},function(e,t,n){var r=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},i=n(22),o=n(18),a=function(e){function t(t,n,r){void 0===r&&(r=""),e.call(this,[]),this._confirmed=t,this.label=n,this.filterKey=r}return r(t,e),t.prototype.getFilterKey=function(){return this.filterKey},t.prototype.viewForItem=function(e){return"<li>"+this.label(e)+"</li>"},t.prototype.cancel=function(){this.panel.hide(),e.prototype.cancel.call(this)},t.prototype.hide=function(){this.panel&&this.panel.hide()},t.prototype.confirmed=function(e){return this._confirmed(e),this.hide(),this.getSelectedItemView()},t.prototype.show=function(e){this.storeFocusedElement(),this.panel||(this.panel=i.workspace.addModalPanel({item:this})),this.setItems(e),this.panel.show(),this.focusFilterEditor()},t}(o.SelectListView);t.SelectListView=a},function(e,t,n){function r(e){s.find(u,function(t){return t.name==e.name})||u.push(e)}function i(e,t,n,i,o){var a={name:e,target:n,onClick:i,shouldDisplay:o,category:t};r(a)}function o(e){var t=[];try{var n=u.filter(function(t){return t.target==e});n.forEach(function(e){if(e.stateCalculator&&e.stateCalculator.contextCalculationStarted)try{e.stateCalculator.contextCalculationStarted()}catch(t){console.error(t.message)}}),n.forEach(function(e){try{var n=null;if(e.stateCalculator&&(n=e.stateCalculator.calculate()),e.shouldDisplay&&!e.shouldDisplay(n))return;t.push(new l(e,n))}catch(r){console.error(r.message)}}),n.forEach(function(e){if(e.stateCalculator&&e.stateCalculator.contextCalculationFinished)try{e.stateCalculator.contextCalculationFinished()}catch(t){console.error(t.message)}})}catch(r){console.error(r.message)}return t}function a(e){if(e.label)return e.label;var t="api-workbench:";return e.category&&e.category.forEach(function(e){t=t+e+": "}),t+=e.name}var s=n(20);t.TARGET_RAML_EDITOR_NODE="TARGET_RAML_EDITOR_NODE",t.TARGET_RAML_TREE_VIEWER_NODE="TARGET_RAML_TREE_VIEWER_NODE",t.addAction=r,t.addSimpleAction=i;var l=function(){function e(e,t){var n=this;this.name=e.name,this.category=e.category,this.label=e.label,this.target=e.target,this.state=t,this.originalAction=e,this.onClick=function(){n.originalAction.onClick(n.state)}}return e}();t.calculateCurrentActions=o,t.getCategorizedActionLabel=a;var u=[]},function(e,t,n){function r(e){if(!e||!e.parent())return!1;var t=e.parent();u.aquireManager()._view.forEachViewer(function(t){return t.remove(e)}),t.remove(e),u.aquireManager().updateText(t.lowLevel())}function i(e){return e&&e.property()?v.isResourcesProperty(e.property())?e:i(e.parent()):null}function o(e){return e&&e.property()?!v.isMethodType(e.definition())&&!v.isTraitType(e.definition())||e.definition().getAdapter(m.RAMLService).isUserDefined()?null:e:null}function a(e,t){return e&&e.property()&&e.definition().isAssignableFrom(t)?e:null}function s(e){u.aquireManager()||u.initEditorTools(!1);var t=[];t.forEach(function(e){return e.__module__="editorTools"}),c.addAction({name:"Add new resource",target:c.TARGET_RAML_EDITOR_NODE,category:["Add new..."],onClick:function(e){return p.newResource(u.aquireManager().getSelectedNode())},stateCalculator:new y,shouldDisplay:function(e){return null!=e}}),c.addAction({name:"Delete current node",target:c.TARGET_RAML_EDITOR_NODE,category:["Code"],onClick:function(e){return r(u.aquireManager().getSelectedNode())},stateCalculator:new g,shouldDisplay:function(e){return null!=e}}),c.addAction({name:"Create new API",target:c.TARGET_RAML_EDITOR_NODE,category:["Add new..."],onClick:function(e){return p.newApi()},stateCalculator:new E,shouldDisplay:function(e){return null!=e}}),c.addSimpleAction("Add new method",["Add new..."],c.TARGET_RAML_EDITOR_NODE,function(){return p.newMethod(i(u.aquireManager().getSelectedNode()))},function(){return u.aquireManager()&&u.aquireManager().getCurrentEditor()&&null!=i(u.aquireManager().getSelectedNode())}),c.addSimpleAction("Create new URI Parameter",["Add new..."],c.TARGET_RAML_EDITOR_NODE,function(){return p.newNode(i(u.aquireManager().getSelectedNode()),"Create new URI Parameter","uriParameters")},function(){return u.aquireManager()&&u.aquireManager().getCurrentEditor()&&null!=i(u.aquireManager().getSelectedNode())}),c.addSimpleAction("Create new Query Parameter",["Add new..."],c.TARGET_RAML_EDITOR_NODE,function(){return p.newNode(o(u.aquireManager().getSelectedNode()),"Create new Query Parameter","queryParameters")},function(){return u.aquireManager()&&u.aquireManager().getCurrentEditor()&&null!=o(u.aquireManager().getSelectedNode())}),c.addSimpleAction("Create new Header",["Add new..."],c.TARGET_RAML_EDITOR_NODE,function(){return p.newNode(o(u.aquireManager().getSelectedNode()),"Create new Header","headers")},function(){return u.aquireManager()&&u.aquireManager().getCurrentEditor()&&null!=o(u.aquireManager().getSelectedNode())}),c.addSimpleAction("Create new Response Header",["Add new..."],c.TARGET_RAML_EDITOR_NODE,function(){return p.newNode(a(u.aquireManager().getSelectedNode(),"Response"),"Create new Header","headers")},function(){return u.aquireManager()&&u.aquireManager().getCurrentEditor()&&null!=a(u.aquireManager().getSelectedNode(),"Response")}),c.addSimpleAction("Create new Response Body",["Add new..."],c.TARGET_RAML_EDITOR_NODE,function(){return p.newNode(a(u.aquireManager().getSelectedNode(),"Response"),"Create new Response Body","body")},function(){return u.aquireManager()&&u.aquireManager().getCurrentEditor()&&null!=a(u.aquireManager().getSelectedNode(),"Response")}),c.addSimpleAction("Create new Property",["Add new..."],c.TARGET_RAML_EDITOR_NODE,function(){return p.newNode(a(u.aquireManager().getSelectedNode(),"ObjectTypeDeclaration"),"Create new Property","properties")},function(){return u.aquireManager()&&u.aquireManager().getCurrentEditor()&&null!=a(u.aquireManager().getSelectedNode(),"ObjectTypeDeclaration")}),c.addSimpleAction("Create new Body",["Add new..."],c.TARGET_RAML_EDITOR_NODE,function(){return p.newNode(o(u.aquireManager().getSelectedNode()),"Create new Body","body")},function(){return u.aquireManager()&&u.aquireManager().getCurrentEditor()&&null!=o(u.aquireManager().getSelectedNode())}),c.addSimpleAction("Create new Response",["Add new..."],c.TARGET_RAML_EDITOR_NODE,function(){return p.newNode(o(u.aquireManager().getSelectedNode()),"Create new Response","responses","200")},function(){return u.aquireManager()&&u.aquireManager().getCurrentEditor()&&null!=o(u.aquireManager().getSelectedNode())})}var l=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},u=n(4),c=n(24),d=n(12),p=n(36),f=n(14),h=n(15),m=h.ds,v=h.universeHelpers,y=function(e){function t(){e.apply(this,arguments)}return l(t,e),t.prototype.calculate=function(){var e=this.getEditor();if(!e)return null;if(".raml"!=f.extname(e.getPath()))return null;var t=this.getGeneralState();if(!t)return null;var n=t.node;return(v.isResourceType(n.definition())||v.isApiType(n.definition()))&&n.lowLevel()?n:null},t}(d.CommonASTStateCalculator),g=function(e){function t(){e.apply(this,arguments)}return l(t,e),t.prototype.calculate=function(){var e=this.getGeneralState();if(!e)return null;var t=e.node;return v.isApiType(t.definition())?null:t},t}(d.CommonASTStateCalculator),E=function(e){function t(){e.apply(this,arguments)}return l(t,e),t.prototype.calculate=function(){var e=this.getGeneralState();if(e)return null;var t=this.getEditor();if(!t)return null;if(".raml"!=f.extname(t.getPath()))return null;var n=t.getText().trim();return""!=n?null:{}},t}(d.CommonASTStateCalculator);t.getResourceParent=i,t.registerQuickCommands=s},function(e,t,n){function r(e){return e?m.isGlobalSchemaType(e.definition()):!1}var i=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},o=n(19),a=n(37),s=n(14),l=o.CompositeDisposable,u=n(15),c=n(38),d=n(39),p=n(4),f=n(36),h=n(17),m=u.universeHelpers,v=function(e){function t(t){void 0===t&&(t=!0),e.call(this),this.allowStructureChanges=t,this.disposables=new l,this.addClass("raml-details"),this.container=o.vc(),this.addChild(this.container),this.ui().appendChild(this.container.ui())}return i(t,e),t.prototype.getTitle=function(){return"Details"},t.prototype.setSchema=function(e){var t=(e.attr("key"),e.attr("value")),n=12;if(null==t){this.container.clear();var r=o.h3("Selected schema has incorrect node so cannot be displayed.");return o.applyStyling(o.TextClasses.WARNING,r),r.setStyle("text-align","center").margin(0,0,24,12),void this.container.addChild(r)}setInterval(function(){12==n++&&t&&(t.setValue(i),d._updatePreview(l,i))},100);var i=t.value();this.container.clear();var a=f.smallEditor(function(r,o){if(t.lowLevel().includePath())try{var a=s.dirname(e.lowLevel().unit().absolutePath()),l=s.resolve(a,t.lowLevel().includePath());t.lowLevel().includeReference()||h.writeFileSync(l,o)}catch(r){console.log(r)}i=o,n=0});f._updateEditor(a,i);var l=d._schemaPreview();d._updatePreview(l,i);var u=new o.TabFolder;u.add("Tree view",o.Icon.GIT_MERGE,l),u.add("Text view",o.Icon.FILE_TEXT,a),this.container.addChild(u),window.detailsnode=e},t.prototype.setResource=function(e){var t=e;window.detailsnode=t,(null==t||null==t.lowLevel())&&this.displayEmpty(),console.log("Displaying details for node "+t.name()),c.updateDetailsPanel(t,this.container,!0)},t.prototype.update=function(){window.detailsnode&&this.setResource(window.detailsnode)},t.prototype.displayEmpty=function(){if(this.container.clear(),!p.aquireManager().ast){this.container.addChild(o.h3("Our API is fabulously empty").margin(8,8,20,8));var e=new o.Button("Create new API",o.ButtonSizes.LARGE,o.ButtonHighlights.SUCCESS,o.Icon.REPO_CLONE,function(){return f.newApi()});e.margin(8,8,20,0),this.container.addChild(e)}},t.prototype.destroy=function(){p.aquireManager()._details=null,this.disposables.dispose()},t.prototype.show=function(e){if(this._node!=e){this._node=e;try{r(e)?this.setSchema(this._node):this.setResource(e)}catch(t){}}},t}(a.Scrollable);t.RamlDetails=v},function(e,t,n){function r(e,t,n,r,i,o){void 0===o&&(o=null);var a=m.treeViewerSection(t,n,e,function(e){return u(e).filter(function(e){return r(e)})},new x(o));return a.viewer.setBasicLabelFunction(function(e){return e?e.name():""}),a.viewer.setKeyProvider({key:function(e){return""+e.lowLevel().start()}}),a.viewer.addSelectionListener(i),a}function i(e){return o(e)?S.Resource:a(e)?S.Trait:s(e)?S.Type:l(e)?S.Schema:S.Unknown}function o(e){return e.definition().key()===E.Universe08.Resource||e.definition().key()===E.Universe10.Resource;
}function a(e){if(e.property()){var t=e.property().nameId();if(C[t])return!1}return!0}function s(e){var t=e.definition().key();return t===E.Universe08.ResourceType||t===E.Universe10.ResourceType||t===E.Universe08.Trait||t===E.Universe10.Trait}function l(e){var t=e.definition().key();return t===E.Universe08.GlobalSchema||t===E.Universe10.GlobalSchema||e.property()&&e.property().nameId()==E.Universe10.LibraryBase.properties.types.name}function u(e){if(null==e)return[];if(e.isAttr())return[];if(e.isUnknown())return[];var t=e.children();return t.filter(function(e){if(e.isAttr())return!1;if(e.isUnknown())return!1;return!0})}function c(e){return e?e&&!e.parent()?e.name():e.name()+" :: "+c(e.parent()):null}function d(e){return null==e?"":d(e.parent())+"/"+e.name()}function p(e,t,n,r){void 0===r&&(r=null);var i=m.treeViewer(function(e){return null==e.parent()?u(e).filter(function(e){return n(e)}):u(e)},new x(r),d);return i.setBasicLabelFunction(function(e){return e.name()}),i.setKeyProvider({key:c}),i.addSelectionListener(t),i.getBinding().set(e),i}function f(e,t,n){void 0===n&&(n=null);var r=p(e,{selectionChanged:t},function(e){return o(e)},n),i=p(e,{selectionChanged:t},l,n),u=p(e,{selectionChanged:t},s,n),c=p(e,{selectionChanged:t},function(e){return a(e)},n),d=new m.TabFolder;return d.add("Resources",m.Icon.SEARCH,r,"raml-icon"),d.add("Schemas & Types",m.Icon.SEARCH,i,"raml-icon"),d.add("Resource Types & Traits",m.Icon.SEARCH,u,"raml-icon"),d.add("Other",m.Icon.SEARCH,c,"raml-icon"),d.setSelectedIndex(0),d.setOnSelected(function(){var e=d.selectedComponent();if(e){var n=e.getSelection();n&&n.elements&&n.elements.length>0&&t(new m.SelectionChangedEvent(e,null,n))}}),d}var h=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},m=n(19),v=n(37),y=m.CompositeDisposable,g=n(15),E=g.universes,b=n(4),T=function(e){function t(){e.call(this),this.disposables=new y,this.fire=!0,this.createTree(null),this.addClass("raml-outline"),this.addChild(this._rs)}return h(t,e),t.prototype.createTree=function(e){var t=this;this._rs=f(e,function(e){b.aquireManager()._details&&e.selection&&e.selection.elements&&1==t.fire&&e.selection.elements.length>0&&e.selection.elements[0]&&b.aquireManager().setSelectedNode(e.selection.elements[0])}),this._viewers=[0,1,2,3].map(function(e){return t._rs.get(e).content})},t.prototype.getTitle=function(){return"Outline"},t.prototype.getNodePType=function(e){for(;e.parent()&&e.parent().parent();)e=e.parent();return i(e)},t.prototype.setSelection=function(e){this._selectedNode=e,this.fire=!1;try{var t=this.getNodePType(e),n=this._viewers[t];null!=n&&(n.setSelection(e),this._rs.setSelectedIndex(t))}finally{this.fire=!0}},t.prototype.setUnit=function(e,t){void 0===t&&(t=!1),this._children=[],this.createTree(e),this.addClass("raml-outline"),this.addChild(this._rs),this.html(this.innerRenderUI())},t.prototype.attach=function(){if(!this._isAttached){var e=$(this);e.html(this._rs.renderUI().outerHTML),this._isAttached=!0}},t.prototype.forEachViewer=function(e){this._viewers.forEach(e)},t.prototype.refresh=function(){var e=this.unit;this.setUnit(null),this.setUnit(e)},t.prototype.destroy=function(){b.aquireManager()._view=null,this.disposables.dispose()},t}(v.Scrollable);t.RamlOutline=T,t.treeSection=r;var S;!function(e){e[e.Resource=0]="Resource",e[e.Schema=1]="Schema",e[e.Type=2]="Type",e[e.Trait=3]="Trait",e[e.Unknown=4]="Unknown"}(S||(S={}));var C={resources:!0,schemas:!0,types:!0,resourceTypes:!0,traits:!0};t.simpleTree=p,t.createTree=f;var x=function(){function e(e){this.opener=e}return e.prototype.render=function(e){try{if(e.isAttr()){var t=e;return m.hc(m.label(t.name()+":"+t.value()),m.a("",function(t){var n=b.aquireManager().getCurrentEditor().getBuffer().positionForCharacterIndex(e.lowLevel().start());b.aquireManager().getCurrentEditor().getBuffer().positionForCharacterIndex(e.lowLevel().end());b.aquireManager().getCurrentEditor().setSelectedBufferRange({start:n,end:n},{})},m.Icon.ARROW_SMALL_LEFT,null,null))}if(e.isUnknown())return m.label("unknown");var n=m.Icon.DASH,r=m.TextClasses.NORMAL,i=e,o=i.definition().key();(o===E.Universe08.Resource||o===E.Universe10.Resource)&&(n=m.Icon.PRIMITIVE_SQUARE,r=m.TextClasses.HIGHLIGHT),(o===E.Universe08.Method||o===E.Universe10.Method)&&(n=m.Icon.PRIMITIVE_DOT,r=m.TextClasses.WARNING),(o===E.Universe08.AbstractSecurityScheme||o===E.Universe10.AbstractSecurityScheme)&&(n=m.Icon.LOCK,r=m.TextClasses.HIGHLIGHT),(o===E.Universe08.AbstractSecurityScheme||o==E.Universe10.AbstractSecurityScheme)&&(n=m.Icon.FILE_SUBMODULE,r=m.TextClasses.NORMAL),o==E.Universe10.AnnotationTypeDeclaration&&(n=m.Icon.TAG,r=m.TextClasses.HIGHLIGHT),(i.definition().isAssignableFrom(E.Universe10.TypeDeclaration.name)||i.definition().isAssignableFrom(E.Universe08.Parameter.name))&&(i.property()&&i.property().nameId()==E.Universe10.ObjectTypeDeclaration.properties.properties.name?(n=m.Icon.FILE_BINARY,r=m.TextClasses.SUCCESS):(n=m.Icon.FILE_BINARY,r=m.TextClasses.SUCCESS));var a=e.name(),s=e;if(o===E.Universe08.DocumentationItem||o===E.Universe10.DocumentationItem){n=m.Icon.BOOK;var l=s.attr("title");l&&(a=l.value())}var u=(m.TextClasses.NORMAL,m.hc(m.label(a,n,r))),c=i.attr("type");if(c){var d=c.value();null==d&&(d="");var p="";p="object"==typeof d?":"+d.valueName():":"+d,u.addChild(m.label(p,m.Icon.NONE,m.TextClasses.WARNING).margin(2,0,0,0))}return i.lowLevel().unit()!=i.root().lowLevel().unit()&&(r=m.TextClasses.SUBTLE,u.addChild(m.label("("+i.lowLevel().unit().path()+")",m.Icon.NONE,r).margin(5,0,0,0))),u.addClass("outline"),u}catch(f){return console.log(f),m.hc(m.label("Illegal node",m.Icon.ARROW_SMALL_LEFT,null,null))}},e}();t.HLRenderer=x},function(e,t,n){function r(e,t){var n=e[0],r=n.rootElement.querySelectorAll(t);return u.$(r[0])}function i(e){return".raml"==e||".yaml"==e}function o(e,t){}function a(e,t){var n=t.clientX,i=t.clientY,o=r([e],".lines")[0].getBoundingClientRect(),a=i-o.top,s=n-o.left;return{top:a,left:s}}function s(e,t){return e.getModel().screenPositionForPixelPosition(a(e,t))}function l(e,t){var n=u.$(atom.views)[0].getView(e),r=a(n,t);r.top-=e.displayBuffer.getScrollTop(),r.left-=e.displayBuffer.getScrollLeft();var i=n.getBoundingClientRect();return r.top+=i.top,r.left+=i.left,r}var u=n(18),c=n(35),d=(c.Subscriber,this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),p=n(18),f=p.$,d=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},h=function(e){function t(t){e.call(this),this.options=t,this.init()}return d(t,e),Object.defineProperty(t.prototype,"$",{get:function(){return this},enumerable:!0,configurable:!0}),t.content=function(){throw new Error("Must override the base View static content member")},t.prototype.init=function(){},t}(p.View);(function(e){function t(t){e.call(this),this.options=t,this.init()}return d(t,e),Object.defineProperty(t.prototype,"$",{get:function(){return this},enumerable:!0,configurable:!0}),t.content=function(){throw new Error("Must override the base View static content member")},t.prototype.init=function(){},t})(p.ScrollView),function(e){function t(t){e.call(this,t),this.rect=t,f(document.body).append(this.$),this.updatePosition()}return d(t,e),t.content=function(){var e=this;return this.div({"class":"atom-typescript-tooltip tooltip"},function(){e.div({"class":"tooltip-inner",outlet:"inner"})})},t.prototype.updateText=function(e){this.inner.html(e),this.updatePosition(),this.$.fadeTo(300,1)},t.prototype.updatePosition=function(){var e=10,t=this.rect.right,n=this.rect.bottom,r=void 0;t+this.$[0].offsetWidth>=f(document.body).width()&&(t=f(document.body).width()-this.$[0].offsetWidth-e),0>t&&(this.$.css({"white-space":"pre-wrap"}),t=e,r=e),n+this.$[0].offsetHeight>=f(document.body).height()&&(n=this.rect.top-this.$[0].offsetHeight),this.$.css({left:t,top:n})},t}(h);t.getFromShadowDom=r,t.isAllowedExtension=i,t.attach=o,t.screenPositionFromMouseEvent=s,t.screenPositionFromMouse=l},function(e,t,n){var r=n(15),i=n(19),o=n(4),a=n(33),s=n(8),l=r.universes,u=function(){function e(e,t,n){this.node=e,this.name=t,this._resourceType=n}return e.prototype.getActiveEditor=function(){var e=atom.workspace.getActiveTextEditor();return e?e:o.aquireManager()?o.aquireManager().getCurrentEditor():null},e.prototype.show=function(){var e=this,t=null,n=this.node,r=i.section("Move resource ",i.Icon.GIST_NEW,!1,!1),o=i.label("please select destination resource",i.Icon.BUG,i.TextClasses.ERROR,i.HighLightClasses.NONE);r.addChild(i.vc(o)),r.addChild(i.label("Please select destination resource"));var u=i.hc();r.setPercentWidth(100),u.setPercentWidth(100);var c=function(t){if(e._resourceType){if(t.definition().key()!=l.Universe08.Resource&&t.definition().key()!=l.Universe10.Resource)return!1;if(t==n||t==n.parent())return!1}return!0},d=(n.definition().universe(),a.createSmallSelectionPanel(n.root(),c,"400px","100%"));u.addChild(d),r.addChild(u),d.addSelectionListener({selectionChanged:function(e){o.setDisplay(e.selection.isEmpty()),f.setDisabled(e.selection.isEmpty())}});var p=i.hc().setPercentWidth(100).setStyle("display","flex");p.addChild(i.label("",null,null,null).setStyle("flex","1")),p.addChild(i.button("Cancel",i.ButtonSizes.NORMAL,i.ButtonHighlights.NO_HIGHLIGHT,i.Icon.NONE,function(e){t.destroy()}).margin(10,10));var f=i.button("Move",i.ButtonSizes.NORMAL,i.ButtonHighlights.SUCCESS,i.Icon.NONE,function(r){var i=d.getSelection().elements[0];n.parent().remove(n),i.add(n);var o=n.lowLevel().unit().contents();e.getActiveEditor().setText(s.cleanEmptyLines(o)),t.destroy()});f.setDisabled(!0),p.addChild(f),r.addChild(p);var h=r.renderUI();t=atom.workspace.addModalPanel({item:h}),h.focus()},e}();t.MoveElementsDialog=u},function(e,t,n){function r(e){var t=o.aquireManager();if(o.aquireManager()&&t.getCurrentEditor()==e)return t.ast;var n=e.getPath(),r=s.createProject(i.dirname(n)),a=r.unit(i.basename(n)),l=e.getBuffer().getText();if(!a)return null;a.updateContent(l);var u=a.highLevel();return u}var i=n(14),o=n(4),a=n(15),s=a.project;t.ast=r},function(e,t,n){var r=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},i=n(17),o=n(1),a=n(40),s=n(18),l=n(45),u=n(41),c=n(14),d=n(42),p=n(46),f=n(15),h=n(47),m=n(48),v=o.CompositeDisposable,y=function(e){function t(t){var n=this;e.call(this),this.loaded=!1,this.isAttached=!1,this.isParsing=!1,this.disposables=new v,this.pageState={},this.paths={},this.editors={},this.resolver=new E(function(e){return n.readFileSync(e)}),this.state=u({view:{},parameters:{},headers:{},uriParameters:{},baseUriParameters:{},queryParameters:{},bodies:{}},t.state),this.filename=t.filename,this.editorId=t.editorId,t.raml&&(this.raml=f.expander.expandTraitsAndResourceTypes(t.raml),this.project=t.raml.highLevel().lowLevel().unit().project().cloneWithResolver(this.resolver),this.loaded=!0)}return r(t,e),t.content=function(){return this.div({"class":"raml-console pane-item",tabindex:-1})},t.getUriForFilename=function(e){return"raml-console://file/"+e},t.getUriForEditor=function(e){return"raml-console://editor/"+e.id},t.prototype.attached=function(){var e=this;this.isAttached||(this.render(),this.isAttached=!0,this.editorId?this.resolveEditor(this.editorId):this.filename&&this.resolveFilename(this.filename),this.disposables.add(atom.workspace.observeTextEditors(function(t){var n=t.getPath();e.paths[n]&&(e.watchEditor(t),e.stopWatchingPath(n))})))},t.prototype.resolveEditor=function(e){var t=this,n=function(){if(t.editor=p.getEditorById(e),t.editor)return t.trigger("title-changed"),void t.loadRAML();var n=t.parents(".pane").view();return n&&n.destroyItem(t)};atom.workspace?n():this.disposables.add(atom.packages.onDidActivateInitialPackages(n))},t.prototype.resolveFilename=function(e){var t=this,n=function(){t.file=new l.File(e),t.trigger("title-changed"),t.loadRAML()};atom.workspace?n():this.disposables.add(atom.packages.onDidActivateInitialPackages(n))},t.prototype.readFileSync=function(e){var t,n=p.getEditorByPath(e);if(n)t=n.getText(),this.watchEditor(n);else{try{t=i.readFileSync(e,"utf8")}catch(r){if("ENOENT"===r.code)return void this.watchForFile(e);throw r}this.watchFile(e)}return t},t.prototype.watchEditor=function(e){var t=this,n=e.getPath();if(!this.editors[n]){var r=new v;this.editors[n]=r,r.add(e.onDidStopChanging(function(){t.updateUnit(n,e.getText())}));var i=function(){t.stopWatchingEditor(n),t.updateUnit(n,t.readFileSync(n))};r.add(e.onDidDestroy(i)),r.add(e.onDidChangePath(i))}},t.prototype.getActiveEditor=function(){return atom.workspace.getActiveTextEditor()},t.prototype.stopWatchingPath=function(e){var t=this.paths[e];t&&(t.close(),delete this.paths[e])},t.prototype.stopWatchingEditor=function(e){var t=this.editors[e];t&&(t.dispose(),delete this.editors[e])},t.prototype.watchFile=function(e){var t=this;if(!this.paths[e]){var n=l.watch(e,function(n){"change"===n?t.updateUnit(e,t.readFileSync(e)):(t.stopWatchingPath(e),t.deleteUnit(e))});this.paths[e]=n}},t.prototype.watchForFile=function(e){var t=this;this.watchForPath(e,function(){t.updateUnit(e,t.readFileSync(e))})},t.prototype.watchForPath=function(e,t){var n=this,r=c.dirname(e),i=function(){var o=l.watch(r,function(o,a){"change"===o?a===e&&(n.stopWatchingPath(r),t()):(n.watchForPath(r,i),n.stopWatchingPath(r))});n.paths[r]=o};try{i()}catch(o){this.watchForPath(r,i)}},t.prototype.stopWatching=function(){var e=this;Object.keys(this.paths).forEach(function(t){e.stopWatchingPath(t)}),Object.keys(this.editors).forEach(function(t){e.stopWatchingEditor(t)})},t.prototype.navigate=function(e){var t="string"==typeof e?{id:e}:u(this.state.view,e);this.pageState={},this.setState({view:t},function(){document.getElementById("raml-console-view").scrollTop=0}),this.abortRequest()},t.prototype.render=function(e){var t=this,n={state:this.state,raml:this.raml,loaded:this.loaded,errors:this.errors,pageState:this.pageState,setParameter:function(e,n,r){return t.setParameter(e,n,r)},setState:function(e){return t.setState(e)},navigate:function(e){return t.navigate(e)},execRequest:function(){return t.execRequest()}};a.render(a.createElement(m.Console,n),this.element,e)},t.prototype.execRequest=function(){var e=this;this.abortRequest();var t=this.raml.baseUri(),n=this.raml.highLevel().findById(this.state.view.id).wrapperNode();if(this.setPageState({requestError:void 0}),null==t)return void this.setPageState({requestError:"Unable to execute request, `baseUri` is missing"});var r=this.state.securityScheme?this.raml.securitySchemes().filter(function(t){return t.name()===e.state.securityScheme})[0]:void 0,i=this.toDefaultParameters(this.raml.allBaseUriParameters()),o=this.toDefaultParameters(n.parent().allUriParameters()),a=n.headers(),s=n.queryParameters(),l=h.template(t.value()||"",this.state.baseUriParameters,i).replace(/\/$/,""),c=h.template(n.parent().completeRelativeUri(),this.state.uriParameters,o);r&&(s=s.concat(r.describedBy().queryParameters()),a=a.concat(r.describedBy().headers())),this.request=d.request({url:l+c,method:n.method(),headers:u({"User-Agent":"API Workbench: Console"},this.usedParameters(this.state.headers,a)),query:this.usedParameters(this.state.queryParameters,s),body:this.state.bodies[this.state.body],use:[d.plugins.headers(),d.plugins.unzip(),d.plugins.concatStream("string")]}),this.request.progress(function(){e.setPageState({requestProgress:e.request.completed})}),this.request.then(function(t){e.setPageState({requestResponse:t.toJSON(),requestProgress:void 0}),e.request=void 0},function(t){e.setPageState({requestError:t.message,requestProgress:void 0}),e.request=void 0})},t.prototype.toDefaultParameters=function(e){var t={};return e.forEach(function(e){e["default"]()&&(t[e.name()]=e["default"]())}),t},t.prototype.usedParameters=function(e,t){var n={};return t.forEach(function(t){e[t.name()]&&(n[t.name()]=e[t.name()])}),n},t.prototype.abortRequest=function(){this.request&&(this.request.abort(),this.request=void 0)},t.prototype.updateRAML=function(){this.isParsing=!0;try{var e=this.getUnit(this.getFilename()),t=e.ast().errors();this.errors=t,t.length||(this.raml=f.expander.expandTraitsAndResourceTypes(e.highLevel().asElement().wrapperNode()))}catch(n){this.raml=void 0,this.errors=[n]}finally{this.loaded=!0,this.isParsing=!1,this.render(),this.trigger("title-changed")}},t.prototype.loadRAML=function(){this.stopWatching(),this.project=f.project.createProject(c.dirname(this.getFilename()),this.resolver),this.updateRAML()},t.prototype.serialize=function(){return{deserializer:"RAMLConsoleView",filename:this.getFilename(),state:this.state}},t.prototype.getFilename=function(){return this.file?this.file.getPath():this.editor?this.editor.getPath():void 0},t.prototype.getTitle=function(){var e="RAML";return this.raml&&null!=this.raml.title()?e=this.raml.title():this.file?e=c.basename(this.getFilename()):this.editor&&(e=this.editor.getTitle()),e+" Console"},t.prototype.destroy=function(){this.stopWatching(),this.disposables.dispose(),a.unmountComponentAtNode(this.element)},t.prototype.setState=function(e,t){this.state=u(this.state,e),this.render(t)},t.prototype.setPageState=function(e,t){this.pageState=u(this.pageState,e),this.render(t)},t.prototype.setParameter=function(e,t,n){var r={},i=u(this.state[e]);n?i[t]=n:delete i[t],r[e]=i,this.setState(r)},t.prototype.getURI=function(){return t.getUriForFilename(this.getFilename())},t.prototype.getUnit=function(e){return this.project.unit(e,!0)},t.prototype.deleteUnit=function(e){this.project.deleteUnit(e),this.updateRAML()},t.prototype.updateUnit=function(e,t){this.getUnit(e).updateContent(this.readFileSync(e)),this.updateRAML()},t}(s.ScrollView);t.RAMLConsoleView=y;var g=function(){function e(){}return e.prototype.content=function(e){if(!i.existsSync(e))return null;try{return i.readFileSync(e).toString()}catch(t){return null}},e.prototype.list=function(e){return i.readdirSync(e)},e.prototype.contentAsync=function(e){return new Promise(function(t,n){i.readFile(e,function(e,r){if(null!=e)return n(e);var i=r.toString();t(i)})})},e.prototype.listAsync=function(e){return new Promise(function(t,n){i.readdir(e,function(e,r){return null!=e?t(e):void n(r)})})},e}();t.FSResolverImpl=g;var E=function(e){function t(t){e.call(this),this.readFileSync=t}return r(t,e),t.prototype.content=function(e){return this.readFileSync(e)},t}(g)},function(e,t,n){function r(e){var t={};if(1==e.nodeType){if(e.attributes.length>0)for(var n=0;n<e.attributes.length;n++){var i=e.attributes.item(n);t["@"+i.nodeName]=i.nodeValue}}else 3==e.nodeType&&(t=e.nodeValue);if(e.hasChildNodes())for(var o=0;o<e.childNodes.length;o++){var a=e.childNodes.item(o),s=a.nodeName;if(void 0!=s)if("undefined"==typeof t[s])t[s]=r(a);else{if("undefined"==typeof t[s].push){var l=t[s];t[s]=[],t[s].push(l)}t[s].push(r(a))}}return t}function i(e){for(var t in e)if("object"==typeof e[t]){for(var n in e[t])if("#text"==n){var r=e[t]["#text"];"string"!=typeof r&&(r=r.join("")),r=r.trim(),0==r.length&&delete e[t]["#text"]}i(e[t])}return e}function o(e){for(var t in e)if("object"==typeof e[t]){var n=Object.keys(e[t]);1==n.length&&"#text"==n[0]&&(e[t]=e[t]["#text"]),o(e[t])}return e}function a(e){var t=new s.DOMParser;if(!e||0==e.trim().indexOf("<<"))return null;var n=t.parseFromString(e);return o(i(r(n)))}var s=n(43);e.exports=a},function(e,t,n){function r(e,t,n,r,o){void 0===o&&(o="left");var a=i(e,t);return a.setTagName("atom-panel"),a.setStyle("width",r),a.setStyle("border","solid"),a.setStyle("border-width","1px"),a.setStyle("height",n),a.setStyle("overflow","scroll"),o&&a.setStyle("float",o),a.margin(3,3,3,3),a}function i(e,t){var n=m.treeViewer(function(e){return e.elements().filter(function(e){return t(e)})},new v.HLRenderer(function(e){}));return n.setInput(e),n}function o(e){var t=[];return e.definition()instanceof y.UserDefinedClass?(a(e.definition(),t),t):t}function a(e,t){if(e instanceof y.UserDefinedClass){t.push(e);var n=e.superTypes();n&&n.forEach(function(e){return a(e,t)})}}function s(e){return null==e?!1:x.stringStartsWith(e,"http://")||x.stringStartsWith(e,"https://")}var l=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},u=n(17),c=n(14),d=n(15),p=d.stubs,f=n(20),h=n(6),m=n(19),v=n(27),y=d.ds,g=n(8),E=n(44),b=d.universeHelpers,T=d.universes,S=d.ds,C=d.search,x=n(49),w=function(){function e(e,t,n){this.node=e,this.name=t,this._resourceType=n,this.filters=new A}return e.prototype.getActiveEditor=function(){return g.getActiveEditor()},e.prototype.show=function(){var e=this,t=null,n=this.node,i=m.section("Extract "+this.name+":",m.Icon.GIST_NEW,!1,!1);i.addChild(m.label("Extracted element name:").pad(5,0));var o=m.label("Please type valid name for "+this.name,m.Icon.BUG,m.TextClasses.ERROR,m.HighLightClasses.NONE);i.addChild(m.vc(o));var a=m.texfField("","",function(e){if(S){var t=0==a.getBinding().get().trim().length;S.setDisabled(t),o.setDisplay(t),u.attr("name").setValue(a.getBinding().get())}});i.addChild(a),i.addChild(m.label("Move elements which should be extracted to the right panel"));var s=m.hc();i.setPercentWidth(100),s.setPercentWidth(100);var l=function(t){return e._resourceType&&b.isResourceType(t.definition())?!1:f.find(e.filters.removals,function(e){return t==e})?!1:!0},u=this.createNodeStub(n),c=r(n,l,"400px","47%"),d=r(u,function(e){return!0},"400px","47%","right"),h=m.button(">",m.ButtonSizes.NORMAL,m.ButtonHighlights.NO_HIGHLIGHT,m.Icon.NONE,function(t){var r=c.getSelection().elements;e.moveRight(r,u,n,c,d)}),v=m.button("<",m.ButtonSizes.NORMAL,m.ButtonHighlights.NO_HIGHLIGHT,m.Icon.NONE,function(t){var r=d.getSelection().elements;e.moveLeft(r,u,n,c,d)}),y=m.button(">>",m.ButtonSizes.NORMAL,m.ButtonHighlights.NO_HIGHLIGHT,m.Icon.NONE,function(t){var r=n.elements().filter(function(e){return l(e)});e.moveRight(r,u,n,c,d)}),E=m.button("<<",m.ButtonSizes.NORMAL,m.ButtonHighlights.NO_HIGHLIGHT,m.Icon.NONE,function(t){var r=u.elements();e.moveLeft(r,u,n,c,d)});s.addChild(m.vc(h,v,y,E)),s.addChild(c),s.addChild(d),i.addChild(s),c.addSelectionListener({selectionChanged:function(e){var t=e.selection.elements,r=void 0!=f.find(t,function(e){return e.parent()!=n});h.setDisabled(r||0==t.length)}}),d.addSelectionListener({selectionChanged:function(t){var n=t.selection.elements,r=void 0!=f.find(n,function(t){var n=f.find(e.filters.removals,function(e){return t.id()==e.id()});return void 0==n});v.setDisabled(r||0==n.length)}}),v.setDisabled(!0),h.setDisabled(!0);var T=m.hc().setPercentWidth(100).setStyle("display","flex");T.addChild(m.label("",null,null,null).setStyle("flex","1")),T.addChild(m.button("Cancel",m.ButtonSizes.NORMAL,m.ButtonHighlights.NO_HIGHLIGHT,m.Icon.NONE,function(e){t.destroy()}).margin(10,10));var S=m.button("Extract",m.ButtonSizes.NORMAL,m.ButtonHighlights.SUCCESS,m.Icon.NONE,function(r){if(e.filters.removals.forEach(function(e){return n.remove(e)}),e._resourceType){var i=n.attr("type");i||n.add(p.createAttr(n.definition().property("type"),u.name()))}else{var i=n.attr("is");i||n.add(p.createAttr(n.definition().property("is"),u.name()))}var o=e.createNodeStub(n);u.elements().forEach(function(e){return o.add(e)}),o.attr("name").setValue(a.getBinding().get()),n.root().add(o);var s=n.lowLevel().unit().contents();e.getActiveEditor().setText(g.cleanEmptyLines(s)),t.destroy()});S.setDisabled(!0),T.addChild(S),i.addChild(T);var C=i.renderUI();t=atom.workspace.addModalPanel({item:C}),C.focus()},e.prototype.createNodeStub=function(e){var t=e.definition().universe(),n=e.root().definition().property("resourceTypes"),r=e.root().definition().property("traits"),i=p.createStubNode(t.type("ResourceType"),n);return this._resourceType||(i=p.createStubNode(t.type("Trait"),r)),i},e.prototype.moveLeft=function(e,t,n,r,i){var o=this;e.length>0&&(e.forEach(function(e){return o.filters.removals=o.filters.removals.filter(function(t){return t.id()!=e.id()})}),e.forEach(function(e){t.remove(e);var n=0;n++})),r.setInput(n),i.setInput(t)},e.prototype.moveRight=function(e,t,n,r,i){e.length>0&&(this.filters.removals=this.filters.removals.concat(e)),e.forEach(function(e){return t.add(e.copy())}),r.setInput(n),i.setInput(t)},e}();t.ExtractTypesAndTraitsDialog=w;var A=function(){function e(){this.removals=[]}return e}();t.createSmallSelectionPanel=r,t.createVIewer=i;var I=function(){function e(e,t){this.parentNode=e,this.name=t,this.movedNodes=[]}return e.prototype.checkNode=function(e){return{visitChildren:!0,display:!0,canBeMoved:!0}},e.prototype.validate=function(){return null},e.prototype.createHeader=function(e){},e.prototype.performOk=function(e,t){},e.prototype.show=function(){if(console.log("Original file tree:"),this.getParentNode()&&console.log(this.getParentNode().printDetails()),this.getParentNode()){var e=m.section(this.name+":",m.Icon.GIST_NEW,!1,!1);this.stubRoot=this.createStub(this.getParentNode()),this.createValidationIndicator(e),this.createHeader(e),this.createPanels(e),this.createButtonBar(e),e.setPercentWidth(100);var t=e.renderUI();this.rootAtomPanel=atom.workspace.addModalPanel({item:t}),t.focus(),this.performValidation()}},e.prototype.performValidation=function(){var e=this.validate();this.okButton&&(e?this.okButton.setDisabled(!0):this.okButton.setDisabled(!1)),this.errorLabel&&(e?(this.errorLabel.setDisplay(!0),this.errorLabel.setText(e)):(this.errorLabel.setDisplay(!1),this.errorLabel.setText("")))},e.prototype.createValidationIndicator=function(e){this.errorLabel=m.label("",m.Icon.BUG,m.TextClasses.ERROR,m.HighLightClasses.NONE),e.addChild(m.vc(this.errorLabel))},e.prototype.getNodeId=function(e){if(e.parent()){var t=this.getNodeId(e.parent());t+="."+e.name();var n=e.parent().asElement().directChildren().filter(function(t){return t.name()==e.name()});if(n.length>1){var r=n.indexOf(e);t+="["+r+"]"}return t}return e.name()?e.definition&&e.definition()&&b.isApiType(e.definition())?"":"."+e.name():""},e.prototype.nodesEqualById=function(e,t){return this.getNodeId(e)==this.getNodeId(t)},e.prototype.createMovedNodesTree=function(){var e=this;this.stubRoot=this.createStub(this.getParentNode()),this.movedNodes.forEach(function(t){for(var n=[],r=t.parent();r&&r!=e.getParentNode();)n.push(r),r=r.parent();n.reverse();var i=e.stubRoot;n.forEach(function(t){var n=f.find(i.children(),function(n){return e.nodesEqualById(n,t)});n||(n=e.createStub(t),i.add(n),n.setParent(i)),i=n});var o=e.createMovedNode(t);i.add(o),o.setParent(i)}),console.log("New tree moved:"),console.log(this.stubRoot.printDetails())},e.prototype.createMovedNode=function(e){return e.copy()},e.prototype.saveUnit=function(e){h.saveUnit(e)},e.prototype.createStub=function(e){var t=p.createStubNode(e.definition(),e.property(),e.lowLevel().key());return t},e.prototype.createStubRoot=function(e,t){var n=p.createMap(),r=p.createASTNodeImpl(n,null,t,null);return r.children(),r},e.prototype.createPanels=function(e){var t=this,n=m.hc();e.addChild(m.label("Move elements which should be extracted to the right panel"));var i=function(e){return t.checkNode(e).display?f.find(t.movedNodes,function(t){return t==e})?!1:!0:!1};this.leftPanel=r(this.getParentNode(),i,"400px","47%");var o=function(e){return t.checkNode(e).display?!0:!1};this.rightPanel=r(this.stubRoot,o,"400px","47%","right");var a=m.button(">",m.ButtonSizes.NORMAL,m.ButtonHighlights.NO_HIGHLIGHT,m.Icon.NONE,function(e){var n=t.leftPanel.getSelection().elements;t.moveRight(n)}),s=m.button("<",m.ButtonSizes.NORMAL,m.ButtonHighlights.NO_HIGHLIGHT,m.Icon.NONE,function(e){var n=t.rightPanel.getSelection().elements;t.moveLeft(n)});n.addChild(m.vc(a,s)),n.addChild(this.leftPanel),n.addChild(this.rightPanel),e.addChild(n),this.leftPanel.addSelectionListener({selectionChanged:function(e){var t=e.selection.elements;a.setDisabled(0==t.length)}}),this.rightPanel.addSelectionListener({selectionChanged:function(e){var t=e.selection.elements;s.setDisabled(0==t.length)}}),s.setDisabled(!0),a.setDisabled(!0),n.setPercentWidth(100)},e.prototype.createButtonBar=function(e){var t=this,n=m.hc().setPercentWidth(100).setStyle("display","flex");n.addChild(m.label("",null,null,null).setStyle("flex","1")),n.addChild(m.button("Cancel",m.ButtonSizes.NORMAL,m.ButtonHighlights.NO_HIGHLIGHT,m.Icon.NONE,function(e){t.rootAtomPanel.destroy()}).margin(10,10)),this.okButton=m.button("Extract",m.ButtonSizes.NORMAL,m.ButtonHighlights.SUCCESS,m.Icon.NONE,function(e){t.performOk(t.movedNodes,t.stubRoot),t.rootAtomPanel.destroy()}),this.okButton.setDisabled(!0),n.addChild(this.okButton),e.addChild(n)},e.prototype.getParentNode=function(){return this.parentNode},e.prototype.isParentOf=function(e,t){for(var n=t.parent();null!=n;){if(n==e||this.nodesEqualById(n,e))return!0;n=n.parent()}return!1},e.prototype.mergeTrees=function(e,t,n){var r=this;void 0===n&&(n=!1),e.directChildren()&&e.directChildren().forEach(function(e){r.mergeNode(e,t)})},e.prototype.getActiveEditor=function(){return g.getActiveEditor()},e.prototype.mergeNode=function(e,t,n){var r=this;if(void 0===n&&(n=!1),n||e.isElement()){var i=t.directChildren();if(!i)return t.add(e),void e.setParent(t);var o=f.find(i,function(t){return r.nodesEqualById(t,e)});return o?void(e.directChildren()&&e.directChildren().forEach(function(e){return r.mergeNode(e,o)})):(t.add(e),void e.setParent(t))}},e.prototype.moveLeft=function(e){var t=this;e.length>0&&(this.movedNodes=this.movedNodes.filter(function(n){return f.find(e,function(e){return t.nodesEqualById(e,n)||t.isParentOf(e,n)})?!1:!0}),this.createMovedNodesTree()),this.leftPanel.setInput(this.getParentNode()),this.rightPanel.setInput(this.stubRoot),this.performValidation()},e.prototype.moveRight=function(e){var t=this;e.length>0&&(this.movedNodes=this.movedNodes.filter(function(n){return f.find(e,function(e){return t.isParentOf(e,n)})?!1:!0}),e.forEach(function(e){return t.movedNodes.push(e)}),this.createMovedNodesTree()),this.leftPanel.setInput(this.getParentNode()),this.rightPanel.setInput(this.stubRoot),this.performValidation()},e}();t.AbstractlMoveElementsDialog=I;var N=function(e){function t(t,n){e.call(this,t,n)}return l(t,e),t.prototype.checkNode=function(e){var t=null;e.property()&&e.property().range()&&(t=e.property().range());var n=e.property(),r=b.isTypesProperty(n),i=b.isTypeDeclarationType(t)&&r;return t&&(b.isResourceTypeType(t)||b.isTraitType(t)||b.isGlobalSchemaType(t)||b.isSecuritySchemaType(t)||i)?{visitChildren:!1,display:!0,canBeMoved:!0}:{visitChildren:!1,display:!1,canBeMoved:!1}},t.prototype.createStub=function(t){if(t.definition().key()==T.Universe10.Api||t.definition().key()==T.Universe08.Api){var n=d.ds.getUniverse("RAML10"),r=n.type(T.Universe10.Library.name),i=this.createStubRoot(t,r);return i}return e.prototype.createStub.call(this,t)},t.prototype.validate=function(){if(!this.libraryPath)return null;if(!this.stubRoot)return null;if(0==this.movedNodes.length)return"Add elements to move";if(!this.libraryNamespace)return null;if(!this.getLibraryQualifier())return"Enter library namespace";if(0==this.getLibraryQualifier().trim().length)return"Enter library namespace";var e=this.libraryPath.getBinding().get(),t=e.trim();if(0==t.length)return"Empty library path";if(".raml"!=c.extname(t))return"Library path should be a RAML file";var n=c.resolve(c.dirname(this.getActiveEditor().getPath()),c.dirname(t));if(!u.existsSync(n))return"Library path directory does not exist";var r=u.statSync(n);if(!r.isDirectory())return"Library path parent is not a directory";var i=c.resolve(c.dirname(this.getActiveEditor().getPath()),t);return u.existsSync(i)?"Destination library already exists":null;
},t.prototype.createHeader=function(e){var t=this;e.addChild(m.label("Library namespace:").pad(5,0)),this.libraryNamespace=m.texfField("",this.getDefaultLibraryNamespace(),function(e){t.performValidation()}),e.addChild(this.libraryNamespace),e.addChild(m.label("Library path:").pad(5,0)),this.libraryPath=m.texfField("",this.generateDefaultLibraryPath(),function(e){t.performValidation()}),e.addChild(this.libraryPath)},t.prototype.performOk=function(e,t){var n=this,r=this.createProject(),i=this.createLibraryUnit(r),o=C.globalDeclarations(this.getParentNode()).filter(function(e){return e&&e.definition&&e.definition().nameId()===T.Universe10.Library.name}),a=this.getParentNode().definition().universe(),l=a.type(T.Universe10.Library.name);e.forEach(function(e){var r=o.filter(function(t){return f.find(t.findReferences(),function(t){return n.isParentOf(e,t)})?!0:!1});r.forEach(function(e){var r=e.lowLevel()._node.value&&e.lowLevel()._node.value.value;if(r){var o;if(s(r)||c.isAbsolute(r))o=r;else var a=c.dirname(n.getParentNode().lowLevel().unit().absolutePath()),o=c.relative(c.dirname(i.absolutePath()),c.resolve(a,r));var u=p.createMapping(e.lowLevel().key(),"!include "+o),d=p.createASTNodeImpl(u,null,l,null);t.wrapperNode().addToProp(d.wrapperNode(),T.Universe10.LibraryBase.properties.uses.name)}})}),this.updateLibraryUnit(i,t),this.saveUnit(i);var u=[];u.push(this.getParentNode().lowLevel().unit());var d=this.getLibraryQualifier();e.forEach(function(t){var r=t.findReferences();r&&r.forEach(function(r){if(r.isAttr()&&!f.find(e,function(e){return n.isParentOf(e,r)})){var i=r,o=i.value();if("string"==typeof o){var a=o,s=t.name(),l=d+"."+s,c=a.replace(s,l);i.setValue(c);var p=i.lowLevel().unit();f.find(u,function(e){return e==p})&&u.push(p)}}}),t.parent().remove(t)}),u.forEach(function(e){return n.saveUnit(e)}),this.addUsesNode(d,this.getLibraryPath())},t.prototype.generateDefaultLibraryPath=function(){var e=this.getParentNode(),t=e.lowLevel().unit().absolutePath(),n=c.dirname(t);return c.resolve(n,"NewLibrary.raml")},t.prototype.getLibraryName=function(){return this.libraryNamespace.getBinding().get()},t.prototype.getLibraryQualifier=function(){return this.libraryNamespace.getBinding().get()},t.prototype.getDefaultLibraryNamespace=function(){return"NewLibrary"},t.prototype.getLibraryPath=function(){var e=this.libraryPath.getBinding().get(),t=e.trim();if(0==t.length)return null;if(".raml"!=c.extname(t))return null;var n=c.resolve(c.dirname(this.getActiveEditor().getPath()),c.dirname(t));if(!u.existsSync(n))return null;var r=u.statSync(n);return r.isDirectory()?c.resolve(c.dirname(this.getActiveEditor().getPath()),t):null},t.prototype.createProject=function(){var e=this.getLibraryPath();return d.project.createProject(c.dirname(e))},t.prototype.createLibraryUnit=function(e){var t=this.getLibraryPath();return u.writeFileSync(t,"#%RAML 1.0 Library\n"),e.unit(c.basename(t))},t.prototype.updateLibraryUnit=function(e,t){var n=e.highLevel();t.children().forEach(function(e){e.getKind()&&n.add(e)})},t.prototype.addUsesNode=function(e,t){var n=c.relative(c.dirname(this.getParentNode().lowLevel().unit().absolutePath()),t),r=f.find(this.getParentNode().children(),function(e){var t=e;return t.definition&&b.isLibraryType(t.definition())&&t.property()&&b.isUsesProperty(t.property())}),i=null,o=!1;if(r)for(var a=r.lowLevel();null!=a;){if(a.kind()==E.Kind.MAPPING&&a.key()==T.Universe10.LibraryBase.properties.uses.name){i=a;break}a.kind()==E.Kind.SEQ&&(o=!0),a=a.parent()}if(i){var s=i.keyEnd()+1,l="\n  "+(o?"- ":"")+e+": !include "+n;this.insertTextToActiveEditor(s,l)}else{var u=f.find(this.getParentNode().children(),function(e){var t=e;return t.definition&&b.isStringTypeType(t.definition())&&t.property()&&b.isTitleProperty(t.property())});if(u){var s=u.lowLevel().valueEnd(),l="\nuses:\n  "+e+": !include "+n;this.insertTextToActiveEditor(s,l)}else{var s=this.getParentNode().lowLevel().end(),l="\nuses:\n  "+e+": !include "+n;this.insertTextToActiveEditor(s,l)}}},t.prototype.insertTextToActiveEditor=function(e,t){var n=this.getParentNode().lowLevel().unit().contents(),r=n.substring(e),i=n.substring(0,e),o=i+t+r;this.getActiveEditor().setText(o)},t.prototype.createUsesNode=function(e,t){var n=this.getParentNode().definition().universe(),r=this.getParentNode().root().definition().property("uses"),i=p.createStubNode(n.type("Library"),r,e);return i},t}(I);t.ExtractLibraryDialog=N;var P=function(e){function t(t,n){e.call(this,t,n)}return l(t,e),t.prototype.createStub=function(t){if(t.definition().key()==T.Universe10.Api||t.definition().key()==T.Universe08.Api){var n=d.ds.getUniverse("RAML10"),r=n.type(T.Universe10.Overlay.name),i=this.createStubRoot(t,r);return i}return e.prototype.createStub.call(this,t)},t.prototype.checkNode=function(e){return{visitChildren:!0,display:!0,canBeMoved:!0}},t.prototype.validate=function(){if(!this.overlayPath)return null;if(!this.stubRoot)return null;if(0==this.movedNodes.length)return"Add elements to move";var e=this.overlayPath.getBinding().get(),t=e.trim();if(0==t.length)return"Empty overlay path";if(".raml"!=c.extname(t))return"Overlay path should be a RAML file";var n=c.resolve(c.dirname(this.getActiveEditor().getPath()),c.dirname(t));if(!u.existsSync(n))return"Overlay path directory does not exist";var r=u.statSync(n);if(!r.isDirectory())return"Overlay path parent is not a directory";c.resolve(c.dirname(this.getActiveEditor().getPath()),t);return null},t.prototype.createHeader=function(e){var t=this;e.addChild(m.label("Overlay path:").pad(5,0)),this.overlayPath=m.texfField("",this.generateDefaultOverlayPath(),function(e){t.performValidation()}),e.addChild(this.overlayPath)},t.prototype.performOk=function(e,t){var n=this.createProject(),r=this.createOverlayUnit(n);this.updateOverlayUnit(r,t);var i=this.getOverlayPath(),o=this.getParentNode().lowLevel().unit().absolutePath(),a=c.relative(c.dirname(i),o);this.addMasterReference(r,a),this.saveUnit(r)},t.prototype.generateDefaultOverlayPath=function(){var e=this.getParentNode(),t=e.lowLevel().unit().absolutePath(),n=c.dirname(t);return c.resolve(n,"NewOverlay.raml")},t.prototype.createProject=function(){var e=this.getOverlayPath();return d.project.createProject(c.dirname(e))},t.prototype.createOverlayUnit=function(e){var t=this.getOverlayPath();return u.writeFileSync(t,"#%RAML 1.0 Overlay\ntitle: Extension\n"),e.unit(c.basename(t))},t.prototype.updateOverlayUnit=function(e,t){var n=e.highLevel();t.children().forEach(function(e){e.getKind()&&n.add(e)})},t.prototype.getOverlayPath=function(){var e=this.overlayPath.getBinding().get(),t=e.trim();if(0==t.length)return null;if(".raml"!=c.extname(t))return null;var n=c.resolve(c.dirname(this.getActiveEditor().getPath()),c.dirname(t));if(!u.existsSync(n))return null;var r=u.statSync(n);return r.isDirectory()?c.resolve(c.dirname(this.getActiveEditor().getPath()),t):null},t.prototype.addMasterReference=function(e,t){var n=e.highLevel(),r=n.attrOrCreate(T.Universe10.Overlay.properties.masterRef.name);r.setValue(t)},t.prototype.createMovedNode=function(e){return this.createStub(e)},t}(I);t.ExtractOverlayDialog=P;var L=function(e){function t(t,n){e.call(this,t,n),this.overlayASTRoot=t,console.log("Overlay AST root:"),console.log(this.overlayASTRoot.printDetails()),this.masterASTRoot=this.createMasterAST(),this.overlayASTLeafNodes=[],this.calculateLeafNodes(this.overlayASTRoot,this.overlayASTLeafNodes)}return l(t,e),t.prototype.getParentNode=function(){return this.masterASTRoot},t.prototype.checkNode=function(e){var t=this;return f.find(this.overlayASTLeafNodes,function(n){return n==e||t.nodesEqualById(n,e)})?{visitChildren:!1,display:!1,canBeMoved:!1}:{visitChildren:!0,display:!0,canBeMoved:!0}},t.prototype.validate=function(){return this.stubRoot&&0==this.movedNodes.length?"Add elements to move":null},t.prototype.createHeader=function(e){},t.prototype.performOk=function(e,t){var n=this.getOverlayUnit();this.updateOverlayUnit(n,t),this.saveUnit(n)},t.prototype.createMasterAST=function(){var e=this.findMasterAbsolutePath();if(!e)return null;var t=this.createProject(e),n=t.unit(c.basename(e));return n.highLevel()},t.prototype.calculateLeafNodes=function(e,t){var n=this;if(e){var r=e.directChildren()?e.directChildren():null;if(e.isElement()){if(!r)return void t.push(e);if(!f.find(r,function(e){return e.isElement()}))return void t.push(e)}r&&r.forEach(function(e){return n.calculateLeafNodes(e,t)})}},t.prototype.findMasterAbsolutePath=function(){try{var e=this.overlayASTRoot.attr("masterRef");if(!e)return null;var t=e.value();if(!t)return null;var n=this.getOverlayUnit().absolutePath(),r=c.resolve(c.dirname(n),t);return r}catch(i){return console.error(i.message),null}},t.prototype.createProject=function(e){return d.project.createProject(c.dirname(e))},t.prototype.getOverlayUnit=function(){return this.overlayASTRoot.lowLevel().unit()},t.prototype.updateOverlayUnit=function(e,t){e.highLevel();this.mergeTrees(t,this.overlayASTRoot)},t.prototype.createMovedNode=function(e){return this.createStub(e)},t}(I);t.ModifyOverlayDialog=L;var O=function(e){function t(t,n){e.call(this,t,n),this.sourceType=t}return l(t,e),t.prototype.getTargetType=function(){return null},t.prototype.checkNode=function(e){return{visitChildren:!0,display:!0,canBeMoved:!0}},t.prototype.validate=function(){return 0==this.movedNodes.length?"Add elements to move":null},t.prototype.createHeader=function(e){},t.prototype.performOk=function(e,t){var n=this.sourceType.lowLevel().unit(),r=this.getTargetType();if(r){var i=r.lowLevel().unit();this.mergeTrees(t,r),this.movedNodes.forEach(function(e){e.parent().remove(e)}),this.postMerge(),this.saveUnit(n),i&&this.saveUnit(i)}},t.prototype.postMerge=function(){},t}(I);t.AbstractMoveTypePropertiesDialog=O,t.findUserDefinedSupertypes=o;var R=function(e){function t(t,n){e.call(this,t,n),this.superTypeNames=[],this.superTypeNames=this.findSuperTypeNames()}return l(t,e),t.prototype.createHeader=function(e){var t=this;e.addChild(m.label("Select supertype:").pad(5,0));var n=new m.Select("",function(e){t.selectedSuperType=n.getValue()});n.setOptions(this.superTypeNames),n.setValue(this.superTypeNames[0]),this.selectedSuperType=this.superTypeNames[0],e.addChild(n)},t.prototype.show=function(){0!=this.superTypeNames.length&&e.prototype.show.call(this)},t.prototype.getTargetType=function(){var e=this,t=f.find(this.superTypes,function(t){return t.nameId()==e.selectedSuperType});return t?t.getAdapter(S.RAMLService).getDeclaringNode():null},t.prototype.findSuperTypeNames=function(){var e=[];return this.superTypes=o(this.sourceType),this.superTypes.forEach(function(t){e.push(t.nameId())}),e},t}(O);t.PullUpDialog=R;var M=function(e){function t(t,n){e.call(this,t,n)}return l(t,e),t.prototype.createHeader=function(e){var t=this;e.addChild(m.label("Supertype name:").pad(5,0)),this.superTypeName=m.texfField("",this.generateDefaultSupertypeName(),function(e){t.performValidation()}),e.addChild(this.superTypeName)},t.prototype.getTargetType=function(){var e=this.sourceType.root(),t=(e.definition().universe(),e.root().definition().property(T.Universe10.LibraryBase.properties.types.name),d.parser.modify.createObjectTypeDeclaration(this.superTypeName.getBinding().get())),n=t.highLevel();return this.typeWrapper=t,this.astRoot=e,n},t.prototype.validate=function(){var t=e.prototype.validate.call(this);return t?t:this.superTypeName.getBinding().get()&&0!=this.superTypeName.getBinding().get().trim().length?null:"Enter supertype name"},t.prototype.postMerge=function(){this.astRoot.toWrapper().addToProp(this.typeWrapper,"types"),this.sourceType.attrOrCreate("type").setValue(this.typeWrapper.highLevel().name())},t.prototype.generateDefaultSupertypeName=function(){return this.sourceType.name()+"SuperType"},t}(O);t.ExtractSupertypeDialog=M},function(e,t,n){function r(e,t){var n=new i,r=JSON.parse(e),o=n.generateSchema(r),a=JSON.stringify(o,null,2);return a}var i=function(){function e(){}return e.prototype.generateSchema=function(e){var t={};return t.required=!0,t.$schema="http://json-schema.org/draft-03/schema",this.pass(e,t),t},e.prototype.pass=function(e,t){var n=this.detectType(e);t.type=n,e&&null!=e&&(Array.isArray(e)?this.passArray(e,t):e instanceof Object&&this.passObject(e,t))},e.prototype.passObject=function(e,t){var n=this;Object.keys(e).forEach(function(r){return n.registerProperty(r,e[r],t)})},e.prototype.registerProperty=function(e,t,n){var r=n.properties;r||(r={},n.properties=r);var i=r[e];i||(i={},r[e]=i),i.required=!1,this.pass(t,i)},e.prototype.passArray=function(e,t){var n=this,r=t.items;r||(r=[],t.items=r);var i=(e.length,[]);e.forEach(function(e){var t={};n.pass(e,t),i.push(t)}),r.push(i[0])},e.prototype.detectType=function(e){return Array.isArray(e)?"array":typeof e},e}();t.JsonSchemaGenerator=i,t.generateSchema=r},function(e,t,n){e.exports=require("emissary")},function(e,t,n){function r(e,t){z.showMessageBox(W.getCurrentWindow(),{type:"error",buttons:["Okay"],title:"Error",message:e,detail:t})}function i(){if(!$){$=Object.create(null);var e=H.aquireManager().ast.definition().property(J.Universe10.Api.properties.resources.name).range().property(J.Universe10.ResourceBase.properties.methods.name),t=e.enumOptions();M.methods.filter(function(e){return t.indexOf(e.method.toLowerCase())>-1}).forEach(function(e){var t=e.description.trim().match(/^\"(.*)\"$/)[1];$[e.method.toLowerCase()]=t?t:e.description})}return $}function o(){return Z||(Z=Object.create(null),M.statusCodes.forEach(function(e){var t,n=e.description.trim();(t=n.match(/^\"(.*)\"/))&&(n=t[1]),Z[e.code]=n}),Z["7xx"]="is for developer errors."),Z}function a(){var e="",t="",n="",i=!0,o=!0,a=new R.TextField("API Title*",e,function(t,n){return e=n}),s=new R.TextField("Version",t,function(e,n){return t=n}),l=new R.TextField("Base URI",n,function(e,t){return n=t});a.setTabIndex(100),a.margin(0,0,8,0),s.setTabIndex(101),s.margin(0,0,8,0),l.setTabIndex(102),l.margin(0,0,8,0);var u=new R.CheckBox("Create sample resource",null,function(e,t){return i=t});u.setValue(i);var c=new R.CheckBox("Generate 1.0 model",null,function(e,t){return o=t});c.setValue(o);var d=R.section("Create new API",R.Icon.DASHBOARD,!1,!1,a,s,l,R.hc(u,c).margin(0,0,12,12));O(d,function(){return""==e?(r("Cannot create API","Title must not be empty"),!1):(H.aquireManager().setText(j.createRAMLFile(e,t,n,i,o)),!0)},a)(this),a.getActualField().ui().focus()}function s(e,t){var n=i(),a=o(),s="No response",l="No response body type",u=null,c=null;null==t&&(t="get");var d=new R.LabelField,p=new R.LabelField;[d,p].forEach(function(e){return e.addClass("wizard-description")}),d.getActualField().margin(0,0,18,8),p.getActualField().margin(0,0,8,8);var f=new R.SelectField("Method:",function(e,r){t=r,d.setText("Method "+r+" "+n[r])},null);f.getActualField().setOptions(Object.keys(n)),f.getActualField().setValue(t,!0);var h=new R.SelectField("Status code:",function(e,t){t==s&&(t=null,m.getActualField().setValue(l)),u=t,m.setDisabled(null==t),p.setText(t?"Status code "+t+" "+a[t]:"")},null);h.getActualField().setOptions([s].concat(Object.keys(a)));var m=new R.SelectField("Generate default response with media type:",function(e,t){t==l?(t=null,b.setDisabled(!0)):b.setDisabled(!1),c=t},null);m.getActualField().setOptions([l,"application/json","application/xml","application/x-www-form-urlencoded"]),m.setDisabled(!0),m.margin(0,0,0,12);var v=null,y=new R.SelectField("Generate default body with media type:",function(e,t){t==l?(t=null,x.setDisabled(!0)):x.setDisabled(!1),v=t},null);y.getActualField().setOptions([l,"application/json","application/xml","application/x-www-form-urlencoded"]),y.margin(0,0,0,12);var g=null,E=null,b=new R.SelectField("Generate default response body with type:",function(e,t){t==l&&(t=null),g=t},null);b.setDisabled(!0),b.margin(0,0,0,12);var T=ee(e),S=T.isSchema,C=T.types;C&&(C=[""].concat(C),b.getActualField().setOptions(C));var x=new R.SelectField("Generate default body with type:",function(e,t){t==l&&(t=null),E=t},null);x.setDisabled(!0),x.margin(0,0,0,12);var S=T.isSchema,C=T.types;C&&(C=[""].concat(C),x.getActualField().setOptions(C));var w=R.section("");w.addChild(R.h3("Body")),w.addChild(y),w.addChild(x),w.addChild(R.h3("Response")),w.addChild(h),w.addChild(p),w.addChild(m),w.addChild(b),w.ui();var A=R.section("Creating a new method",R.Icon.CODE,!1,!1,f,d,w),T=ee(e);O(A,function(){var n=e.elementsOfKind("methods").filter(function(e){return e.attr("method").value()==t})[0];n&&(r("Method "+t+" already exists","Node contents will be overwritten"),e.remove(n));var i=B.createMethodStub(e,t);if(v){var o=B.createBodyStub(i,v);E&&(S?o.attrOrCreate("schema").setValue(E):o.attrOrCreate("type").setValue(E)),i.add(o)}if(u){var a=B.createResponseStub(i,u);if(i.add(a),c){var o=B.createBodyStub(a,c);g&&(S?o.attrOrCreate("schema").setValue(g):o.attrOrCreate("type").setValue(g)),a.add(o)}}return e.add(i),H.updateAndSelect(i),!0})(this)}function l(e){return"object"==typeof e?e.valueName():e}function u(e,t,n,r){var i=R.vc();i.margin(8,8,20,8);var o=n.definition().property(e),a=c(n,e),s=H.aquireManager().ast.elementsOfKind("resourceType").map(function(e){return e.name()}),u=l(t),p=new R.SelectField("Type: ",function(e,r){if(r==f)return t="",i.clear(),void i.addChild(R.label("Select some type from the list above to show its additional properties",null,R.TextClasses.HIGHLIGHT));t=D.utils.genStructuredValue(r,n,o);var s="object"==typeof t?t.toHighLevel(H.aquireManager().ast):null;d(s,a),V.updateDetailsPanel(s,i),s&&0==s.definition().allProperties().length&&(t=r)}),f="(no value)";p.getActualField().setOptions([f].concat(s)),p.setPercentWidth(100),s.indexOf(u)<0?(p.getActualField().setValue(f),""!=u&&i.addChild(R.label("Type `"+u+"` does not exists",null,R.TextClasses.ERROR).setStyle("display","block")),i.addChild(R.label("Select some type from the list above to show its additional properties",null,R.TextClasses.HIGHLIGHT))):p.getActualField().setValue(u,!0);var h=R.section("Editing type value `"+e+"`:",R.Icon.CIRCUIT_BOARD,null,null,p,i);return O(h,function(){return r(t),!0})}function c(e,t){try{var n=new Y.Map,r=e.attributes(t).map(function(e){return e.value()}).filter(function(e){return"object"==typeof e});return r.forEach(function(e){return e.lowLevel().children().forEach(function(e){return n.set(e.key(),e.value())})}),n}catch(i){return null}}function d(e,t){e&&t&&t.pairs().forEach(function(t){e.definition().property(t.key)&&e.attrOrCreate(t.key).setValue(t.value)})}function p(e){return e&&e.property()?X.isResourcesProperty(e.property())?e:p(e.parent()):null}function f(e,t,n){var r={elements:function(e){return e},init:function(e){},dispose:function(){}},i={render:function(e){return R.hc(R.label(e,R.Icon.GIT_COMMIT),R.a("",function(e){t=t.filter(function(t){return t!=e.id()}),o.remove(e.id())},R.Icon.TRASHCAN).pad(8,8).setId(e)).addClass("outline")}},o=new R.ListView(r,i);o.setBasicLabelFunction(function(e){return e}),o.setInput(t,!0);var a=R.texfField("","",function(e){return e}).margin(0,0,4,4);a.addKeyPressListener(function(e,n){if(13==n.keyCode){var r=e.getBinding(),i=r.get();r.set(""),t.push(i),o.setInput(t,!0)}});var s=R.section("Editing enum value `"+e+"`:",R.Icon.LIST_UNORDERED,null,null,R.h3("List of elements in enum:").margin(0,0,20,0),o.margin(20,20),R.h3("Add new element:").margin(0,0,20,0),a);return O(s,function(){return n(t),!0},a)}function h(e){var t=e.attrValue("relativeUri");if(!t)return null;for(var n=p(e.parent());n;){var r=n.attrValue("relativeUri");if(!r)return null;t=r+t,n=p(n.parent())}return t}function m(e){var t="/",n="",r=p(e),o=null;r&&(o=h(r),o&&(n=o));var a=a=new R.TextField(n,t,function(e,n){t=n});a.margin(0,0,6,12);var s={},l=R.vc().margin(0,0,0,12);Object.keys(i()).forEach(function(e){var t=new R.CheckBox(e,null,function(t){s[e]?delete s[e]:s[e]=t}).addClass("checkbox-group"),n=R.vc().margin(0,0,15,0);n.addChild(t);var r=e+":"+i()[e];l.addChild(R.vc(n));var o=R.label(r,R.Icon.NONE,R.TextClasses.SUBTLE).margin(5,10,-4,0);l.addChild(o)});var u=B.createResourceStub(e,t),c=R.select("type"),d=F.globalDeclarations(e).filter(function(e){return X.isResourceTypeType(e.definition())&&!e.definition().getAdapter(U.RAMLService).isUserDefined()}),f=d.map(function(t){return D.search.qName(t,e)}),f=[""].concat(f);c.setOptions(f);var m=R.section("Creating a new resource",R.Icon.BOOK,!1,!1);m.addChild(R.label("New resource URI:")),m.addChild(a),m.addChild(R.label("Type:")),m.addChild(c),m.addChild(R.label("Add additional methods:").margin(0,0,18,6)),m.addChild(l),O(m,function(){if(0!=t.indexOf("/"))return!1;u.attrOrCreate("relativeUri").setValue(t),Object.keys(s).filter(function(e){return s[e]}).forEach(function(e){var t=B.createMethodStub(u,e);t.attrOrCreate("method").setValue(e),u.add(t)});var n=c.getValue();return n&&u.attrOrCreate("type").setValue(n),e.add(u),H.updateAndSelect(u),!0},a,!0)(this),a.getActualField().ui().focus(),o?a.makeLabelNextToField():a.hideLabel()}function v(e,t,n,r){void 0===r&&(r="key");if(null!=e){"body"==n&&(r="application/json");var i=B.createStub(e,n,r),o=G.buildItem(i,!0);o.setTitle(t);var a=o.render({showDescription:!0});a.margin(8,8,8,8),O(a,function(){return i._parent=null,i.lowLevel()._unit=null,e.add(i),H.updateAndSelect(i),!0},null)(this)}}function y(e,t,n,r){var i=c(n,e),o=new R.TabFolder,a=R.vc(R.h3("Enabled traits: ")).margin(10,10,0,0);o.margin(0,0,20,10),o.add("Traits",R.Icon.FILE_SUBMODULE,a);var s=n.definition().property(e),u=0,p=n.root().elementsOfKind("traits").map(function(e){var r=e.name(),c=D.utils.genStructuredValue(r,n,s),p="object"==typeof c?c.toHighLevel():null;p&&0==p.definition().allProperties().length&&(c=r);var f={index:u,name:r,value:c,enabled:t.filter(function(e){return l(e)==r}).length>0};d(p,i);var h=R.checkBox(f.name,function(e){f.enabled=h.getValue(),o.toggle(1+f.index,f.enabled)});h.margin(12,12),h.setValue(f.enabled),a.addChild(h);var m=R.vc();return m.margin(8,8,20,8),V.updateDetailsPanel(p,m),o.add(r,R.Icon.CIRCUIT_BOARD,m),o.toggle(1+u,f.enabled),u+=1,f}),f=R.section("Editing trait value `"+e+"`:",R.Icon.CIRCUIT_BOARD,null,null,o);return O(f,function(){return r(p),!0})}function g(e){var t=H.aquireManager().ast.elementsOfKind("schemas").filter(function(t){return t.name()==e})[0];return t?t.value().value():""}function E(e,t,n){var i="(New Schema)",o=H.aquireManager().ast.elementsOfKind("schemas").map(function(e){return e.name()}),a=o.indexOf(t)>=0,s=a?L(t):t,l=a?t:"",u=0,c=P(function(e,t){u=0}),d=K._schemaPreview(),p=setInterval(function(){u++<5||(u=0,K._updatePreview(d,c.getValue()))},100),f=new R.SelectField("Select schema: ",function(e,t){l=t,s=g(t),b(c,s)});f.getActualField().setOptions([i].concat(o)),f.setPercentWidth(100),a&&f.getActualField().setValue(l),b(c,s);var h=new R.TabFolder;h.add("Write",R.Icon.FILE_TEXT,c),h.add("Preview",R.Icon.GIT_MERGE,d);var m=R.section("Editing schema value `"+e+"`:",R.Icon.MICROSCOPE,null,null,f,h),v=function(){return r("No schema entered","Please enter a valid schema or select one from the list before proceeding."),!1},y=function(){return r("Invalid schema","Please fix the errors in the schema before saving it."),!1};return I(m,[{name:"Save as reference",highlight:R.ButtonHighlights.INFO,action:function(){var e=c.getValue(),t=s!=e;if(!t&&l==i)return v();if(0==T(e))return y();if(t){var r=S(l,e);return r?(n(r),clearInterval(p),!0):!1}return n(l),clearInterval(p),!0}},{name:"Save as text",highlight:R.ButtonHighlights.WARNING,action:function(){var e=c.getValue();return""==e?v():0==T(e)?y():(f.getActualField().setValue(i),l="Untitled",n(e),clearInterval(p),!0)}},{name:"Cancel",highlight:R.ButtonHighlights.NO_HIGHLIGHT,action:function(){return clearInterval(p),!0}}])}function b(e,t){var n=D.schema.createSchema(t,null),r=null==n||null==n.getType?"text/plain":n.getType();e.setGrammar(r),e.setText(t)}function T(e){return!0}function S(e,t){var n,r,i=D.schema.createSchema(t,null),o={name:"JSON schemas",extensions:["json"]},a={name:"XML schemas",extensions:["xsd"]},s=_.dirname(H.aquireManager().ast.lowLevel().unit().absolutePath());switch(i.getType()){case"source.json":r=[o],n=".json";break;case"text.xml":r=[a],n=".xsd";break;default:r=[]}var l=z.showSaveDialog(W.getCurrentWindow(),{title:"Save schema",defaultPath:_.resolve(s,"schemas",e+n),filters:r});if(null==l)return null;var u=_.basename(l),c=_.extname(u),d=u.substr(0,u.indexOf(c)),p=_.relative(s,l);return-1==H.aquireManager().ast.elementsOfKind("schemas").map(function(e){return e.name()}).indexOf(d)&&j.createGlobalSchemaFromNameAndContent(H.aquireManager().ast.root(),d,p,t,l),d}function C(e,t,n){var r=new R.AtomEditorElement(t.join("\n"),function(e){});r.margin(0,0,6,12),r.setMini(!1),r.setGrammar("source.gfm");var i=R.section("Editing markdown value `"+e+"`:",R.Icon.FILE_TEXT,!1,!1,R.h3("Please note that lines might be long enough so window would scroll.").margin(0,0,20,0),r);return O(i,function(){return n(r.getBinding().get()),!0},r)}function x(e,t,n,r){var i=P(function(e,t){t.indexOf("xml")>0?i.setGrammar("text.xml"):i.setGrammar("source.json")});i.setText(n);var o=_.dirname(H.aquireManager().getPath()),a=new R.TextField("Referenced from",t,function(e,n){return t=n},null,"No reference path provided");a.addChild(new R.Button("Browse",R.ButtonSizes.SMALL,R.ButtonHighlights.NO_HIGHLIGHT,null,function(){var e=R.fdUtils.openFileDialogModal("Open a reference",_.resolve(o,t),[]);e&&(a.getActualField().setText(_.relative(o,t=e[0])),n=q.readFileSync(e[0]).toString("UTF-8"),i.setText(n))}).margin(4,0));var s=a.getActualField().ui();s.onclick=function(e){s.blur(),s.nextSibling.onclick&&s.nextSibling.onclick(e)};var l=(R.vc(R.h3("Referenced")),R.section("Editing example value `"+e+"`:",R.Icon.MICROSCOPE,null,null,a.margin(12,12,20,12),i.margin(12,12,20,12)));return I(l,[{name:"Save as reference",highlight:R.ButtonHighlights.INFO,action:function(){var e=i.getValue();if(n!=e){var a=A(_.resolve(o,t),e);return a?(r(_.relative(o,a)),!0):!1}return r(t),!0}},{name:"Save as text",highlight:R.ButtonHighlights.WARNING,action:function(){return void 0==r(i.getValue())||!0}},{name:"Cancel",highlight:R.ButtonHighlights.NO_HIGHLIGHT,action:function(){return!0}}])}function w(){Q.pop(),0==Q.length?te.destroy():te=atom.workspace.addModalPanel({item:Q[Q.length-1].ui()})}function A(e,t){var n={name:"JSON schemas",extensions:["json"]},r={name:"XML schemas",extensions:["xsd"]},i={name:"All files",extensions:["*"]},o=(t.indexOf("xml")<0?"json":"xml",R.fdUtils.saveFileDialogModal("Save an example",e,[n,r,i]));return o&&q.writeFileSync(o,t),o}function I(e,t,n,r){void 0===r&&(r=!1);var i=R.hc().setPercentWidth(100);t.reverse().forEach(function(t){var n=R.button(t.name,R.ButtonSizes.NORMAL,t.highlight,R.Icon.NONE,function(e){t.action()&&w()});if(t.isPrimary){var r=e.getBinding().status();r&&r.code==R.StatusCode.ERROR&&n.setDisabled(!0),e.getBinding().addStatusListener(function(t){var r=e.getBinding().status();r&&(r.code!=R.StatusCode.ERROR?n.setDisabled(!1):n.setDisabled(!0))})}n.setStyle("float","right").margin(4,10),i.addChild(n)}),e.addChild(i);var o=e.ui();return function(t){Q.push(e);var i=function(){if(r){var e=o.parentElement,t=document.body.clientHeight;if(e){var n=window.getComputedStyle(e);["paddingBottom","paddingTop","marginBottom","marginTop"].forEach(function(e){t-=parseFloat(n[e]||0)}),o.style.height=t+"px",o.style.overflowY="scroll"}}};window.addEventListener("resize",i),te=atom.workspace.addModalPanel({item:o}),te.onDidDestroy(function(){window.removeEventListener("resize",i)}),i(),n&&n.ui().focus()}}function N(e){r(e,"")}function P(e){e||(e=function(e,t){});var t=new R.AtomEditorElement("",e);return t.setMini(!1),t.setStyle("height","400px"),t.setStyle("border","solid"),t.setStyle("border-width","1px"),t}function L(e){var t=H.aquireManager().ast.elementsOfKind("schemas").filter(function(t){return t.name()==e})[0];return t?t.value().value():""}function O(e,t,n,r){return void 0===r&&(r=!1),I(e,[{name:"Ok",isPrimary:!0,highlight:R.ButtonHighlights.PRIMARY,action:t},{name:"Cancel",highlight:R.ButtonHighlights.NO_HIGHLIGHT,action:function(){return!0}}],n,r)}var R=n(19),M=n(52),D=n(15),_=n(14),k=D.ds,B=D.stubs,U=k,F=D.search,q=n(17),j=n(8),G=n(57),V=n(38),H=n(4),K=n(39),W=n(53),z=W.require("dialog"),Y=n(58),J=D.universes,X=D.universeHelpers,Q=[];t.showError=r;var $=null,Z=null;t.getStatusCodeDescriptions=o,t.newApi=a;var ee=function(e){var t=!1,n=e.definition().universe().type(J.Universe10.TypeDeclaration.name);n||(t=!0,n=e.definition().universe().type(J.Universe08.BodyLike.name));var r=n.property(J.Universe10.TypeDeclaration.properties.schema.name),i=[];return r&&(i=F.enumValues(r,e)),{isSchema:t,types:i}};t.newMethod=s,t.getStringValue=l,t.typeEditDialog=u,t.getResourceParent=p,t.enumEditDialog=f,t.newResource=m,t.newNode=v,t.traitsEditDialog=y,t.schemaEditDialog=E,t._updateEditor=b,t.markdown=C,t.exampleEditorDialog=x;var te=null;t.msg=N,t.smallEditor=P},function(e,t,n){var r=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},i=n(18),o=function(e){function t(){e.call(this),this._children=[]}return r(t,e),t.content=function(){var e=this.div({"class":"scrollpad pane-item padded",tabindex:-1,style:"overflow:scroll;"});return e},t.prototype.dispose=function(){},t.prototype.caption=function(){return""},t.prototype.scroll=function(e,t){this.element.scrollTop=e,this.element.scrollLeft=t},t.prototype.size=function(){return{top:this.element.scrollTop,left:this.element.scrollLeft,bottom:this.element.scrollTop+this.element.clientHeight,right:this.element.scrollLeft+this.element.clientWidth}},t.prototype.changed=function(){},t.prototype.refresh=function(){},t.prototype.ui=function(){return this.element},t.prototype.setParent=function(e){null!=this._parent&&this._parent.removeChild(this),this._parent=e},t.prototype.addChild=function(e){e.setParent(this),this._children.push(e)},t.prototype.removeChild=function(e){this._children=this._children.filter(function(t){return t!=e})},t.prototype.doRender=function(){return this.innerRenderUI()},t.prototype.selfRender=function(){return document.createElement("div")},t.prototype.attached=function(){this.html(this.innerRenderUI())},t.prototype.innerRenderUI=function(){var e=this.selfRender();return this._children.forEach(function(t){var n=t.renderUI();n&&e.appendChild(n)}),e},t.prototype.renderUI=function(){return this.element},t.prototype.parent=function(){return null},t.prototype.children=function(){return this._children},t.prototype.isAttached=function(){return!0},t}(i.ScrollView);t.Scrollable=o},function(e,t,n){function r(e,t,n){void 0===n&&(n=!1),t.clear();var r=!0,i=h.buildItem(e,!1);i.addListener(function(e){f.aquireManager().updateText(null)});var o=i.render({});if(t.addChild(o),r=!1,y){var a=y.getActualField().ui();a.focus(),a.getModel().setCursorBufferPosition(v),y=null,v=null,m=null}if(r){var s=d.h3("Object `"+e.name()+"` has no additional properties.");d.applyStyling(d.TextClasses.WARNING,s),s.setStyle("text-align","center").margin(0,0,24,12),t.addChild(s)}}function i(e){var t=p.createSchema(e,null);if(!t||!t.getType)return"Invalid";switch(t.getType()){case"source.json":return"JSON";case"text.xml":return"XML";default:return"Unknown type"}}function o(e){return"object"==typeof e?e.valueName():e}function a(e,t){var n=e.definition().property(t);if(0==n.isValueProperty())return null;var r,a,s,l=n.isMultiValue(),u=n.isRequired(),d=[],p=n.range().nameId();if(l)switch(d=e.attributes(t).map(function(e){return e.value()}),r=d.map(function(e){return o(e)}).join(", "),p){case"StringType":a="enum",e.definition().getAdapter(c.RAMLService).isUserDefined()||"protocols"!=t||(a="protocols");break;case"TraitRef":a="trait";break;default:a="unknown"}else{var f=e.attr(t);switch(r=f&&f.value()?f.value():"",p){case"MarkdownString":a="markdown",d=r.split("\n"),r=d[0];break;case"SchemaString":a="schema",r.indexOf("\n")>=0&&(d=[r],
r="("+i(r)+" Schema)");break;case"ExampleString":a="schexample";try{s=f.lowLevel().includePath()}catch(h){s=""}d=[r,s],r="Example"+(""!=s?" (referenced from "+s+")":"");break;case"ResourceTypeRef":a="type";break;default:a="string"}"string"==a&&(r.indexOf("\n")>=0&&(d=r.split("\n"),r="("+d.length+" lines) "+d[0].substring(0,20)+" ...",a="multiline"),f&&(s=f.lowLevel().includePath()),s&&(r="(included from "+s+")",a="include"))}var m={value:r,values:d,type:a,include:s,required:u};return m}function s(e,t){return o(a(e,t).value)}var l=n(15),u=l.ds,c=u,d=n(19),p=l.schema,f=n(4),h=n(57);t.nodes={Api:{properties:["title","version","baseUri","mediaType","protocols"],actions:[]},Resource:{properties:["relativeUri","displayName","description","is","type"]},Method:{properties:["method","displayName","description","is","type","protocols","securedBy"]},DataElement:{properties:["name","displayName","description","default","required"]},Response:{properties:["code","description"]}},t.filterOut={properties:["location","annotations","repeat","locationKind","signature"]};var m=null,v=-1,y=null;t.updateDetailsPanel=r,t.getStringValue=o,t.propertyInfo=a,t.stringView=s},function(e,t,n){function r(){var e=f.treeViewer(function(e){return e.children},new y,function(e){return e.name+":"+e.type});return e.setComparator(function(e,t){return e.name==t.name&&e.type==t.type}),e}function i(e,t){t.type instanceof Array&&(t.type.indexOf("object")>=0?t.type="object":t.type.indexOf("array")>=0&&(t.type="array"));var n=t.type?(t.type instanceof Array?t.type.join("|"):t.type).toLowerCase():"unspecified",r=[];t.properties?r=Object.keys(t.properties).map(function(e){return i(e,t.properties[e])}):t.items&&(r=t.items instanceof Array?t.items.map(function(e){return i("item",e)}):i("item",t.items)),r instanceof Array==0&&(r=[r]);var o={type:n,name:e,parent:null,children:r};return o.children.forEach(function(e){return e.parent=o}),o}function o(e,t){try{var n=v.createSchema(t,null);if(null==n||null==n.getType)return void e.setInput({},!0);var r=n.getType(),o="source.json"==r?JSON.parse(t):s(t),a="source.json"==r?i("schema",o):d(o);e.setInput(a,!0)}catch(l){console.log(l)}}function a(e){var t=n(51).XSD_1_0,r=new g.Jsonix.Context([t]),i=r.createUnmarshaller(),o=i.unmarshalString(e);return o}function s(e){var t=a(e);return u(t)}function l(e){var t=e.prefix,n=e.localPart,r=t+(t.length>0?":":"")+n;return r}function u(e){var t=this,n=e.value,r=[];if(n){var i=n.group;i&&i.forEach(function(e){return t.elementGroups[e.name]=e});var o=n.attributeGroup;o&&o.forEach(function(e){return t.attributeGroups[e.name]=e});var a=n.simpleType;a&&a.forEach(function(e){return t.simpleTypes[e.name]=e});var s=n.complexType;s&&s.forEach(function(e){return t.complexTypes[e.name]=e});var l=n.element;l&&(r=l.map(function(e){return new T(t,e)}))}return r}function c(e){return C[e]}function d(e){var t=function(e){return e?(e=e.substr(e.indexOf(":")+1),c(e)):"Unknown"};return e.map(function(e){var n,r=e.type().value();return n=e.isArray()?{type:"Array",name:e.name(),parent:null,children:d(r.elements())}:r.isSimple()?{type:t(r.name()),name:e.name(),parent:null,children:[]}:{type:"Object",name:e.name(),parent:null,children:d(r.elements())},n.children.forEach(function(e){return e.parent=n}),n})}var p=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},f=n(19),h=n(15),m=n(56),v=h.schema,y=function(){function e(){}return e.prototype.render=function(e){var t,n;switch(e.type){case"object":t=f.Icon.CIRCUIT_BOARD,n=f.TextClasses.INFO;break;case"array":t=f.Icon.LIST_UNORDERED,n=f.TextClasses.ERROR;break;case"unspecified":t=f.Icon.QUESTION,n=f.TextClasses.WARNING;break;default:t=f.Icon.CODE,n=f.TextClasses.SUCCESS}return f.hc(f.label(e.name+": ",t),f.label(e.type,null,n,null).pad(4,0))},e}();t.SchemaRenderer=y,t._schemaPreview=r,t.getSchemaTree=i,t._updatePreview=o;var g=n(50),E=function(){function e(e,t,n,r){var i=this;this.owner=e,this._name=t,this._isSimple=n,this._object=r,this.name=function(){return i._name},this.isSimple=function(){return i._isSimple},this.object=function(){return i._object}}return e.prototype.isChoice=function(){return this.object&&(this.object.choice||this.object.complexContent&&this.object.complexContent.choice)},e.prototype.elements=function(){var e=this,t=[];if(this._object&&(t=this.collectElements(this._object),0==t.length)){var n=this.object.complexContent;n&&(t=this.collectElements(n))}var r=t.map(function(t){return new T(e.owner,t)});return r},e.prototype.attributes=function(){for(var e=this,t=[],n=[this._object],r=0;r<n.length;r++){var i=n[r];if(i){if(i.attributeGroup)for(var o=i.attributeGroup.filter(function(e){return e.otherAttributes}),a=0;a<o.length;a++){var s=o[a].otherAttributes.ref,l=this.owner.attributeGroups[s];n.push(l)}i.attribute&&i.attribute.forEach(function(n){return t.push(new S(e.owner,n))})}}return t},e.prototype.base=function(){if(!this._object)return m.empty();var t;if(this._object.restriction){var n=this._object.restriction;t=n.base}else if(this._object.complexContent){var r=this.object.complexContent,i=r.restriction||r.extension;i&&(t=i.base)}if(!t)return m.empty();var o,a=l(t),s=!1,u=this.owner.simpleTypes[a];u&&(o=u,s=!0);var c=this.owner.complexTypes[a];c&&(o=c),(0==a.indexOf("xs:")||0==a.indexOf("xsd:"))&&"any"!=a.substring(a.indexOf(":")+1)&&(s=!0);var d=new e(this.owner,a,s,o);return new m(d)},e.prototype.getBaseName=function(){for(var e=new m(this),t="";e.isDefined();){var n=e.getOrThrow();t=n.name(),e=n.base()}return t},e.prototype.collectElements=function(e){for(var t=[],n=[e.sequence,e.any,e.choice],r=0;r<n.length;r++){var i=n[r];if(i){if(i.group)for(var o=i.group.filter(function(e){return e.otherAttributes}),a=0;a<o.length;a++){var s=o[a].otherAttributes.ref,l=this.owner.elementGroups[s];l&&(l.sequence&&(n=n.concat(l.sequence)),l.any&&(n=n.concat(l.any)),l.choice&&(n=n.concat(l.choice)))}i.element&&(t=t.concat(i.element)),t=t.concat(this.collectElements(i))}}return t},e}(),b=function(){function e(e,t){var n=this;this.owner=e,this._object=t,this.name=function(){return n._object.name}}return e.prototype.type=function(){var e,t,n=!1;if(this._object.type){var r=this._object.type;e=l(r);var i=this.owner.simpleTypes[e];i&&(t=i,n=!0);var o=this.owner.complexTypes[e];o&&(t=o),(0==e.indexOf("xs:")||0==e.indexOf("xsd:"))&&"any"!=e.substring(e.indexOf(":")+1)&&(n=!0)}else this._object.complexType?t=this._object.complexType:this._object.simpleType&&(t=this._object.simpleType);var a=new E(this.owner,e,n,t);return new m(a)},e.prototype.optional=function(){throw new Error("This method is abstract.")},e.prototype.isArray=function(){throw new Error("This method is abstract.")},e.prototype.isAttribute=function(){return!1},e}();t.PropertyDescription=b;var T=function(e){function t(t,n){e.call(this,t,n)}return p(t,e),t.prototype.isArray=function(){var e=this._object.otherAttributes;if(!e)return!1;var t=e.maxOccurs;if(!t)return!1;if("unbounded"==t)return!0;try{var n=parseInt(t);return n>1}catch(r){}return!1},t.prototype.optional=function(){var e=this._object.otherAttributes;if(!e)return!0;var t=e.minOccurs;if(!t)return!0;try{var n=parseInt(t);return 0==n}catch(r){}return!0},t}(b);t.ElementDescription=T;var S=function(e){function t(t,n){e.call(this,t,n)}return p(t,e),t.prototype.optional=function(){var e=this._object.otherAttributes;if(!e)return!1;var t=e.use;return t?"required"!=t:!1},t.prototype.isArray=function(){return!1},t.prototype.isAttribute=function(){return!0},t}(b);t.AttributeDescription=S;var C={ENTITIES:"string",ENTITY:"string",ID:"string",IDREF:"string",IDREFS:"string",language:"string",Name:"string",NCName:"string",NMTOKEN:"string",NMTOKENS:"string",normalizedString:"string",QName:"string",string:"string",token:"string",date:"string",dateTime:"string",duration:"string",gDay:"string",gMonth:"string",gMonthDay:"string",gYear:"string",gYearMonth:"string",time:"string",anyURI:"string",base64Binary:"string",hexBinary:"string",NOTATION:"string","boolean":"boolean","double":"number","float":"number","byte":"number",decimal:"number","int":"number",integer:"number","long":"number",negativeInteger:"number",nonNegativeInteger:"number",nonPositiveInteger:"number",positiveInteger:"number","short":"number",unsignedLong:"number",unsignedInt:"number",unsignedShort:"number",unsignedByte:"number"};t.getTSType=c},function(e,t,n){e.exports=require("react")},function(e,t,n){e.exports=require("xtend")},function(e,t,n){e.exports=require("popsicle")},function(e,t,n){e.exports=require("xmldom")},function(e,t,n){e.exports=require("yaml-ast-parser")},function(e,t,n){function r(e,t){return{close:function(){}}}var i=function(){function e(e){this.path=e}return e.prototype.getPath=function(){return this.path},e.prototype.close=function(){},e}();t.File=i,t.watch=r},function(e,t,n){function r(e){for(var t=atom.workspace.getTextEditors(),n=0;n<t.length;n++){var r=t[n];if(String(r.id)===e)return r}}function i(e){for(var t=atom.workspace.getTextEditors(),n=0;n<t.length;n++){var r=t[n];if(r.getPath()===e)return r}}function o(e){if(null==e)return atom.grammars.grammarsByScopeName["text.plain.null-grammar"];for(var t=s.extension(e),n=atom.grammars.getGrammars(),r=0;r<n.length;r++){var i=n[r];if(i.fileTypes.indexOf(t)>-1)return i}return atom.grammars.grammarsByScopeName["text.plain.null-grammar"]}function a(e,t){var n=document.createElement("atom-text-editor");n.setAttributeNode(document.createAttribute("gutter-hidden")),n.removeAttribute("tabindex");var r=n.getModel();return r.getDecorations({"class":"cursor-line",type:"line"})[0].destroy(),r.setText(e),r.setGrammar(t),n}var s=n(54);s.define({"text/xml":["xml"]}),t.getEditorById=r,t.getEditorByPath=i,t.getGrammerFromMime=o,t.codeToEditorElement=a},function(e,t,n){function r(e,t){for(var n=t.resources(),i=0;i<n.length;i++){var o=n[i],a=o.relativeUri();if(a===e)return o;if(e.substr(0,a.length)===a&&"/"===e[a.length]){var s=r(e.substr(a.length),o);if(s)return s}}}function i(e,t){for(var n=t.methods(),r=0;r<n.length;r++){var i=n[r];if(i.method()===e)return i}}function o(e,t){var n=e.api(),r=e.resource();t=f({queryParameters:{},uriParameters:{},headers:{},baseUriParameters:{}},t);var i=d(t.baseUri||n.baseUri().getOrElse(""),t.baseUriParameters,c(n.baseUriParameters())).replace(/\/$/,""),o=d(r.absoluteUri(),t.uriParameters,c(r.absoluteUriParameters())),a=p.stringify(t.queryParameters);return{url:i+o+(a?"?"+a:""),method:e.method(),postData:{text:t.body},queryString:Object.keys(t.queryParameters).map(function(e){return{name:e,value:t.queryParameters[e]}}),headers:Object.keys(t.headers).map(function(e){return{name:e,value:t.headers[e]}})}}function a(e){var t={url:e.url,method:e.method,body:e.postData&&e.postData.text,parse:!1,headers:{}};return e.headers.forEach(function(e){t.headers[e.name]=e.value}),t}function s(e){var t={status:e.status,headers:[],content:{text:e.body,mimeType:e.get("Content-Type")}};return Object.keys(e.headers).forEach(function(n){t.headers.push({name:e.name(n),value:e.get(n)})}),t}function l(e,t){var n={};return e&&t.forEach(function(t){var r=t.name();null!=e[r]&&(n[r]=e[r])}),n}function u(e,t){var n={};return e&&t.forEach(function(t){var r=t.name().toLowerCase();"content-type"!=r&&null!=e[r]&&(n[r]=e[r])}),n}function c(e){var t={};return e.forEach(function(e){var n=e.definitions().reduce(function(e,t){return e||t["default"]().getOrElse(void 0)||t["enum"]().getOrElse(void 0)},void 0);null!=n&&(t[e.name()]=n)}),t}function d(e,t,n){return e.replace(/\{([^{}]+)\}/g,function(e,r){return t&&null!=t[r]?t[r]:n&&null!=n[r]?n[r]:""})}var p=n(55),f=n(41);t.findResource=r,t.findMethod=i,t.request=o,t.toPopsicleRequest=a,t.fromPopsicleResponse=s,t.extractParameters=l,t.extractHeaders=u,t.extractDefaultParameters=c,t.template=d},function(e,t,n){function r(e,t,n){return 1===e?t:n}function i(e,t){for(var n=Object.keys(e),r=t.toLowerCase(),i=0;i<n.length;i++)if(n[i].toLowerCase()===r)return e[n[i]]}function o(e){var t=e.getKind()===m.NodeKind.ATTRIBUTE?e.value():e.name();if("string"!=typeof t&&(t=t.valueName()),!t&&e.getKind()===m.NodeKind.NODE){var n=e.wrapperNode();if("DocumentationItemImpl"===n.wrapperClassName())return n.title();if("ApiImpl"===n.wrapperClassName())return"Home"}return t}var a=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},s=n(59),l=n(40),u=n(41),c=n(60),d=n(61),p=n(62),f=n(15),h=f.wrapperHelper,m=f.hl,v=n(46),y=(f.ds,"·"),g={get:"btn-primary","get?":"btn-primary",post:"btn-success","post?":"btn-success","delete":"btn-error","delete?":"btn-error",put:"btn-warning","put?":"btn-warning",patch:"btn-info","patch?":"btn-info"},E=function(e){function t(){e.apply(this,arguments)}return a(t,e),t.prototype.isSupportedNode=function(e){var t=e.wrapperClassName();switch(t){case"ObjectTypeDeclarationImpl":case"ResponseImpl":case"TypeDeclarationImpl":case"LibraryImpl":case"SecuritySchemePartImpl":case"LibraryImpl":case"SecuritySchemePartImpl":case"OAuth1SecuritySchemeSettingsImpl":case"OAuth2SecuritySchemeSettingsImpl":return!1;default:return!0}},t.prototype.renderNode=function(e){var t=u(this.props,{node:e});return"TraitImpl"===e.wrapperClassName()?l.createElement(A,t):"ResourceTypeImpl"===e.wrapperClassName()?l.createElement(O,t):"AbstractSecuritySchemeImpl"===e.wrapperClassName()||"OAuth1SecuritySchemeImpl"===e.wrapperClassName()||"OAuth2SecuritySchemeImpl"===e.wrapperClassName()?l.createElement(R,t):"GlobalSchemaImpl"===e.wrapperClassName()?l.createElement(x,t):"ResourceImpl"===e.wrapperClassName()?l.createElement(M,t):"DocumentationItemImpl"===e.wrapperClassName()?l.createElement(B,t):"MethodImpl"===e.wrapperClassName()?l.createElement(F,t):"ApiImpl"===e.wrapperClassName()?l.createElement(T,t):l.createElement(z,null,l.createElement(I,{title:"404"}),l.createElement(z,null,"How did you get here? You shouldn't be here! Please ",l.createElement("a",{href:"https://github.com/mulesoft/api-workbench/issues"},"report me"),"."),l.createElement(z,null,l.createElement("strong",null,"Reference: "+e.wrapperClassName())))},t.prototype.renderBreadcrumb=function(e,t){var n=this,r=[],i=[],a=e;if(this.props.errors.length)r.push(l.createElement("span",{key:"errors"},"Errors"));else{do i.unshift(a);while(a=a.parent());i.forEach(function(e,a){var s=a===i.length-1;e.getKind()===m.NodeKind.NODE&&n.isSupportedNode(e.wrapperNode())&&e.wrapperNode()!==t?r.push(l.createElement("a",{key:e.id(),onClick:function(){return n.props.navigate(e.id())}},o(e))):r.push(l.createElement("span",{key:"value"+a},o(e))),s||r.push(l.createElement("span",{key:"sep"+a}," "+y+" "))})}return l.createElement(z,{className:"padded",style:{margin:0,flex:"0 0 auto"}},r)},t.prototype.getCurrentNode=function(){var e=this.props.raml,t=this.props.state;if(!e)return null;if(t.view.id){var n=e.highLevel().findById(t.view.id);if(n)return n}return e.highLevel()},t.prototype.wrapBody=function(e){return l.createElement(z,{id:"raml-console-view",className:"padded",style:{overflow:"auto",height:"100%"}},e)},t.prototype.wrapContent=function(e,t){return l.createElement(z,{style:{height:"100%",display:"flex",flexDirection:"column"}},e,this.wrapBody(t))},t.prototype.render=function(){if(!this.props.loaded)return l.createElement(w);var e,t=this.getCurrentNode();if(this.props.errors.length)return this.wrapBody(l.createElement(b,{errors:this.props.errors}));if(t.isElement())e=t.wrapperNode();else{var n=t.findReferencedValue();if(!n)return this.wrapContent(this.renderBreadcrumb(t),l.createElement(C,u(this.props,{highLevelNode:t})));e=n.wrapperNode()}for(;!this.isSupportedNode(e);)e=e.parent();return this.wrapContent(this.renderBreadcrumb(t,e),this.renderNode(e))},t}(d);t.Console=E;var b=function(e){function t(){e.apply(this,arguments)}return a(t,e),t.prototype.render=function(){return l.createElement(z,null,l.createElement(I,{title:"Errors"}),l.createElement("ul",null,this.props.errors.map(function(e,t){return l.createElement("li",{key:t},e.message)})))},t}(d),T=function(e){function t(){e.apply(this,arguments)}return a(t,e),t.prototype.render=function(){var e=this,t=this.props.node;return l.createElement("div",null,l.createElement(I,{title:t.title()}),l.createElement(W,this.props),t.documentation().length?l.createElement(Y,null,l.createElement("h3",{style:{marginTop:0}},"Documentation"),l.createElement("ul",null,t.documentation().map(function(t){var n=t.highLevel().id();return l.createElement("li",{key:n},l.createElement("a",{onClick:function(){return e.props.navigate(n)}},t.title()))}))):null,l.createElement(k,this.props))},t}(d),S=function(e){function t(){e.apply(this,arguments)}return a(t,e),t.prototype.render=function(){var e=this,t=this.props.method.method();return l.createElement("div",{onClick:function(){return e.props.navigate(e.props.method.highLevel().id())},className:c("btn inline-block",g[t])},t.toUpperCase())},t}(d),C=function(e){function t(){e.apply(this,arguments)}return a(t,e),t.prototype.render=function(){var e=this.props.highLevelNode;return l.createElement(z,null,l.createElement(I,{title:"Missing Reference"}),"Unable to resolve reference: ",l.createElement("strong",null,e.id()))},t}(d),x=function(e){function t(){e.apply(this,arguments)}return a(t,e),t.prototype.render=function(){var e=this.props.node;return l.createElement(z,null,l.createElement(I,{node:e,title:e.key(),type:"Schema"}),l.createElement(K,{content:e.value().value(),setState:this.props.setState,state:this.props.state}))},t}(d),w=function(e){function t(){e.apply(this,arguments)}return a(t,e),t.prototype.render=function(){return l.createElement(z,null,l.createElement("div",{className:"loading-spinner-medium inline-block"}),l.createElement("span",{className:"inline-block"},"Loading RAML…"))},t}(d),A=function(e){function t(){e.apply(this,arguments)}return a(t,e),t.prototype.render=function(){var e=this.props.node,t=e.highLevel().findReferences();return l.createElement(z,null,l.createElement(I,{node:e,title:e.name(),type:"Trait"}),l.createElement(N,{text:e.usage(),title:"Usage"}),l.createElement(U,this.props),l.createElement(P,{references:t,navigate:this.props.navigate}))},t}(d),I=function(e){function t(){e.apply(this,arguments)}return a(t,e),t.prototype.render=function(){var e=this.props.title;return l.createElement("h1",{style:{marginTop:0}},this.props.node?l.createElement(J,{node:this.props.node},e):e,this.props.type?l.createElement("small",null," ("+this.props.type+")"):null)},t}(d),N=function(e){function t(){e.apply(this,arguments)}return a(t,e),t.prototype.render=function(){var e=this.props.text;return e?l.createElement(z,null,l.createElement("strong",null,this.props.title+": "),e):null},t}(d),P=function(e){function t(){e.apply(this,arguments)}return a(t,e),t.prototype.formatNode=function(e){var t=[];do t.unshift(o(e));while(e=e.parent());return t.join(" "+y+" ")},t.prototype.render=function(){var e=this,t=this.props.references;return t.length?l.createElement(Y,null,l.createElement("h3",null,"References ("+t.length+" Found)"),l.createElement("ul",null,t.map(function(t){var n=t.id(),r=t.parent();return l.createElement("li",{key:n},l.createElement("a",{onClick:function(){return e.props.navigate(r.id())}},e.formatNode(r)))}))):null},t}(d),L=function(e){function t(){e.apply(this,arguments)}return a(t,e),t.prototype.render=function(){var e=this,t=this.props.node,n=this.props.navigate,r=t.methods(),i=t.uriParameters();return l.createElement(z,null,l.createElement(W,this.props),l.createElement(X,{content:t.description()}),r.length?l.createElement(z,null,r.map(function(t){return l.createElement(S,{key:t.method(),method:t,navigate:e.props.navigate})})):null,l.createElement(_,{parameters:i,title:"URI Parameters",navigate:n}))},t}(d),O=function(e){function t(){e.apply(this,arguments)}return a(t,e),t.prototype.render=function(){var e=this.props.node,t=e.highLevel().findReferences();return l.createElement(z,null,l.createElement(I,{node:e,title:e.name(),type:"Resource Type"}),l.createElement(N,{text:e.usage(),title:"Usage"}),l.createElement(L,this.props),l.createElement(P,{references:t,navigate:this.props.navigate}))},t}(d),R=function(e){function t(){e.apply(this,arguments)}return a(t,e),t.prototype.render=function(){var e=this.props.node,t=e.highLevel().findReferences();return l.createElement(z,null,l.createElement(I,{node:e,title:e.name(),type:"Security Scheme"}),l.createElement(N,{title:"Type",text:e.type()}),l.createElement(N,{title:"Display Name",text:e.displayName()}),l.createElement(X,{content:e.description()}),l.createElement(U,u(this.props,{node:e.describedBy()})),l.createElement(P,{references:t,navigate:this.props.navigate}))},t}(d),M=function(e){function t(){e.apply(this,arguments)}return a(t,e),t.prototype.render=function(){var e=this.props.node;return l.createElement(z,null,l.createElement(I,{node:e,title:e.relativeUri().value(),type:"Resource"}),l.createElement(L,this.props),l.createElement(k,this.props))},t}(d),D=function(e){function t(){e.apply(this,arguments)}return a(t,e),t.prototype.renderDefinition=function(e,t){return l.createElement(z,null,t?l.createElement(z,null,l.createElement("span",{className:"highlight"},e.nameId())):null,e.superTypes().length?l.createElement(z,null,l.createElement(z,null,l.createElement("strong",null,"Super Types:")),e.superTypes().map(function(e){return l.createElement("span",{className:"highlight",style:{marginRight:5}},e.nameId())})):null,e.allProperties().length?l.createElement(z,null,l.createElement("h5",null,"Properties"),e.allProperties().map(function(e){return l.createElement(z,{key:e.nameId()},l.createElement(z,null,l.createElement("strong",null,e.nameId()),e.isRequired()?" (required)":""),l.createElement(z,null,e.description()))})):null,e.hasUnionInHierarchy()?l.createElement(z,null,l.createElement(z,null,l.createElement("strong",null,"Left: ")),this.renderDefinition(e.unionInHierarchy().leftType(),!0),l.createElement(z,null,l.createElement("strong",null,"Right: ")),this.renderDefinition(e.unionInHierarchy().rightType(),!0)):null,e.hasArrayInHierarchy()?l.createElement(z,null,l.createElement(z,null,l.createElement("strong",null,"Item: ")),this.renderDefinition(e.arrayInHierarchy().componentType(),!0)):null)},t.prototype.render=function(){var e=this.props.node;return null==e?null:l.createElement(z,null,"function"==typeof e.type?l.createElement(z,null,e.type().map(function(e){return l.createElement("span",{key:e,className:"highlight",style:{marginRight:5}},e)})):null,this.renderDefinition(e.runtimeDefinition(),!1))},t}(d),_=function(e){function t(){e.apply(this,arguments)}return a(t,e),t.prototype.summary=function(e){var t=[];if("FileTypeDeclarationImpl"===e.wrapperClassName()){var n=e;n.fileTypes()&&t.push("fileTypes: "+n.fileTypes()),n.minLength()&&t.push("minLength: "+n.minLength()),n.maxLength()&&t.push("maxLength: "+n.maxLength())}if("IntegerTypeDeclarationImpl"===e.wrapperClassName()){var r=e;null!=r.minimum()&&t.push("minimum: "+r.minimum()),null!=r.maximum()&&t.push("maximum: "+r.maximum())}return e.required()&&t.push("required"),e.repeat()&&t.push("repeat"),t.join(", ")},t.prototype.render=function(){var e=this;if(!this.props.parameters.length)return null;this.props.navigate;return l.createElement(z,null,l.createElement("h3",null,this.props.title),this.props.parameters.map(function(t){return l.createElement(z,{key:t.name()},l.createElement("h4",null,l.createElement(J,{node:t},t.name())),l.createElement(D,{node:t}),l.createElement(z,null,l.createElement("strong",null,e.summary(t))),l.createElement(X,{content:t.description()}))}))},t}(d),k=function(e){function t(){e.apply(this,arguments)}return a(t,e),t.prototype.render=function(){var e=this,t=this.props.node;return l.createElement(z,null,t.resources().map(function(t){var n=t.highLevel().id(),i=t.resources().length;return l.createElement(Y,{key:n},l.createElement("h4",null,l.createElement(J,{node:t},h.completeRelativeUri(t))," ",i?l.createElement("small",null,l.createElement("a",{onClick:function(){return e.props.navigate(n)}},"View "+i+" more "+r(i,"resource","resources"))):null),l.createElement(X,{content:t.description()}),l.createElement(z,null,t.methods().map(function(t){return l.createElement(S,{key:t.method(),method:t,navigate:e.props.navigate})})))}))},t}(d),B=function(e){function t(){e.apply(this,arguments)}return a(t,e),t.prototype.render=function(){var e=this.props.node;return l.createElement(z,null,l.createElement(I,{node:e,title:e.title(),type:"Documentation"}),l.createElement(X,{content:this.props.node.content()}))},t}(d),U=function(e){function t(){e.apply(this,arguments)}return a(t,e),t.prototype.renderBody=function(e){var t=this,n=h.schema(e,this.props.raml).getOrElse(void 0);return l.createElement(z,{key:e.name()},l.createElement("h4",null,l.createElement(J,{node:e},e.name())),l.createElement(D,{node:e}),n?l.createElement(H,{key:void 0,content:n.content(),title:"Schema",mime:e.name(),name:n.name(),setState:this.props.setState,state:this.props.state}):null,e.examples&&e.examples().map(function(n){return l.createElement(H,{key:n.displayName(),content:n.content(),title:n.displayName(),name:void 0,mime:e.name(),setState:t.props.setState,state:t.props.state})}),l.createElement(H,{content:"BodyLikeImpl"===e.wrapperClassName()?e.example()&&e.example().value():e.example(),title:"Example",mime:e.name(),setState:this.props.setState,state:this.props.state}))},t.prototype.render=function(){var e=this,t=this.props.node,n=this.props.navigate;return t?l.createElement(z,null,l.createElement(X,{content:t.description()}),t.queryParameters().length?l.createElement(Y,null,l.createElement(_,{parameters:t.queryParameters(),title:"Query Parameters",navigate:n})):null,l.createElement(_,{parameters:t.headers(),title:"Headers",navigate:n}),t.body().length?l.createElement(Y,null,l.createElement("h3",null,"Body"),t.body().map(function(t){return e.renderBody(t)})):null,t.responses().length?l.createElement(Y,null,l.createElement("h3",null,"Responses"),t.responses().map(function(t){return l.createElement(z,{key:t.code().value()},l.createElement("h4",null,l.createElement(J,{node:t.code()},t.code().value())),l.createElement(X,{content:t.description()}),l.createElement(_,{parameters:t.headers(),title:"Headers",navigate:n}),t.body().map(function(t){return e.renderBody(t)}))})):null):null},t}(d),F=function(e){function t(){e.apply(this,arguments)}return a(t,e),t.prototype.render=function(){var e=this.props,t=e.node,n=e.state.view.demo,r="ResourceImpl"===t.parent().wrapperClassName();return l.createElement(z,null,l.createElement(I,{node:t,title:t.method().toUpperCase(),type:"Method"}),l.createElement(W,e),r?l.createElement(z,null,l.createElement("div",{className:"btn btn-primary",onClick:function(){return e.navigate({demo:!n})}},n?"Read Documentation":"Make an API Request")):null,r&&n?l.createElement(q,e):l.createElement(U,e))},t}(d),q=function(e){function t(){e.apply(this,arguments)}return a(t,e),t.prototype.render=function(){var e=this,t=this.props.node,n=t.method(),r=this.props.state.body,i=this.props.state.securityScheme,o=this.props.pageState.requestProgress,a=t.body().map(function(e){return e.name()}),s=t.allSecuredBy().map(function(e){return e.securityScheme()}),u=s.filter(function(e){return null!=e&&e.name()===i})[0];return l.createElement(z,null,s.length?l.createElement(z,null,l.createElement("h3",null,"Security Scheme"),l.createElement(z,null,l.createElement("select",{onChange:function(t){return e.props.setState({securityScheme:t.target.value})},className:"form-control",value:i},s.map(function(e){var t=null!=e?e.name():"null";return l.createElement("option",{key:t,value:null==e?"":e.name()},t)}))),u?l.createElement(z,null,l.createElement(G,{title:void 0,prefix:"Security Scheme Query Parameter",parameters:u.describedBy().queryParameters(),values:this.props.state.queryParameters,change:function(t,n){return e.props.setParameter("queryParameters",t,n)}}),l.createElement(G,{title:void 0,prefix:"Security Scheme Header",parameters:u.describedBy().headers(),values:this.props.state.headers,change:function(t,n){return e.props.setParameter("headers",t,n)}})):null):null,l.createElement(G,{title:"Base URI Parameters",prefix:void 0,parameters:t.ownerApi().allBaseUriParameters(),values:this.props.state.baseUriParameters,change:function(t,n){return e.props.setParameter("baseUriParameters",t,n)}}),null,l.createElement(G,{title:"URI Parameters",prefix:void 0,parameters:t.parent().allUriParameters(),values:this.props.state.uriParameters,change:function(t,n){return e.props.setParameter("uriParameters",t,n)}}),l.createElement(G,{title:"Query Parameters",prefix:void 0,parameters:t.queryParameters(),values:this.props.state.queryParameters,change:function(t,n){return e.props.setParameter("queryParameters",t,n)}}),l.createElement(G,{title:"Headers",prefix:void 0,parameters:t.headers(),values:this.props.state.headers,change:function(t,n){return e.props.setParameter("headers",t,n)}}),a.length?l.createElement(z,null,l.createElement("h3",null,"Body"),l.createElement(z,null,l.createElement("select",{onChange:function(t){return e.props.setState({body:t.target.value})},className:"form-control",value:r},a.map(function(e){return l.createElement("option",{key:e},e)}))),l.createElement(V,{mini:!1,value:this.props.state.bodies[r],onChange:function(t){return e.props.setParameter("bodies",r,t)}})):null,l.createElement(z,null,l.createElement("div",{className:c("btn inline-block",g[n]),onClick:function(){return e.props.execRequest()}},n.toUpperCase()),null==o?null:l.createElement("progress",{style:{marginLeft:5},className:"inline-block",max:isNaN(o)?null:"1",value:isNaN(o)?null:String(o)})),l.createElement(j,this.props))},t}(d),j=function(e){function t(){e.apply(this,arguments)}return a(t,e),t.prototype.render=function(){var e=this.props.pageState.requestError,t=this.props.pageState.requestResponse;if(e)return l.createElement(z,{className:"text-error"},e);if(t){var n=i(t.headers,"content-type");return l.createElement(z,null,l.createElement("h3",null,"Response"),l.createElement(z,null,l.createElement("div",null,l.createElement("strong",null,"Status Code: "),t.status),l.createElement("div",null,l.createElement("strong",null,"Status Text: "),t.statusText),l.createElement("div",null,l.createElement("strong",null,"URL: "),t.url)),l.createElement(z,null,l.createElement("h4",null,"Headers"),l.createElement(z,null,t.rawHeaders.map(function(e,t){return t%2===0?l.createElement("strong",{key:t},e+": "):l.createElement("span",{key:t},e,l.createElement("br"))}))),t.body?l.createElement(z,null,l.createElement("h4",null,"Body"),l.createElement(K,{content:t.body,mime:n,setState:this.props.setState,state:this.props.state})):null)}return null},t}(d),G=function(e){function t(){e.apply(this,arguments)}return a(t,e),t.prototype.render=function(){var e=this,t=this.props.values||{},n=this.props.parameters;return n.length?l.createElement(z,null,this.props.title?l.createElement("h3",{className:"sub-title"},this.props.title):null,n.map(function(n){var r,i=n.name(),o=t[i],a=null==e.props.prefix?i:e.props.prefix+": "+i;return r=l.createElement(V,{mini:!0,value:o,placeholder:n["default"](),onChange:function(t){return e.props.change(i,t)}}),l.createElement(z,{key:i},l.createElement("label",null,a,n.required()?" *":""),r)})):null},t}(d),V=function(e){function t(){e.apply(this,arguments)}return a(t,e),t.prototype.componentDidMount=function(){var e=this.editor=document.createElement("atom-text-editor");this.updateModel(this.props),this.refs.container.getDOMNode().appendChild(e)},t.prototype.updateModel=function(e){var t=this.editor,n=t.getModel();this.cleanup(),n.setMini(e.mini),n.setPlaceholderText(e.placeholder),n.setGrammar(e.grammar),n.setText(e.value||""),e.readonly?t.removeAttribute("tabindex"):t.setAttribute("tabindex","0"),e.gutter===!1?t.setAttribute("gutter-hidden",""):t.removeAttribute("gutter-hidden"),
e.onChange&&(this.disposable=n.onDidChange(function(){e.onChange(n.getText())}))},t.prototype.cleanup=function(){this.disposable&&(this.disposable.dispose(),this.disposable=null)},t.prototype.componentWillUnmount=function(){this.cleanup()},t.prototype.componentDidUpdate=function(){this.updateModel(this.props)},t.prototype.render=function(){return l.createElement("div",{ref:"container"})},t}(d),H=function(e){function t(){e.apply(this,arguments),this.state={visible:!1}}return a(t,e),t.prototype.render=function(){var e=this;if(!this.props.content)return null;var t=this.state.visible;return l.createElement(z,{key:this.props.key},l.createElement("a",{onClick:function(){return e.setState({visible:!t})}},(t?"Hide":"Show")+" "+this.props.title),this.props.name?" ("+this.props.name+")":null,t?l.createElement("div",{style:{marginTop:5}},l.createElement(K,this.props)):null)},t}(d),K=function(e){function t(){e.apply(this,arguments)}return a(t,e),t.prototype.render=function(){var e=this,t=v.getGrammerFromMime(this.props.mime),n=this.props.content,r=t.fileTypes.indexOf("xml")>-1,i=t.fileTypes.indexOf("json")>-1,o=t.fileTypes.indexOf("css")>-1,a=r||i||o;if(this.props.state.pretty)try{r?n=p.pd.xml(n):i?n=p.pd.json(n):o&&(n=p.pd.css(n))}catch(s){}return l.createElement(z,null,l.createElement(V,{value:n,grammar:t,readonly:!0}),a?l.createElement(z,null,l.createElement("label",null,l.createElement("input",{type:"checkbox",onChange:function(t){return e.props.setState({pretty:t.target.checked})},checked:this.props.state.pretty,style:{marginRight:5}}),l.createElement("span",null,"Pretty data"))):null)},t}(d),W=(function(e){function t(){e.apply(this,arguments)}return a(t,e),t.prototype.getName=function(e){var t=e.value();return"string"==typeof t?t:t.valueName()},t.prototype.render=function(){var e=this.props.node;if(null==e.value())return null;var t=this.props.navigate,n=this.props.title,r=e.highLevel().id();return l.createElement("span",{className:"highlight",style:{margin:"0 5px 5px 0",cursor:"pointer",display:"inline-block"},onClick:function(){return t(r)}},l.createElement("strong",null,n+": "),this.getName(e))},t}(d),function(e){function t(){e.apply(this,arguments)}return a(t,e),t.prototype.render=function(){var e=[],t=this.props.node,n=this.props.navigate;return"ResourceImpl"===t.wrapperClassName()&&t.type()&&e.push(l.createElement("NavigateLabel",{title:"Type",key:"type",node:t.type(),navigate:n})),("ResourceImpl"===t.wrapperClassName()||"MethodImpl"===t.wrapperClassName())&&t.is().forEach(function(t,r){e.push(l.createElement("NavigateLabel",{title:"Trait",key:"is:"+r,node:t,navigate:n}))}),t.securedBy().forEach(function(t,r){e.push(l.createElement("NavigateLabel",{title:"Secured By",key:"securedBy:"+r,node:t,navigate:n}))}),l.createElement(z,null,e)},t}(d)),z=function(e){function t(){e.apply(this,arguments)}return a(t,e),t.prototype.render=function(){return l.createElement("div",u(this.props,{className:c(this.props.className,"block")}),this.props.children)},t}(d),Y=function(e){function t(){e.apply(this,arguments)}return a(t,e),t.prototype.render=function(){return l.createElement(z,null,l.createElement("atom-panel",null,l.createElement("div",{className:"padded"},this.props.children)))},t}(d),J=(function(e){function t(){e.apply(this,arguments)}return a(t,e),t.prototype.render=function(){return l.createElement("i",{className:c("icon icon-"+this.props.name,this.props.className)})},t}(d),function(e){function t(){e.apply(this,arguments)}return a(t,e),t.prototype.openInEditor=function(e){function t(e){var t=e.getBuffer().positionForCharacterIndex(i);e.setCursorBufferPosition(t)}var n,r=(atom.workspace.getTextEditors(),e.unit().absolutePath()),i=e.start();if(atom.config.get("api-workbench.openConsoleInSplitPane")){var o=atom.workspace.getPanes(),a=atom.workspace.getActivePane();1===o.length?(n="left",a.splitLeft({})):n=a===o[0]?"right":"left"}atom.workspace.open(r,{searchAllPanes:!0,split:n}).then(t)},t.prototype.render=function(){var e=this,t=this.props.node.highLevel().lowLevel(),n=null!=t.unit();return n?l.createElement("a",{onClick:function(){return e.openInEditor(t)}},this.props.children):l.createElement("span",null,this.props.children)},t}(d)),X=function(e){function t(){e.apply(this,arguments)}return a(t,e),t.prototype.render=function(){var e=this.props.content;return null==e||null==e.value()?null:l.createElement(z,{dangerouslySetInnerHTML:{__html:s(e.value())}})},t}(d)},function(e,t,n){function r(e){var t={};return e.forEach(function(e){return Object.keys(e).forEach(function(n){return t[n]=e[n]})}),t}function i(e,t){return new x(C.find(e||[],t))}function o(e){return Object.keys(e).map(function(t){return[t,e[t]]})}function a(e){var t={};return e.forEach(function(e){return t[e[0]]=e[1]}),t}function s(e,t){return t(e),e}function l(e,t){"object"==typeof e&&Object.keys(e).forEach(function(n){return t(n,e[n])})}function u(e,n,r){void 0===r&&(r=!1);var i={};return e.forEach(function(e){var o=t.shallowCopy(e);r&&delete o[n],i[e[n]]=o}),i}function c(e,t){var n=e.length-t.length;return n>=0&&e.lastIndexOf(t)===n}function d(e,t){return e.length-t.length>=0&&e.substring(0,t.length)===t}function p(e){return"_"==e[e.length-1]}function f(e,t,n){var r,i=!1;e[t]=function(){return i||(i=!0,r=n.apply(e)),r}}function h(e,n){void 0===n&&(n=p);for(var r in e)n(r)&&t.ifInstanceOf(e[r],Function,function(t){return 0===t.length?f(e,r,t):null})}function m(e,t){void 0!==e&&t(e)}function v(e){return"string"!=typeof e||""==e?!1:c(e,".raml")}function y(e){for(var t,n=[],r=new RegExp("require\\('([^']+)'\\)","gi");t=r.exec(e);)n.push(t[1]);for(var i=new RegExp('require\\("([^"]+)"\\)',"gi");t=i.exec(e);)n.push(t[1]);return n=C.unique(n).filter(function(e){return""!=e}),n.sort(),n}function g(e){return"undefined"!=typeof e&&null!=e}function E(e){return 0==e.length?e:e.charAt(0).toUpperCase()+e.substr(1)}function b(e,t,n){void 0===n&&(n=!1);var r=Object.keys(t);if(n){var i={};r.forEach(function(e){return i[e]=!0}),Object.keys(e).forEach(function(e){return i[e]=!0}),r=Object.keys(i)}r.forEach(function(n){var r=e[n];r instanceof Object?(t[n]||(t[n]={}),b(r,t[n],!0)):void 0!=r&&(t[n]=e[n])})}function T(e,t){return Object.keys(t).forEach(function(n){return e=S(e,n,t[n])}),e}function S(e,t,n){for(var r="",i=0,o=e.indexOf(t);o<e.length&&o>=0;o=e.indexOf(t,i))r+=e.substring(i,o),r+=n,i=o+t.length;return r+=e.substring(i,e.length)}var C=n(20),x=n(56);t.defined=function(e){return null!==e&&void 0!==e},t.flattenArrayOfObjects=r,t.find=i,t.isInstance=function(e,t){return e instanceof t?[e]:[]},t.ifInstanceOf=function(e,t,n){return e instanceof t?n(e):null},t.toTuples=o,t.fromTuples=a,t.collectInstancesOf=function(e,n){return s([],function(r){return e.forEach(function(e){return t.ifInstanceOf(e,n,function(e){return r.push(e)})})})},t.collectInstancesOfInMap=function(e,t){return Object.keys(e).map(function(t){return[t,e[t]]}).filter(function(e){return e[1]instanceof t}).map(function(e){return e})},t.asArray=function(e){return t.defined(e)?e instanceof Array?e:[e]:[]},t.shallowCopy=function(e){return s({},function(t){return Object.keys(e).forEach(function(n){return t[n]=e[n]})})},t.flatMap=function(e,n){return t.flatten(e.map(n))},t.flatten=function(e){return Array.prototype.concat.apply([],e)},t.takeWhile=function(e,t){return s([],function(n){for(var r=0;r<e.length&&t(e[r]);r++)n.push(e[r])})},t.tap=s,t.kv=l,t.indexed=u,t.stringEndsWith=c,t.stringStartsWith=d,t.lazypropkeyfilter=p,t.lazyprops=h,t.iff=m,t.isRAMLUrl=v,t.getAllRequiredExternalModulesFromCode=y,t.serial=function(){var e=0;return function(){return e++}}(),t.isEssential=g,t.firstToUpper=E,t.updateObject=b,t.replaceMap=T,t.replace=S},function(e,t,n){e.exports=require("jsonix")},function(e,t,n){e.exports=require("w3c-schemas")},function(e,t,n){e.exports=require("know-your-http-well")},function(e,t,n){e.exports=require("remote")},function(e,t,n){e.exports=require("mime")},function(e,t,n){e.exports=require("querystring")},function(e,t,n){var r,i=n(63),o=function(e){return null!=e},a=function(){function e(t){var n=this;this._value=t,this._isDefined=!1,this._isEmpty=!0,this._arr=void 0,this.getOrThrow=function(){return i(n._isDefined,"Opt is empty. Use `Opt#getOrElse` or check `Opt#isDefined`."),n._value},this.value=function(){return n._value},this.isDefined=function(){return n._isDefined},this.isEmpty=function(){return n._isEmpty},this.toArray=function(){return n._arr||(n._arr=n._isDefined?[n._value]:[])},this.getOrElse=function(e){return n._isDefined?n._value:e},this.getOrElseF=function(e){return n._isDefined?n._value:e()},this.map=function(t){return n._isEmpty?e.empty():new e(t(n._value))},this.flatMap=function(t){return n.map(t).getOrElse(e.empty())},this.equals=function(t){return i(t instanceof e,"Expected other to be an `Opt`, but got `%s`",typeof t),n._isDefined===t.isDefined()&&n._value===t.value()},o(this._value)&&(this._isDefined=!0,this._isEmpty=!1)}return e.prototype.forEach=function(e){this.isDefined()&&e(this._value)},e.empty=function(){return r||(r=new e)},e}();e.exports=a},function(e,t,n){function r(e){if(e.length>0){if("'"==e.charAt(0))return'"'+e+'"';if('"'==e.charAt(0))return'"'+e+'"'}if(-1!=e.indexOf(" ")||-1!=e.indexOf(",")){if(-1==e.indexOf('"'))return'"'+e+'"';if(-1==e.indexOf("'"))return"'"+e+"'"}return e}function i(e,t){if(e.getAdapter(h.RAMLPropertyService).isKey()||e.isRequired())return null;if(e.domain()&&!e.domain().getAdapter(h.RAMLService).isUserDefined()){if(g.isDocumentationProperty(e)||g.isUsageProperty(e)||g.isDescriptionProperty(e)||g.isDisplayNameProperty(e)||g.isTitleProperty(e))return"Documentation";if(g.isAnnotationsProperty(e)||g.isIsProperty(e)||g.isSecuredByProperty(e)||g.isTypeProperty(e)&&!e.getAdapter(h.RAMLPropertyService).isTypeExpr())return"References";if(g.isProtocolsProperty(e))return"General"}return g.isTypeProperty(e)&&e.domain()&&!e.domain().getAdapter(h.RAMLService).isUserDefined()?null:t.property()&&e.domain()&&e.domain()!=t.property().range()?"Facets":"General"}function o(e,t){l.utils.updateType(e);var n=e.propertiesAllowedToUse(),r=new I(e);e.property()&&e.property().description()&&r.setDescription(e.property().description());var o=!1;if(e.definition()&&!e.parent()){var a=l.utils.getFragmentDefenitionName(e),s=e.definition().allSuperTypes();s.push(e.definition()),s.forEach(function(e){e.nameId&&e.nameId()===a&&(o=!0)})}if(n=n.filter(function(t){return o&&g.isNameProperty(t)?!1:g.isNameProperty(t)&&g.isApiType(e.definition())&&!t.domain().getAdapter(h.RAMLService).isUserDefined()?!1:g.isDisplayNameProperty(t)&&g.isApiType(e.definition())&&!t.domain().getAdapter(h.RAMLService).isUserDefined()?!1:!0}),n=n.sort(function(e,t){return e.getAdapter(h.RAMLPropertyService).isKey()?-1:t.getAdapter(h.RAMLPropertyService).isKey()?1:e.nameId()<t.nameId()?-1:1}),n.forEach(function(t){if(t.isValueProperty()){if(g.isAnnotationsProperty(t))return;if(g.isBooleanTypeType(t.range()))return;if(g.isMarkdownStringType(t.range()))return;if(t.getAdapter(h.RAMLPropertyService).isExampleProperty()&&"application/json"==e.name())return void r.addItemToCategory(i(t,e),new U(t,e));if(t.getAdapter(h.RAMLPropertyService).isExampleProperty()&&"application/xml"==e.name())return void r.addItemToCategory(i(t,e),new F(t,e));var n=e.attr(t.nameId());if(n&&"object"==typeof n.value())return void r.addItemToCategory(i(t,e),new K(t,e,n.value()));if(t.getAdapter(h.RAMLPropertyService).isTypeExpr()){var n=e.attr(t.nameId());if(n){var o=n.value();if("{"==o.trim().charAt(0))return void r.addItemToCategory(i(t,e),new j(t,e));if("<"==o.trim().charAt(0))return void r.addItemToCategory(i(t,e),new q(t,e))}}if(g.isSchemaProperty(t)&&t.domain()&&t.domain().isAssignableFrom(y.Universe10.TypeDeclaration.name))return;var a=W(t,e);a&&a.length>0&&t.domain()&&t.domain().getAdapter(h.RAMLService).isUserDefined()?g.isTypeProperty(t)&&e.definition().isAssignableFrom(y.Universe10.TypeDeclaration.name)?r.addItemToCategory(i(t,e),new V(t,e)):r.addItemToCategory(i(t,e),new G(t,e)):t.isMultiValue()?r.addItemToCategory(i(t,e),new L(t,e)):r.addItemToCategory(i(t,e),new P(t,e))}}),n.forEach(function(t){t.isValueProperty()&&g.isBooleanTypeType(t.range())&&r.addItemToCategory(i(t,e),new O(t,e))}),n.forEach(function(t){t.isValueProperty()&&g.isMarkdownStringType(t.range())&&r.addItemToCategory(i(t,e),new B(t,e))}),!t){r.addItemToCategory("Palette",new R(e));var u=m.calculateCurrentActions(m.TARGET_RAML_EDITOR_NODE),c=d.groupBy(u,function(e){return e.category.join("/")});for(var p in c)r.addItemToCategory("Palette",new M(e,p,c[p]))}return(e.definition().getAdapter(h.RAMLService).isUserDefined()||e.definition().isAssignableFrom(y.Universe10.TypeDeclaration.name))&&r.addItemToCategory("Type",new C(e)),r}var a=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},s=n(17),l=n(15),u=l.ds,c=l.search,d=n(20),p=n(6),f=n(19),h=u,m=n(24),v=n(64),y=l.universes,g=l.universeHelpers,E=n(65),b=n(66),T=l.utils,S=function(){function e(e,t){void 0===t&&(t=""),this._title=e,this.description=t,this.listeners=[]}return e.prototype.needsSeparateLabel=function(){return!1},e.prototype.addListener=function(e){this.listeners.push(e)},e.prototype.removeListener=function(e){this.listeners=this.listeners.filter(function(t){return t!=e})},e.prototype.add=function(e){throw new Error("Not supported")},e.prototype.root=function(){return this.parent?this.parent.root():this},e.prototype.title=function(){return this._title},e.prototype.children=function(){return[]},e.prototype.setDescription=function(e){this.description=e},e.prototype.setTitle=function(e){this._title=e},e.prototype.render=function(e){throw void 0===e&&(e={}),new Error("Not Implemented")},e.prototype.item=function(e){return null},e.prototype.setError=function(e){},e.prototype.clearErrors=function(){},e}();t.Item=S;var C=function(e){function t(t){e.call(this,"Type",""),this.node=t}return a(t,e),t.prototype.render=function(e){return E.render(this.node)},t}(S);t.TypeDisplayItem=C;var x,w=function(e){function t(){e.apply(this,arguments),this._children=[]}return a(t,e),t.prototype.add=function(e){e.parent=this,this._children.push(e)},t.prototype.children=function(){return this._children},t.prototype.plainChildren=function(){return this._children.filter(function(e){return!(e instanceof t)})},t.prototype.categories=function(){return this._children.filter(function(e){return e instanceof t})},t.prototype.item=function(e){var t;return this._children.forEach(function(n){n.title()==e&&(t=n);var r=n.item(e);r&&(t=r)}),t},t.prototype.render=function(e){var t=this;void 0===e&&(e={});var n=this.createSection(e);this._result=n,this.description&&e.showDescription&&(this.descriptionLabel=f.label(this.description),n.addChild(this.descriptionLabel)),this.contributeTop(n),this.plainChildren().forEach(function(e){return t.addChild(n,e)});var r=this.createWrappedChild(n);this.subCategories=r;var i=this.categories(),o={};i.forEach(function(e){return o[e.title()]=e});var a=[];o.General&&(a.push(o.General),delete o.General),o.Facets&&(a.push(o.Facets),delete o.Facets);for(var s in o)a.push(o[s]);return a.forEach(function(e){return t.addChild(r,e)}),n},t.prototype.createSection=function(e){if(e.showHeader)return new f.Section(f.h3(this.title()),!1);var t=new f.Panel;return t.setCaption(this.title()),t},t.prototype.createWrappedChild=function(e){return e},t.prototype.addChild=function(e,t){var n=t.render();if(e instanceof f.TabFolder){var r=e;r.add(n.caption(),f.Icon.NONE,n)}else{if(t.needsSeparateLabel()){var i=f.label(t.title());i.margin(0,5,0,0),e.addChild(i),e.addChild(f.label(t.description))}e.addChild(n)}},t.prototype.contributeTop=function(e){},t.prototype.setError=function(e){},t.prototype.clearErrors=function(){this._children.forEach(function(e){return e.clearErrors()})},t.prototype.update=function(e){},t}(S),A=!1,I=function(e){function t(t){e.call(this,t.definition().nameId(),t.definition().description()),this.node=t,this.ep=null}return a(t,e),t.prototype.createWrappedChild=function(e){var t=new f.TabFolder;return t.setOnSelected(function(){A||(x=t.selectedComponent().caption())}),e.addChild(t),t},t.prototype.subCategoryByNameOrCreate=function(e){var t=d.find(this.children(),function(t){return t.title()==e});if(!t){var n=new w(e);return this.add(n),n}return t},t.prototype.addItemToCategory=function(e,t){return null==e?(this._children.push(t),void(t.parent=this)):void this.subCategoryByNameOrCreate(e).add(t)},t.prototype.contributeTop=function(e){this.errorLabel=f.label("",f.Icon.BUG,f.TextClasses.ERROR),this.ep=f.hc(this.errorLabel),this.ep.setDisplay(!1),e.addChild(this.ep)},t.prototype.render=function(t){void 0===t&&(t={}),A=!0;try{var n=e.prototype.render.call(this,t);this._options=t,this._panel=n;for(var r=this.subCategories,i=0;i<r.tabsCount();i++){var o=r.get(i);if(o.header==x)return r.setSelectedIndex(i),n}var a="";return a=this.node.property()?this.node.property().description():this.node.definition().description(),a.length&&!t.showDescription&&(n.addChild(f.html("<hr/>")),n.addChild(f.label(a,f.Icon.INBOX,f.TextClasses.SUBTLE))),this.update(this),n}finally{A=!1}},t.prototype.update=function(e){var t=this;if(this._panel){if(e instanceof P){var n=e;if(n.property.getAdapter(h.RAMLPropertyService).isTypeExpr()||n.property.isDescriminator()){l.utils.updateType(this.node);var r=this.item("Facets");r&&r._result&&r._result.clear();var i=o(this.node,!1),a=i.item("Facets");a?r&&r._result?(r._children=a._children,r._children.forEach(function(e){return e.parent=r}),r._children.length>0&&r._result.setDisplay(!0),a.children().forEach(function(e){r._result.addChild(e.render(t._options))})):(this._children.push(a),this._panel&&this._panel.addChild(a.render(this._options))):r&&r._result&&r._result.setDisplay(!1)}}var s=null;if(this.node.definition().allProperties().forEach(function(e){e.getAdapter(h.RAMLPropertyService).isKey()&&(s=e)}),s){var u=this.item(s.nameId());if(u){var c=u.fld,d=c.getBinding().get();d&&0!=d.trim().length?this._panel.getBinding().setStatus(f.okStatus()):this._panel.getBinding().setStatus(f.errorStatus(""))}}var p=this.node.errors();if(this.clearErrors(),this.ep.setDisplay(!1),!T.hasAsyncRequests()&&p&&p.length>0){var m=[];if(p.forEach(function(e){e.extras&&e.extras.length>0&&(e=e.extras[0]);var n=t.item(e.node.name());n?n.setError(e.message):m.push(e)}),m.length>0){this.errorLabel.setIcon(f.Icon.BUG);var v=m.map(function(e){return e.node.name()+":"+e.message}).join(",");v.length>100&&(v=v.substring(0,100)+"..."),this.errorLabel.setText(v),this.ep.setDisplay(!0)}else this.ep.setDisplay(!1)}}},t}(w),N=function(e){function t(){e.apply(this,arguments)}return a(t,e),t.prototype.setLabelWidth=function(e){this.setStyle("margin-left",e+2+"ch")},t}(f.CheckBox),P=function(e){function t(t,n){e.call(this,t.nameId(),t.description()),this.property=t,this.node=n}return a(t,e),t.prototype.getDefaultValue=function(){return b.getDefaultValue(this.node,this.property)},t.prototype.hasDefault=function(){return b.hasDefault(this.property)},t.prototype.clearErrors=function(){this.setError(null)},t.prototype.setError=function(e){e?(this.errorLabel.setText(e),this.errorLabel.setDisplay(!0)):this.errorLabel&&this.errorLabel.setDisplay(!1)},t.prototype.fromEditorToModel=function(e,t){var n=this.fld,r=this.toLocalValue(n.getBinding().get());null==r&&(r=""),r===!0&&(r="true"),r===!1&&(r="");var i=this.node.attr(this.property.nameId()),o="";if(i){var a=this.toLocalValue(this.toUIValue(i.value()));a&&(o=""+a)}if(o!=r){if(r.length>0){if(i&&i.lowLevel().includePath()){var l=i.lowLevel().includePath(),u=i.lowLevel().unit().resolve(l);if(u){var c=u.absolutePath();s.writeFileSync(c,r)}return}i=this.node.attrOrCreate(this.property.nameId()),i.setValue(""+r)}else i&&(this.property.getAdapter(h.RAMLPropertyService).isKey()||i.remove());i.lowLevel()&&i.lowLevel().unit()&&i.lowLevel().unit()!=this.node.lowLevel().unit()&&p.saveUnit(i.lowLevel().unit());var d=this.root();d&&d.update(this)}},t.prototype.toLocalValue=function(e){return e},t.prototype.toUIValue=function(e){return e},t.prototype.fromModelToEditor=function(){var e=this.node.attr(this.property.nameId());if(e||this.hasDefault()){var t=e?e.value():this.getDefaultValue();null==t&&(t=""),this.fld.getBinding().set(this.toUIValue(""+t))}},t.prototype.render=function(){var e=this,t=!1,n=new f.WrapPanel;this.errorLabel=f.label("",f.Icon.BUG,f.TextClasses.ERROR),this.errorLabel.setDisplay(!1),this.errorLabel.setStyle("margin-left",this._title.length+1+"ch");var r=this.createField();this.fld=r,r.getBinding().addListener(function(n,r){t&&e.fromEditorToModel(n,r)}),n.setCaption(this.title()),this.fromModelToEditor(),n.addChild(r);var i=this.node.attr(this.property.nameId());if(i)var o=i.value();var a=this.property.valueDocProvider();if(a){var s=a(o);null==s&&(s="");var l=f.label(s,f.Icon.INFO,f.TextClasses.SUBTLE);s||l.setDisplay(!1),n.addChild(l),r.getBinding().addListener(function(e){var t=a(r.getBinding().get());t||(t=""),l.setText(t),l.setDisplay(t.length>0)}),l.setStyle("margin-left",this._title.length+1+"ch")}return i&&i.lowLevel().includePath()&&n.addChild(f.label("Included from "+i.lowLevel().includePath(),f.Icon.INFO,f.TextClasses.SUBTLE)),n.addChild(this.errorLabel),t=!0,n},t.prototype.createField=function(){return f.texfField(this.needsSeparateLabel()?"":this.property.nameId(),"",function(e){})},t}(S),L=function(e){function t(){e.apply(this,arguments)}return a(t,e),t.prototype.fromEditorToModel=function(){var e=this.fld,t=e.getBinding().get();null==t&&(t="");var n=this.node.attributes(this.property.nameId()),i=n.map(function(e){return r(""+e.value())}).join(", ");if(i!=t){var o=t.split(","),t=o.filter(function(e){return e.trim().length>0}).map(function(e){return e.trim()}),a=this.node.attrOrCreate(this.property.nameId());a.setValues(t);var s=this.root();s&&s.update(this)}},t.prototype.fromModelToEditor=function(){var e=this.node.attributes(this.property.nameId()),t=e.map(function(e){return r(""+e.value())}).join(", ");this.fld.getBinding().set(t)},t}(P),O=function(e){function t(){e.apply(this,arguments)}return a(t,e),t.prototype.createField=function(){return new N(this.property.nameId(),f.Icon.NONE,function(e){})},t.prototype.toUIValue=function(e){return e&&"true"===e.trim()?!0:!1},t.prototype.toLocalValue=function(e){return e+""},t}(P),R=function(e){function t(t){e.call(this,"Actions",""),this.node=t}return a(t,e),t.prototype.render=function(e){return v.generateSuggestionsPanel(this.node)},t}(S),M=function(e){function t(t,n,r){e.call(this,n,""),this.actions=r}return a(t,e),t.prototype.render=function(e){var t=f.hc();return t.addChild(f.h3(this.title())),this.actions.forEach(function(e){t.addChild(f.button(e.name,f.ButtonSizes.EXTRA_SMALL,f.ButtonHighlights.SUCCESS,f.Icon.CHECKLIST,function(t){return e.onClick()}).margin(3,3,3,3))}),t},t}(S),D=function(e){function t(t,n){e.call(this,t,n),this.margin(0,0,6,12),this.setMini(!1),this.setStyle("min-height","100px"),this.setStyle("border","solid"),this.setStyle("border-width","1px"),this.setStyle("border-radius","2px"),this.setStyle("font-size","1.15em"),this.setStyle("border-color","rgba(0,0,0,0.2)"),this.setGrammar("source.gfm")}return a(t,e),t.prototype.setLabelWidth=function(){},t.prototype.setLabelHeight=function(){},t.prototype.setRequired=function(e){},t}(f.AtomEditorElement),_=function(e){function t(t,n){e.call(this,t,n),this.margin(0,0,6,12),this.setMini(!1),this.setStyle("min-height","100px"),this.setStyle("border","solid"),this.setStyle("border-width","1px"),this.setStyle("border-radius","2px"),this.setStyle("font-size","1.15em"),this.setStyle("border-color","rgba(0,0,0,0.2)"),this.setGrammar("text.xml")}return a(t,e),t.prototype.setLabelWidth=function(){},t.prototype.setLabelHeight=function(){},t.prototype.setRequired=function(e){},t}(f.AtomEditorElement),k=function(e){function t(t,n){e.call(this,t,n),this.margin(0,0,6,12),this.setMini(!1),this.setStyle("min-height","100px"),this.setStyle("border","solid"),this.setStyle("border-width","1px"),this.setStyle("border-radius","2px"),this.setStyle("font-size","1.15em"),this.setStyle("border-color","rgba(0,0,0,0.2)"),this.setGrammar("source.json")}return a(t,e),t.prototype.setLabelWidth=function(){},t.prototype.setLabelHeight=function(){},t.prototype.setRequired=function(e){},t}(f.AtomEditorElement),B=function(e){function t(){e.apply(this,arguments)}return a(t,e),t.prototype.createField=function(){var e=new D("",function(e){});return e},t.prototype.needsSeparateLabel=function(){return!0},t}(P),U=function(e){function t(){e.apply(this,arguments)}return a(t,e),t.prototype.createField=function(){var e=new k("",function(e){});return e},t.prototype.needsSeparateLabel=function(){return!0},t}(P),F=function(e){function t(){e.apply(this,arguments)}return a(t,e),t.prototype.createField=function(){var e=new _("",function(e){});return e},t.prototype.needsSeparateLabel=function(){return!0},t}(P),q=function(e){function t(){e.apply(this,arguments)}return a(t,e),t.prototype.createField=function(){var e=new _("",function(e){});return e},t.prototype.needsSeparateLabel=function(){return!0},t}(P),j=function(e){function t(){e.apply(this,arguments)}return a(t,e),t.prototype.createField=function(){var e=new k("",function(e){});return e},t.prototype.needsSeparateLabel=function(){return!0},t}(P),G=function(e){function t(){e.apply(this,arguments)}return a(t,e),t.prototype.createField=function(){var e=W(this.property,this.node),t=this.node.attr(this.property.nameId());t&&(d.find(e,function(e){return e==t.value()})||e.push(t.value())),this.property.isRequired()||this.property.getAdapter(h.RAMLPropertyService).isKey()||(e=[""].concat(e));var n=new f.SelectField(this.property.nameId(),function(e){},"",f.Icon.NONE,e);return n.getActualField().setOptions(e),n},t}(P),V=function(e){function t(){e.apply(this,arguments)}return a(t,e),t.prototype.fromEditorToModel=function(t,n){var r=this,i=[],o=[];if(t&&n)try{this.node.definition().allSuperTypes().forEach(function(e){r.isAllowedTypeToReplaceFacets(e)&&r.addTypeFacets(e,i)}),o=[].concat(this.node.attrs())}catch(a){console.log(a)}if(e.prototype.fromEditorToModel.call(this),t&&n)try{var s=(this.node.definition().universe(),[]);this.node.definition().allSuperTypes().forEach(function(e){r.isAllowedTypeToReplaceFacets(e)&&r.addTypeFacets(e,s)}),i.length>0&&s.length>0&&o.forEach(function(e){d.find(i,function(t){return t==e.name()})&&!d.find(s,function(t){return t==e.name()})&&r.node.remove(e)})}catch(a){console.log(a)}},t.prototype.isAllowedTypeToReplaceFacets=function(e){return e.key()==y.Universe10.StringTypeDeclaration||e.key()==y.Universe10.BooleanTypeDeclaration||e.key()==y.Universe10.NumberTypeDeclaration||e.key()==y.Universe10.IntegerTypeDeclaration},t.prototype.addTypeFacets=function(e,t){e.properties().map(function(e){return e.nameId()}).forEach(function(e){return t.push(e)})},t}(G),H=function(e){function t(t,n){e.call(this),this.str=t;var r=t.lowLevel(),i={render:function(e){var t=(e.key(),e.value());"string"!=typeof t&&(t=""),t.length>30&&(t=t.substring(0,20)+"...");var n=f.label(e.key(),f.Icon.CIRCUIT_BOARD,f.TextClasses.HIGHLIGHT);t=f.label(t?":"+t:"",f.Icon.NONE,f.TextClasses.SUCCESS);var r=f.hc(n,t);return r}},o=f.treeViewer(function(e){return e.children()},i,function(e){return e.key()}),a={children:function(){return[r]}};o.setInput(a),this.addChild(f.label(n)),this.addChild(o)}return a(t,e),t.prototype.setLabelWidth=function(){},t.prototype.setLabelHeight=function(){},t.prototype.setRequired=function(e){},t}(f.Panel),K=function(e){function t(t,n,r){e.call(this,t,n),this.stvalue=r}return a(t,e),t.prototype.createField=function(){var e=new H(this.stvalue,this.title()+":");return e},t}(P),W=function(e,t){var n=c.enumValues(e,t);if(g.isNameProperty(e)&&t.definition().isAssignableFrom(y.Universe10.TypeDeclaration.name)&&t.property()&&g.isBodyProperty(t.property())&&!(t.property()instanceof u.UserDefinedProp))return t.parent()&&g.isMethodType(t.parent().definition())?["application/json","application/xml","multipart/form-data","application/x-www-form-urlencoded"]:["application/json","application/xml"];if(!n||0==n.length){var r=e.suggester();r&&(n=r(t)),n&&0!=n.length||(n=e.getOftenKeys())}return d.unique(n)};t.buildItem=o},function(e,t,n){var r=function(){function e(){}return e}();t.KeyValuePair=r;var i=function(){function e(e){var t=this;void 0===e&&(e=[]),this.mappings=[],e.forEach(function(e){return t.mappings.push(e)})}return e.prototype.volume=function(){return this.mappings.length},e.prototype.pairs=function(){return[].concat(this.mappings)},e.prototype.set=function(e,t){var n=this.mappings.filter(function(t){return t.key==e});0==n.length?this.mappings.push({key:e,value:t}):n[0].value=t},e.prototype.get=function(e){var t=this.mappings.filter(function(t){return t.key==e});return 0==t.length?null:t[0].value},e.prototype.map=function(e){return this.mappings.map(function(e){return e.value}).map(e)},e.prototype.forEach=function(e){this.mappings.map(function(e){return e.value}).forEach(e)},e.prototype.filter=function(e){return this.mappings.map(function(e){return e.value}).filter(e)},e}();t.Map=i},function(e,t,n){e.exports=require("marked")},function(e,t,n){e.exports=require("classnames")},function(e,t,n){e.exports=require("react-pure-render/component")},function(e,t,n){e.exports=require("pretty-data")},function(e,t,n){e.exports=require("invariant")},function(e,t,n){function r(e){var t=e.definition().allProperties(),n=i.vc(),r=i.hc();return n.addChild(i.h3("Insertions and Delete: ")),n.addChild(r),t.forEach(function(t){if(!(t.isValueProperty()||t.getAdapter(u.RAMLPropertyService).isMerged()||l.find(e.lowLevel().children(),function(e){return e.key()==t.nameId()})||e.lowLevel().includesContents())){var n=new d("",t,e);r.addChild(i.button(t.nameId(),i.ButtonSizes.EXTRA_SMALL,i.ButtonHighlights.INFO,i.Icon.NONE,function(e){return n.insert()}).margin(3,3,3,3))}}),t.forEach(function(t){if(!t.isValueProperty()&&t.getAdapter(u.RAMLPropertyService).isMerged()){var n=t.enumOptions();return void(n&&n.forEach(function(n){if(!l.find(e.lowLevel().children(),function(e){return e.key()==n})&&!e.lowLevel().includesContents()){var o=new d(n,t,e);r.addChild(i.button(n,i.ButtonSizes.EXTRA_SMALL,i.ButtonHighlights.WARNING,i.Icon.NONE,function(e){return o.insert()}).margin(3,3,3,3))}}))}}),r.addChild(i.button("Delete",i.ButtonSizes.EXTRA_SMALL,i.ButtonHighlights.ERROR,i.Icon.NONE,function(t){return e.parent().remove(e)}).margin(3,3,3,3)),n}var i=n(19),o=n(15),a=o.universes,s=o.stubs,l=n(20),u=o.ds,c=n(4),d=function(){function e(e,t,n){this.value=e,this.property=t,this.node=n}return e.prototype.insert=function(){var e=this.property.range(),t=this.value;this.property.nameId()==a.Universe10.Method.properties.body.name&&(t="application/json"),this.property.nameId()==a.Universe10.MethodBase.properties.responses.name&&(t="200");var n=s.createStubNode(e,this.property,t);c.aquireManager()._cleanOutline=!0,this.node.add(n),c.aquireManager().patchCurrentNode(this.node)},e}();t.generateSuggestionsPanel=r},function(e,t,n){function r(e){var t=e.wrapperNode(),n=t.highLevel().localType();return s(n)}var i=n(19),o=n(15),a=o.ds,s=function(e){var t=i.vc();t.addChild(i.label("definition:"+e.nameId()));var n=e.properties(),r=e.superTypes();r&&(t.addChild(i.h3("Super types:")),e.allSuperTypes().forEach(function(e){t.addChild(i.hc(i.label(e.nameId(),i.Icon.TAG)))}));var o=e.getAdapter(a.RAMLService).getRepresentationOf();if(o){var l=o.getFixedFacets();Object.keys(l).length>0&&(t.addChild(i.h3("All facets")),Object.keys(l).forEach(function(e){t.addChild(i.label(e+":"+l[e].value()))}))}return n&&n.length>0&&(t.addChild(i.h3("All properties")),n.forEach(function(e){t.addChild(i.hc(i.label(e.nameId(),i.Icon.LINK),i.label(": "+e.range().nameId(),i.Icon.NONE,i.TextClasses.WARNING)))})),e.hasArrayInHierarchy()&&(t.addChild(i.h3("Component type:")),t.addChild(s(e.arrayInHierarchy().componentType()))),
e.hasUnionInHierarchy()&&(t.addChild(i.h3("Union type:")),t.addChild(i.h3("Left:")),t.addChild(s(e.unionInHierarchy().leftType())),t.addChild(i.h3("Right:")),t.addChild(s(e.unionInHierarchy().rightType()))),t};t.render=r},function(e,t,n){function r(e,t){return t.nameId()===s.Universe10.TypeDeclaration.properties.required.name?e.name().indexOf("?")==e.name().length-1:void 0}function i(e){return e.nameId()===s.Universe10.TypeDeclaration.properties.required.name?!0:!1}var o=n(15),a=o.ds,s=a.universesInfo;t.getDefaultValue=r,t.hasDefault=i}]);
//# sourceMappingURL=main.js.map